# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - Comment, EditComment 컴포넌트에 Context API 내용 추가해서 재사용 & 댓글 작성자 이름이 출력되도록 구성
    - 댓글 수정 부분에서 사용자의 로그인 유무에 따라 댓글 수정자의 이름이 변경되도록 해주고, textarea와 button도 변경되도록 구성
    - 비로그인 상태에서 댓글 수정 버튼 클릭 시 textarea와 버튼이 모두 비활성화 되어 있도록 구성이 되어있지만, 여기에서 추가로 비로그인 상태일 때는 수정과 삭제 버튼이 보이지 않고, 로그인을 했을 때 해당 버튼이 보이도록 추가 구성
    - 댓글을 추가할 때는 사용자 이름이 나오지만, 추가한 후에 댓글을 작성한 사용자 이름이 아닌, "GUEST"로 출력이 되기 때문에 이 부분을 수정
    - 프론트엔드 구성
      - Comment, EditComment 컴포넌트에서 Context API 내용을 추가
        - useEffect를 추가하고, Context API 내용을 의존성 배열로 추가
      - Comment 컴포넌트에서는 로그인 유무에 따라 버튼이 보여지도록 구성
      - EditComment 컴포넌트에서는 Context API에서 사용자 이름을 가져와서 보여지도록 구성
        - button과 textarea는 로그인 유무에 따라 내용이 다르게 보이거나 className이 다르게 들어가도록 구성
      - Comments 컴포넌트에서는 DB에 저장된 댓글 정보를 받는데, Comment 컴포넌트에 댓글 정보 중 하나인 name을 prop으로 전달해서 댓글 작성자 이름이 "GUEST"가 아닌, 댓글 작성자 이름이 보이도록 출력
    - 구성한 내용은 모두 정상적으로 작동하는데, 여기에서 조금 생각해봐야 할 문제가 댓글 수정, 삭제 부분에서 로그인을 하지 않으면 해당 버튼이 보이지 않도록 구성을 했기 때문에 굳이 댓글 수정 내용에서 로그인 유무에 따라 내용이 변경되도록 구성을 해야 하는지 다시 한 번 생각해봐야 한다.
      - 굳이 필요 없다고 생각도 되지만, 또 한편으로는 2차 안전장치가 될 수 있지 않을까 생각이 되기 때문에 이 부분에 대해 다시 생각해봐야 한다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/a9d2872aee03aed53ec657bbf5579dddc50ae1ff)

<br />

- 추가 및 해결 해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
  - 로그인 후에, 새로고침 시 로그아웃 되어버리는 상황도 수정을 해야 함
    - 현재 로그인 한 후에, useEffect를 통해서 데이터를 확인하고 토큰이 유효하다면 정상적으로 로그인 유지는 되지만, 새로고침 시 깜빡거리면서 메인헤더가 변경되는 것이 보이기 때문에 이 부분을 수정할 수 있으면 수정할 생각이다.
  - 로그인을 유지하고 있을 때, token이 만료 시간에 가까워지면 자동으로 갱신되는 로직을 추가 해야 함
    - 대충 구성만 되어 있는 상태로, 좀 더 자세한 코드와 테스트가 필요함
  - 로그인 시 주어지는 토큰을 확인하고, 해당 토큰을 통해 인증하고 게시글, 댓글, 답글 관련 기능을 활성화해주는 코드를 구성해야 함
    - 전체적으로 저 인증을 확인할 수 있게 해주는 것이 1차 목표로, 애플리케이션 전체에서 인증을 확인할 수 있게 된다면 쉽게 구성이 될 것으로 예상된다.
      - Context API를 추가해서, 로그인 유무를 전체에서 알 수 있도록 구성해주고 필요할 때 내용을 가져와서 사용 할 수 있다.
    - 세션과 연동이 가능한 부분이 있는지도 테스트가 필요함
      - 불가능, 세션이나 jwt 토큰 중 하나만 사용하는 것이 좋다.
      - 세션을 삭제하는 작업을 아직 하지 않아서 해줘야 함
    - Context API를 사용하는 것은 좋지만, 이 내용을 사용하려는 파일에서 하나하나 추가해서 사용하기 때문에 커스텀 Hook을 구성해서 재사용할 수 있도록 해줄 필요가 있음
  - 오류 페이지 이동에 대한 처리가 필요
    - ex) 게시글 추가 버튼이 로그인하지 않았음에도 활성화되어 클릭되면 오류 페이지로 이동해서 서버에서 문제가 생기지 않도록 조치가 필요함
    - ex) 로그인을 하지 않은 채로 강제로 URL을 통해서 이동하려고 할 때, 오류 페이지로 이동하도록 구성을 해줘야 함

# 오늘 느낀 점

- 오늘은 간단하게 댓글 수정, 삭제와 관련된 내용에서 Context API를 추가하고 로그인 유무에 따라 실시간으로 버튼이 변경되도록 구성을 해주었고 댓글을 작성한 사용자 정보를 백엔드에서 전달 받고 있는데, name 부분은 전달 받고 있음에도 하위 컴포넌트로 전달하고 있지 않았기 때문에 전달할 수 있도록 추가해주었다. 댓글 수정, 삭제 부분에서 비로그인 상태일 때 수정, 삭제 버튼이 출력이 되지 않도록 구성을 했는데, 여기에서 추가로 textarea와 button 까지 비로그인 상태일 때 비활성화 되도록 구성해주는 것이 맞는 지 다시 한 번 생각해볼 필요가 있다. 굳이 필요가 없다고 생각도 되지만, 2차 안전장치가 되는 것 같기 때문에 좀 고민이 되는 상황인데, 다시 한 번 예외 상황을 생각해보고 판단을 내려야 할 것 같다. (수정, 삭제 버튼이 보여질 수 있는 상황 또는 수정을 열어놓고 로그아웃을 해버리는 상황 등)

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
