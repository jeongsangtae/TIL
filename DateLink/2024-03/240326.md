# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 로그인 모달 수정 및 NotFound에 홈으로 이동하는 버튼 추가 그리고 NotFound 라우트 위치 변경
    - 로그인 모달에서 로그인이 아닌 가입으로 되어있었기 때문에 이 부분을 변경, NotFound 라우트를 루트 레이아웃 형제로 구성해서 메인헤더가 없는 상태로 보이도록 구성, NotFound에 메인헤더가 없는 대신에 홈으로 이동할 수 있는 버튼을 추가해서 이동할 수 있도록 구성
    - 프론트엔드 구성
      - Login 모달의 submit 버튼 텍스트 변경
      - NotFound 라우트의 위치를 루트 레이아웃 자식에서 형제로 위치 변경
      - NotFound 컴포넌트에서 버튼을 클릭 시 홈으로 이동할 수 있도록 Link 컴포넌트를 사용해서 구성
      - 버튼에 간단한 CSS 추가
    - NotFound 라우트 위치를 변경함으로써 메인헤더가 보이지 않게 되었고, 대신에 홈으로 이동하는 버튼이 추가되어 에러 페이지에서 버튼 클릭 시 홈 화면으로 이동할 수 있게 되었다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/b43ae198967648c30086a177cf879a65687340df)

  <br />

  - NotFound 컴포넌트, CSS 변경 및 NoAccess 컴포넌트, CSS 변경
    - NotFound, NoAccess 컴포넌트가 단순 텍스트로만 구성이 되어있었기 때문에 내용을 좀 변경해주고, CSS도 추가해서 화면 중앙에 위치하도록 구성해주었다.
    - 프론트엔드 구성
      - NotFound
        - 컴포넌트에서 좀 더 내용을 설명하는 텍스트 추가
        - 프래그먼트 대신에 div를 사용해서 className을 사용할 수 있도록 구성
        - 홈으로 이동하는 버튼을 p 대신 버튼으로 구성
        - CSS를 추가해서 화면 중앙에 위치하도록 구성해주고, 버튼과 텍스트 사이의 간격을 조금 추가
      - NoAccess
        - 컴포넌트에서 좀 더 내용을 설명하는 텍스트 추가
        - 프래그먼트 대신에 div를 사용해서 className을 사용할 수 있도록 구성
        - 여기에는 메인헤더가 있기 때문에 따로 버튼을 추가하지 않음
        - CSS를 추가해서 화면 중앙에 위치하도록 구성
    - 컴포넌트 내용과 CSS를 변경해서 에러 페이지가 이전보다 좀 더 보기 편해지도록 구성을 해줬는데, 이후에 추가로 변경이 필요할 경우 내용을 더 추가할 계획
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/2579a0acb5d1a027be2dd3533a969304e23f2379)

  <br />

  - 로그인과 회원가입 모달에서 서로 이동하도록 해주는 버튼을 수정 (실패)
    - 로그인과 회원가입 모달에 각각 로그인 하러가기 또는 회원가입 하러가기 버튼이 있는데, 해당 버튼은 이전에 모달로 구성하기 전에 페이지로 구성할 때 사용하던 것인데 이제는 페이지로 이동하지 않기 때문에, 내용을 변경해서 로그인 또는 회원가입 모달이 화면에 뜨도록 해보려고 했으나 구성이 잘못되었는지 현재는 제대로 작동하지 않고 있다.
    - 프론트엔드 구성
      - 회원가입 모달 toggle 여부를 확인하기 위한 새로운 useState 추가
      - useState의 boolean을 변경해줄 toggleSignupModal 함수 추가
        - 로그인 모달을 닫도록 onToggle 실행
        - 그 다음 true로 변경
      - a 태그로 되어있는 회원가입 하러가기 버튼을 button으로 수정하고, onClick 추가
      - 새롭게 추가된 useState에 true가 들어올 경우 회원가입 모달이 보이도록 구성
    - 추가한 내용을 테스트해본 결과, 로그인 모달이 닫히기만 하며 회원가입 모달이 열리지 않는 것을 확인할 수 있었다.
      - 로그인과 회원가입 모달을 하나로 구성해서 사용하고 해당 모달에서 바로 모달이 전환되도록 하면 될 것 같다는 생각도 들었다.
      - 모달이 바로 전환되도록 하려면 하나의 컴포넌트에서 동적으로 사용이 되면서 해당 컴포넌트 내에서 내용이 모두 구성되어 있으면 가능할 거 같음
      - 애초에 하나의 컴포넌트로 합치려고 생각을 했기 때문에 이 방법을 시도해볼 생각이다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/493945981141ccdfe12af1411e4b8da55255acea)

<br />

- 추가 및 해결 해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
    - 이 부분은 session을 삭제하게 되면 더 이상 신경쓰지 않아도 되지만, 현재는 session을 그냥 놔둔 상태이기 떄문에 잠시 유지
  - 로그인 후에, 새로고침 시 로그아웃 되어버리는 상황도 수정을 해야 함
    - 현재 로그인 한 후에, useEffect를 통해서 데이터를 확인하고 토큰이 유효하다면 정상적으로 로그인 유지는 되지만, 새로고침 시 깜빡거리면서 메인헤더가 변경되는 것이 보이기 때문에 이 부분을 수정할 수 있으면 수정할 생각이다.
  - 로그인을 유지하고 있을 때, token이 만료 시간에 가까워지면 자동으로 갱신되는 로직을 추가 해야 함
    - 대충 구성만 되어 있는 상태로, 좀 더 자세한 코드와 테스트가 필요함
  - 로그인 시 주어지는 토큰을 확인하고, 해당 토큰을 통해 인증하고 게시글, 댓글, 답글 관련 기능을 활성화해주는 코드를 구성해야 함
    - 전체적으로 저 인증을 확인할 수 있게 해주는 것이 1차 목표로, 애플리케이션 전체에서 인증을 확인할 수 있게 된다면 쉽게 구성이 될 것으로 예상된다.
      - Context API를 추가해서, 로그인 유무를 전체에서 알 수 있도록 구성해주고 필요할 때 내용을 가져와서 사용 할 수 있다.
        - 구성 함
    - 세션과 연동이 가능한 부분이 있는지도 테스트가 필요함
      - 불가능, 세션이나 jwt 토큰 중 하나만 사용하는 것이 좋다.
      - 세션을 삭제하는 작업을 아직 하지 않아서 해줘야 함
    - Context API를 사용하는 것은 좋지만, 이 내용을 사용하려는 파일에서 하나하나 추가해서 사용하기 때문에 커스텀 Hook을 구성해서 재사용할 수 있도록 해줄 필요가 있음
  - 오류 페이지 이동에 대한 처리가 필요
    - 다른 오류 페이지는 구성이 되었고, 본인이 작성하지 않은 게시글 수정에 접근하는 것에 대한 오류 페이지 이동만 추가하면 된다.
    - 추가로 프로필 페이지나 게시글 수정 페이지는 문제가 없는데, URL에서 게시글 추가 페이지를 먼저 접근하고 오류 페이지에서 로그인하면 name이 전송되지 않아서 에러가 뜨기 떄문에 이 부분 확인이 필요함
  - 백엔드의 user-router.js에서 accessToken, login/success, profile router에서 모두 accessToken 함수 내용을 재사용하고 있는데, 굳이 3개의 router로 나눌 필요가 있는 지 확인해보고 필요가 없다면 하나로 줄여줘야 함
    - 명확하게 하기 위해서 일단은 하나로 합치지 않고, 그대로 나눠서 사용하도록 유지
    - 내용이 엄청 많은 코드로 구성된 것이 아니기 때문에 현재로서는 크게 문제 없다고 생각되어 그대로 유지
  - 액세스 토큰, 리프레시 토큰 버튼을 메인헤더에서 제거해야 함
    - 일단 주석처리해서 사용하지 않도록 변경
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함

# 오늘 느낀 점

- 에러 페이지들이 이전보다 좀 더 보기 편해졌고, NotFound 페이지는 홈으로 돌아가는 버튼도 생겨서 UX가 이전보다 더 좋아진 것 같다고 생각이 된다. 로그인과 회원가입 모달에서 각각 버튼을 통해서 바로 전환되는 것을 구현해보려고 했으나 현재는 제대로 구현에 실패했다. 이전에 페이지로 구성할 때는 단순하게 a 태그를 통해서 페이지로 이동하도록 해주면 문제가 없었으나, 현재는 모달로 구성이 되어있기 떄문에 다른 방법을 사용해서 구성을 해줘야 한다. 현재 생각한 방법으로는 하나의 컴포넌트에서 로그인과 회원가입 모달 내용을 동적으로 구성해서 사용하면서 동시에 useState와 이벤트 핸들러 함수를 통해서 반대로 전환이 되는 방식으로 구현을 하면 가능할 것 같다는 생각이 들어서 이 방법으로 구성을 해볼 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
