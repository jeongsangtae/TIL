# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 게시글 추가 버튼에 비활성화 기능 추가
    - 로그인을 하지 않았을 때, 게시글 추가 버튼 클릭 시 오류가 발생하기 때문에 로그인을 하지 않았을 때는 게시글 추가 버튼이 비활성화 되고, 작동할 수 없도록 하기 위해서 내용 추가
    - 프론트엔드 구성
      - useLoaderData Hook을 추가해서, useLoaderData에서 userData가 있는지 확인하는 조건문을 추가
      - useLoaderData.userData가 있는 경우 게시글 추가 버튼이 활성화가 되도록 구성
      - useLoaderData.userData가 없는 경우 게시글 추가 버튼에 opacity className이 추가되어, 게시글 추가 버튼이 비활성화 되도록 구성
    - 테스트 해본 결과 정상적으로 활성화, 비활성화가 되긴 하지만 문제는 실시간으로 반영이 되지 않기 때문에 로그인을 하고 로그아웃을 했을 때 실시간으로 게시글 추가 버튼에 className이 반영되도록 해줘야 한다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/457bf989887aa7473879ed822ae26a544efb8a6a)

  <br />

  - 게시글 추가 버튼 비활성화 실시간 반영 추가 구성 (실패)
    - 게시슬 추가 버튼이 로그인했을 때와 로그인 하지 않았을 때, 실시간으로 className이 반영되어 변경되도록 구성해줬지만, 아직도 실시간으로 반영되는 것이 아닌, 새로고침을 해야 반영되기 때문에 다른 방법으로 구성을 해야 함
    - 프론트엔드 구성
      - useEffect를 추가해서 useLoaderData에 userData가 들어올 때, 활성화되는 className이 들어가고, userData가 들어오지 않으면 비활성화되는 opacity가 추가되도록 if문 추가
      - useEffect의 의존성 배열로 useLoaderData 관련 내용을 넣어주며, useLoaderData가 호출될 때 반영되도록 구성
      - JSX 코드의 게시글 추가 버튼에서 조건문을 변경해서 삼항 연산자가 아닌, 앞에서 작동한 조건을 통해 className 내용이 들어오도록 구성
    - 구성한 내용을 테스트해본 결과, 문제가 있었는데 새롭게 추가한 useEffect는 useLoaderData가 변경될 때 작동은 되지만, useLoaderData가 작동할 때는 게시판 버튼을 클릭해서 들어올 때 변경되기 때문에 로그인을 했을 때는 실시간으로 반영이 되지 않는 문제가 있다.
      - 이 문제를 해결하기 위해서 2가지 방법을 생각했는데, 생각한 방법으로 코드를 다시 구성하고 테스트 해봐야 한다.
      - 첫 번째 방법
        - 메인 헤더가 변경되는 것을 감지하는 내용을 prop으로 전달해서 반영시키기
      - 두 번째 방법
        - 로그인할 때, 게시글 추가 버튼의 조건이 바로 변경되도록 해주는 방법
      - 두 번째 방법에서 로그인했을 때 해당 내용을 전달하거나 확인할 방법이 필요하고, 첫 번째 방법에서는 메인 헤더가 모든 페이지에 포함되어 있기 떄문에 해당 내용에 적용되는 조건을 전달해주면 될 것 같은데, 테스트를 해보면서 코드를 구성해야 정확하게 파악이 될 것 같다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/961ab1e883e9cce40e91f1f005ef6caf6c649e89)

<br />

- 추가 및 해결 해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
  - 로그인 후에, 새로고침 시 로그아웃 되어버리는 상황도 수정을 해야 함
    - 현재 로그인 한 후에, useEffect를 통해서 데이터를 확인하고 토큰이 유효하다면 정상적으로 로그인 유지는 되지만, 새로고침 시 깜빡거리면서 메인헤더가 변경되는 것이 보이기 때문에 이 부분을 수정할 수 있으면 수정할 생각이다.
  - 로그인을 유지하고 있을 때, token이 만료 시간에 가까워지면 자동으로 갱신되는 로직을 추가 해야 함
    - 대충 구성만 되어 있는 상태로, 좀 더 자세한 코드와 테스트가 필요함
  - 로그인 시 주어지는 토큰을 확인하고, 해당 토큰을 통해 인증하고 게시글, 댓글, 답글 관련 기능을 활성화해주는 코드를 구성해야 함
    - 전체적으로 저 인증을 확인할 수 있게 해주는 것이 1차 목표로, 애플리케이션 전체에서 인증을 확인할 수 있게 된다면 쉽게 구성이 될 것으로 예상된다.
    - 세션과 연동이 가능한 부분이 있는지도 테스트가 필요함
      - 불가능 세션이나 jwt 토큰 중 하나만 사용하는 것이 좋다.
    - 일단 너무 어렵게 생각하는 것보다는 로그인 유무로 메인 헤더가 변경되기 때문에 이 내용을 가지고 테스트해보면서 하나씩 확인하면서 구성하면 될 것으로 예상됨

# 오늘 느낀 점

- 게시글 추가 버튼이 조건에 따라 활성화 비활성화되는 것은 어렵지 않았지만, 로그인을 했을 때 실시간으로 적용시켜주는 것에서 어려움을 겪었다. 현재 찾아야 할 해결책은 로그인을 했을 때 해당 정보가 실시간으로 반영되어 게시글 추가 버튼의 className이 변경되도록 해줘야 하는데, 현재 생각한 방법으로 메인 헤더가 변경되면 해당 내용을 감지해서 함께 게시글 추가 버튼의 className이 실시간으로 변경되는 방법과 로그인을 했을 때 관련된 내용이 전달되어 게시글 추가 버튼의 className이 실시간으로 변경되는 방법, 이렇게 두 가지 생각을 했는데 아직 테스트를 해보지 않아서 생각한 방법으로 구현이 될 지 확신이 없기 때문에, 테스트를 진행해봐야 정확히 알 수 있을 것 같다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
