# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 로그인, 회원가입에서 서로 반대 전환이 가능하도록 구성 변경
    - 메인헤더에서 구성된 로그인, 회원가입 토글 핸들러에 해당 모달을 여는 동시에 다른 모달을 닫는 내용을 추가하고 로그인, 회원가입 컴포넌트에 해당 토글 핸들러를 전달해서 사용하도록 구성을 해주었다.
    - 프론트엔드 구성
      - 메인헤더 컴포넌트의 signupToggleHandler, loginToggleHandler 함수에 각각 로그인과 회원가입 모달을 닫도록 업데이트하는 useState를 추가
      - 로그인에는 회원가입 toggle 내용을 prop으로 전달
      - 회원가입에는 로그인 toggle 내용을 prop으로 전달
      - 로그인, 회원가입에서 전달 받은 toggle을 각각 반대로 전환하는 버튼에서 사용
      - CSS에서 간단한 내용을 추가해서 다른 버튼과 간격을 주도록 구성
    - 구성한 내용을 테스트한 결과, 로그인에서 "회원가입 하러가기" 버튼을 클릭하면 회원가입 모달창으로 변경되고, 반대로 회원가입에서 "로그인 하러가기" 버튼을 클릭하면 로그인 모달창으로 변경되는 것을 확인할 수 있다.
      - 하나의 컴포넌트에서 로그인과 회원가입 내용 구성을 합치지 않고, 메인헤더 컴포넌트에서 구성된 로그인, 회원가입 모달을 toggle하는 내용에 서로의 toggle 내용을 추가하고 전달해서 사용하는 것으로 구성해주었다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/d8b4245c9308aa7d92dd8cfdf0a10d26e54771a9)

<br />

- 추가 및 해결 해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
    - 이 부분은 session을 삭제하게 되면 더 이상 신경쓰지 않아도 되지만, 현재는 session을 그냥 놔둔 상태이기 떄문에 잠시 유지
  - 로그인 후에, 새로고침 시 로그아웃 되어버리는 상황도 수정을 해야 함
    - 현재 로그인 한 후에, useEffect를 통해서 데이터를 확인하고 토큰이 유효하다면 정상적으로 로그인 유지는 되지만, 새로고침 시 깜빡거리면서 메인헤더가 변경되는 것이 보이기 때문에 이 부분을 수정할 수 있으면 수정할 생각이다.
  - 로그인을 유지하고 있을 때, token이 만료 시간에 가까워지면 자동으로 갱신되는 로직을 추가 해야 함
    - 대충 구성만 되어 있는 상태로, 좀 더 자세한 코드와 테스트가 필요함
  - 로그인 시 주어지는 토큰을 확인하고, 해당 토큰을 통해 인증하고 게시글, 댓글, 답글 관련 기능을 활성화해주는 코드를 구성해야 함
    - 전체적으로 저 인증을 확인할 수 있게 해주는 것이 1차 목표로, 애플리케이션 전체에서 인증을 확인할 수 있게 된다면 쉽게 구성이 될 것으로 예상된다.
      - Context API를 추가해서, 로그인 유무를 전체에서 알 수 있도록 구성해주고 필요할 때 내용을 가져와서 사용 할 수 있다.
        - 구성 함
    - 세션과 연동이 가능한 부분이 있는지도 테스트가 필요함
      - 불가능, 세션이나 jwt 토큰 중 하나만 사용하는 것이 좋다.
      - 세션을 삭제하는 작업을 아직 하지 않아서 해줘야 함
    - Context API를 사용하는 것은 좋지만, 이 내용을 사용하려는 파일에서 하나하나 추가해서 사용하기 때문에 커스텀 Hook을 구성해서 재사용할 수 있도록 해줄 필요가 있음
  - 오류 페이지 이동에 대한 처리가 필요
    - 다른 오류 페이지는 구성이 되었고, 본인이 작성하지 않은 게시글 수정에 접근하는 것에 대한 오류 페이지 이동만 추가하면 된다.
    - 추가로 프로필 페이지나 게시글 수정 페이지는 문제가 없는데, URL에서 게시글 추가 페이지를 먼저 접근하고 오류 페이지에서 로그인하면 name이 전송되지 않아서 에러가 뜨기 떄문에 이 부분 확인이 필요함
  - 백엔드의 user-router.js에서 accessToken, login/success, profile router에서 모두 accessToken 함수 내용을 재사용하고 있는데, 굳이 3개의 router로 나눌 필요가 있는 지 확인해보고 필요가 없다면 하나로 줄여줘야 함
    - 명확하게 하기 위해서 일단은 하나로 합치지 않고, 그대로 나눠서 사용하도록 유지
    - 내용이 엄청 많은 코드로 구성된 것이 아니기 때문에 현재로서는 크게 문제 없다고 생각되어 그대로 유지
  - 액세스 토큰, 리프레시 토큰 버튼을 메인헤더에서 제거해야 함
    - 일단 주석처리해서 사용하지 않도록 변경
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함

# 오늘 느낀 점

- 로그인과 회원가입 모달을 하나로 합쳐서 재사용하도록 구성하고 서로 반대 전환이 되도록 하려고 했으나, 유지보수에서도 좀 어려울 것 같다는 생각이 들었고 코드 구성에 복잡하다고 느껴서 일단은 따로 사용하면서 반대 전환이 정상적으로 이루어지는지 테스트를 해보았는데 반대 전환은 성공적으로 구성이 된 것 같다. 로그인과 회원가입을 하나로 굳이 합치는 것보다 커스텀 훅을 사용하는 방향도 생각을 해보고 있는데, 하나의 컴포넌트로 합칠 경우, 조건과 상태를 변경해야 할 때 그리고 코드 수정이나 기능을 추가 시 유지보수가 좀 어려울 수 있기 때문에 많이 고민이 되는데 이 부분은 좀 더 고민을 해보고 결정을 해야 할 것 같다. 일단 반대 전환이 정상적으로 이루어지기 때문에 놔둔 상태로, 다른 사용자가 자신의 게시글 수정 페이지에 URL로 접근하지 못하도록 하는 내용부터 추가를 해줄 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
