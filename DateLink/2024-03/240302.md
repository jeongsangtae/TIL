# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 답글 첫 번째 문제 수정
    - 댓글에서 문제가 발생했던 것과 마찬가지로, 답글에서도 수정 버튼을 클릭하고 내용을 변경하지 않고 수정 버튼 클릭 시 빈 문자열이 DB에 저장되면서 화면에도 빈 문자열이 보이는 문제가 있었기 때문에 수정해주었다.
      - 댓글에서 해당 문제를 고쳐보았기 때문에 그 방법을 사용해서 수정
    - 프론트엔드 구성
      - trim을 추가하고 빈 문자열이 들어온다면 이전의 내용인 replyData의 content 내용을 전달
      - 빈 문자열이 아닌, 변경된 내용이 reply에 저장되어 들어온다면 해당 내용을 전달해서 수정
      - 추가로 reply와 관련된 useState 초기 값을 설정하지 않아서, trim과 관련된 내용을 추가해서 오류를 수정했을 때 에러가 발생해서 빈 문자열을 추가해서 에러를 해결해주었다.
    - 댓글에서 문제를 해결해본 경험으로 쉽게 답글에서도 해당 문제를 해결할 수 있었다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/c92465c9f8a779e301c7382c400477cf247c2716)

  <br />

  - 답글 두 번째 문제 수정
    - 댓글에서 추가한 답글만 보여져야 하지만, 댓글에서 추가하지 않은 다른 답글도 모두 중복으로 보여지고 있기 때문에 이 내용을 수정해주었다.
    - 프론트엔드 구성
      - 백엔드에서 답글에 저장된 post_id를 확인하고 post.\_id와 일치하는 모든 답글을 프론트엔드로 전달하고 있다.
      - 모든 댓글에서 게시글 \_id에 해당하는 모든 답글을 보여지고 있기에, 프론트엔드에서 filter 함수를 추가해서 내용을 걸러내고 댓글의 \_id와 일치하는 내용만 보여지도록 수정해주었다.
      - Comment 컴포넌트에서 commentId를 prop으로 전달하고 있기 때문에 commentId를 사용해서 전달받은 replies 내용의 comment_id와 commentId를 비교해서 일치하는 내용만 보여주도록 구성
      - 댓글 \_id와 답글에 저장된 댓글 \_id를 확인해서 일치하는 내용만 보여주기 때문에 이제는 다른 댓글에서 추가하지 않은 답글이 중복으로 보여지지 않게 된다.
    - 막상 구성한 내용을 보면 어려운 코드도 아닌데, 해결법을 찾기 위해서 많은 어려움이 있었다고 생각이 된다.
      - GET method를 통해서 commentId를 전달할 수 있다면 정말 좋았을 것 같지만, body로는 데이터 전송이 불가능하고 URL 파라미터로 전송하기에는 댓글의 번호를 하나하나 URL에 추가시키는 것은 불필요한 작업이라고 생각되어 프론트엔드에서 처리하는 방식으로 구성했다.
      - 현재 구성한 방식은 모든 댓글을 가져와서 filter로 걸러내서 보여주는 방식인데, 사실 모든 댓글을 가져와서 보여주는 방식은 별로 사용하고 싶지 않았지만 현재 다른 방법이 없고, 생각이 나지 않아서 어쩔 수 없이 모든 답글 데이터를 가져와서 filter로 걸러내서 보여주도록 해주었다.
    - 해결하기 위해 시도 해본 방법을 정리
      - 백엔드에서 답글을 map 함수를 사용해서 모든 답글 정보를 배열로 얻어서 프론트엔드로 전달하는 방식으로 시도
        - 이 방법 또한 모든 답글 정보를 전달하는 방식으로, 처음으로 시도한 방법인데 이 내용으로 테스트해본 결과 key prop 오류가 발생해서 이 방법은 최종적으로 선택하지 않았다.
        - key prop 오류를 수정할 수는 있지만, 결국 모든 답글 정보를 가져오는 것을 똑같기 때문에 굳이 오류를 발생시켜서 수정하는 불필요한 작업은 할 필요가 없다고 느껴서 이 방법은 선택되지 못했다.
    - 백엔드에서 map 함수를 사용하고, Promise.all을 사용한 코드를 테스트 해보기 위해 정말 많은 console.log를 확인해보고 확인 해보았는데, 여러 문제가 많아서 최종적으로 filter를 사용한 방법이 제일 쉽고 간단하게 구성할 수 있었다.
      - 추가로 다른 방법도 생각해본게 있는데 그 방법을 한 번 테스트 해볼 생각이다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/b69534fe4ed01ab3598a77710ee510e74f279cb1)

  <br />

  - 세 번째 문제 수정
    - 게시글, 댓글, 답글의 수정과 관련된 변수 이름에서 일관성이 없이 edit, patch, update 이런식으로 뒤죽박죽 사용하고 있었기 때문에 이 변수 이름들을 edit이 들어가는 이름으로 통일시켜서 변경해주었다.
    - 백엔드, 프론트엔드 모든 곳에서 일관성이 없이 섞여있었기 때문에 edit~, onEdit~ 과 같은 이름으로 일관성 있게 변수 이름을 변경해주니 훨씬 알아보기 쉽다고 느껴졌다.
    - patch나 update는 내용 변경과 관련된 부분에서 적합하지 않다고 생각되어 edit을 사용해서 변경
      - patch는 버그 수정이나 보안을 개선하는 데 더 적합
      - update는 새로운 정보를 추가하거나 상태를 최신으로 만드는 데 더 적합
      - 최종적으로 게시글, 댓글과 같이 내용을 수정하는 경우 edit이 더 적합하다고 판단되어 edit을 사용해서 변경
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/da896f01f0263499e5ec3943133ae36ad32c391c)

<br />

- 추가 및 해결 해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
  - 로그인 후에, 새로고침 시 로그아웃 되어버리는 상황도 수정을 해야 함
    - 현재 로그인 한 후에, useEffect를 통해서 데이터를 확인하고 토큰이 유효하다면 정상적으로 로그인 유지는 되지만, 새로고침 시 깜빡거리면서 메인헤더가 변경되는 것이 보이기 때문에 이 부분을 수정할 수 있으면 수정할 생각이다.
  - 로그인을 유지하고 있을 때, token이 만료 시간에 가까워지면 자동으로 갱신되는 로직을 추가 해야 함
    - 대충 구성만 되어 있는 상태로, 좀 더 자세한 코드와 테스트가 필요함
  - 게시글 수정과 관련된 로직 확인 필요
    - 게시글 수정을 한 후, 게시글 목록이 아닌 게시글 세부 페이지가 보여지게 수정이 필요함
  - textarea 내용 수정 필요
    - 게시글, 댓글, 답글에서 사용하는 textarea의 크기가 고정되도록 변경해주고 다음 라인으로 넘겨서 입력한 내용이 그대로 보여지게 구성을 해줘야 함
  - 댓글에 작성된 답글을 보여주는 부분에서 추가로 다른 방법을 테스트해봐야 함
    - URL에 내용을 추가하지 않고 API 엔드포인트와 fetch 함수 경로를 일치시켜서 commentId 내용이 전달되는지 확인해봐야 함

# 오늘 느낀 점

- 결과적으로 세 가지 문제 모두 다 수정은 완료했지만, 두 번째 문제인 답글과 관련된 내용에서, 답글 데이터를 모두 가져와서 불필요하게 작업하지 않는 쪽으로 구성을 하고 싶은데 도저히 다른 방법이 생각나지 않아서 모든 답글 데이터를 가져오고 filter로 걸러내서 보여지도록 구성을 해주었다. 다른 방법이 갑자기 생각나서 그 방법을 테스트 해볼 생각인데, commentId 내용을 fetch 함수 경로에 추가시키고 API 엔드포인트에 연결해서 commentId 내용이 전달이 되는지 확인해보고 전달이 된다면 해당 내용으로 구성을 변경해줄 생각이다. 그리고 현재 애플리케이션에서 여러 기능을 테스트 해본 결과 조금 불편한 몇 가지가 있어서 해당 내용을 수정해주고 좀 더 UX가 편하도록 변경해줄 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
