# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 댓글 추가 및 수정 form 분리
    - 댓글을 추가한 후에, CommentForm의 내용이 초기화되지 않고 추가한 내용이 그대로 남겨져 있기 때문에 이 문제를 해결하기 위해서 댓글과 관련된 form은 따로 분리해서 작동하도록 구성해주었다.
      - CommentForm 컴포넌트 하나만 사용하는 채로 해당 문제를 수정해보려고 했지만, defaultValue를 사용해서 구성하고 있는 비제어 컴포넌트 방식을 사용하기 때문에 어쩔 수 없이 댓글 추가와 관련된 form 컴포넌트를 따로 추가하고 제어 컴포넌트로 구성해서 값을 제출하고 난 후에 초기화되도록 구성해주었다.
    - 프론트엔드 구성
      - 특별한 내용을 추가한 것이 아닌, 이전에 사용한 CreateComment 컴포넌트와 EditComment 컴포넌트를 다시 추가하고 분리해서 내용을 구성해주었다.
      - CreateComment에서는 commentId의 내용을 body에 전달하지 않고, trim과 관련된 내용도 없으며, toggle 없이 항상 댓글 form이 보이도록 구성해주고 value를 통해서 값이 제출된 후에 초기화된 내용이 보여주도록 구성
      - EditComment에서는 내용 수정을 위한 trim, 어떤 댓글의 내용을 편집하는 지 확인할 수 있는 commentId, 수정 form을 열고 닫기 위한 toggle을 구성하고, defaultValue를 사용해서 form을 열었을 때, DB에 저장된 내용이 들어오도록 구성
    - 추가와 수정 form을 분리하지 않고, 하나의 form에서 해결을 하고 싶었지만 아무리 여러 방법을 테스트해봐도 해결되지 않아서 결국 form 컴포넌트를 분리해서 작업해주고 새로운 댓글을 추가한 후에는 form이 초기화되도록 구성해주었다.
      - 방법이 있을 수도 있다는 생각이 들어서, 예전에 작성한 코드를 살펴보고 다시 확인해봐야 할 것 같다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/cfe6c56a3753bf901bb47f425b2702c1acbac6c4)

  <br />

  - 제어 컴포넌트와 비제어 컴포넌트
    - 제어 컴포넌트
      - React 상태에 의해 값이 제어되며, value 속성이 React 상태에 의존하게 된다.
      - onChange 이벤트 핸들러를 통해 상태를 업데이트해주어야 입력 필드의 값이 변경된다.
      - value를 사용하면 React 상태에 저장된 값으로 입력 필드의 값을 강제한다.
        - 상태가 변경되어야 입력 필드의 값도 변경된다.
    - 비제어 컴포넌트
      - defaultValue를 사용하면 초기값을 설정하지만, 후속 업데이트는 React가 관리하지 않고, DOM 자체가 처리하게 된다.
      - 사용자 입력에 따라 값이 변경되지만, React 상태와는 독립적으로 동작한다.
      - defaultValue를 사용하면 컴포넌트가 처음 렌더링 될때만 값을 설정하고, 사용자가 입력 필드를 수정할 때 React가 이를 강제로 제어하지 않는다.
    - 비제어 컴포넌트의 장점
      - 코드 단순화
        - form 데이터를 처리할 때, 비제어 컴포넌트를 사용하면 상태 관리 로직이 간소화될 수 있다.
        - 모든 입력 상태를 React 컴포넌트에서 추적하지 않아도 되기 때문에, 코드가 더 단순해질 수 있다.
      - 비동기 데이터
        - 폼에 비동기적으로 로드되는 데이터를 사용해야 할 때, 비제어 컴포넌트를 사용하면 초기값을 설정한 후, 사용자의 입력을 직접 관리할 수 있다.
        - 데이터가 준비되기 전까지 폼을 렌더링하고 사용자의 입력을 받을 수 있게 해줄 수 있다.
      - 서드 파티 DOM 라이브러리와 통합
        - React 외부의 서드 파티 라이브러리를 사용해야 할 때가 있는데, 이러한 라이브러리들은 대개 자체적인 상태 관리를 가지고 있으며, 이를 React의 상태 관리 시스템과 분리하여 운영하는 것이 더 쉬울 수 있다.
        - 비제어 컴포넌트를 사용하면, 이러한 외부 라이브러리와의 통합이 보다 수월해질 수 있습니다.
    - 비제어 컴포넌트의 단점
      - React 컴포넌트 외부에서 form의 상태가 관리되기 때문에, form의 상태를 완전히 제어하고 싶거나, 상태에 따른 UI 업데이트가 필요한 경우에는 제한적일 수 있다.
    - 제어와 비제어 컴포넌트를 섞어서 사용하는 가?
      - 이 같은 접근 방식은 각각의 form 요소나 사용 사례의 특성에 따라 최적의 해결책을 선택할 수 있는 유연성을 제공한다.
      - 최적화된 사용자 경험
        - 특정 form은 실시간으로 데이터를 검증하고 사용자 피드백을 제공해야 할 수도 있기 때문에 이 경우 제어 컴포넌트가 더 적합
        - 다른 경우에는 form 제출 시에만 데이터를 처리하면 되므로 비제어 컴포넌트가 더 효율적이다.
      - 개발 효율성
        - 프로젝트의 특정 부분에서는 개발 속도를 높이기 위해서 비제어 컴포넌트를 사용하는 것이 더 낫다.
        - 복잡한 상태 로직이 필요한 곳에서는 제어 컴포넌트를 사용하는 것이 더 적절하다.
      - 서드 파티 라이브러리 통합
        - 서드 파티 라이브러리는 내부적으로 상태를 관리하는 방식을 사용하므로, 이러한 경우 비제어 컴포넌트를 사용하는 것이 자연스럽다.
        - 동시에 애플리케이션의 다른 부분에서는 React의 상태 관리 시스템을 통해 직접 form 상태를 관리하는 것이 더 적합할 수 있다.
    - 실무에서의 적용
      - 제어와 비제어 컴포넌트를 섞어서 사용하는 방식은 React 프로젝트에서 매우 유용하고 타당한 접근 방법이다.

<br />

- 추가 및 해결 해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
  - 로그인 후에, 새로고침 시 로그아웃 되어버리는 상황도 수정을 해야 함
    - 현재 로그인 한 후에, useEffect를 통해서 데이터를 확인하고 토큰이 유효하다면 정상적으로 로그인 유지는 되지만, 새로고침 시 깜빡거리면서 메인헤더가 변경되는 것이 보이기 때문에 이 부분을 수정할 수 있으면 수정할 생각이다.
  - 로그인을 유지하고 있을 때, token이 만료 시간에 가까워지면 자동으로 갱신되는 로직을 추가 해야 함
    - 대충 구성만 되어 있는 상태로, 좀 더 자세한 코드와 테스트가 필요함
  - textarea 내용 수정 필요
    - 게시글, 댓글, 답글에서 사용하는 textarea의 크기가 고정되도록 변경해주고 다음 라인으로 넘겨서 입력한 내용이 그대로 보여지게 구성을 해줘야 함
  - 게시글 삭제 시 댓글과 답글도 함께 삭제되도록 구성 추가해야 함
    - 댓글도 마찬가지로 삭제 시, 댓글에 작성된 답글도 삭제되도록 구성을 추가해줘야 함
    - 백엔드에서 수정하면 될 것으로 생각된다.

# 오늘 느낀 점

- 댓글을 추가했을 때 form이 초기화 되는 내용, textarea 크기 고정과 다음 라인 입력에 대해 그 상태로 저장되도록 하는 내용, 게시글과 댓글 삭제 시 그 아래에 있는 항목도 함께 삭제되도록 해주는 내용 이렇게 세 가지 내용을 수정해주고 마무리 하려고 했는데, 댓글과 관련된 내용에서 여러가지 테스트 해보느라 다른 내용을 변경해주지 못했다. 댓글을 추가했을 때 form이 초기화 되는 부분 내용에서 해결방법이 있었는데, 그 방법은 form 컴포넌트를 추가와 수정 컴포넌트로 분리해서 작업을 해줘야 하기 때문에 그 방법을 사용하지 않고 최대한 form 분리 없이 코드 내에서 해결해보려고 했으나, 결국 테스트한 방법 모두 실패해서 CreateComment와 EditComment 이렇게 2개의 form 컴포넌트를 구성해서 작업해주었다. 이제는 댓글을 추가하고 제출했을 때 이전에 입력한 내용이 남아 있는 것이 아닌, 빈 문자열로 초기화되어 새로운 댓글 추가할 때 빈 내용에서 다시 작성할 수 있게 되었다. 댓글을 추가하고 입력 창이 초기화되는 부분에서 많은 시간을 소비했지만, 그래도 제어 컴포넌트와 비제어 컴포넌트에 대해 알게 되었고 어떤 식으로 구성되고 작동되는지, 제대로 이해하고 갈 수 있는 시간이 된 것 같아서 다행이라고 생각이 된다.

- 변경해주지 못한 textarea 관련 내용, 게시글과 댓글 삭제 시 그 아래에 있는 내용 함께 삭제되도록 해줘야 하며, 이 부분들을 수정하면 CSS도 조금 손봐주며 좀 더 알아보기 쉽게 변경해줄 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
