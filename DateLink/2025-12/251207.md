# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 사용자 프로필 구조, CSS 수정
  - 사용자 프로필 구조와 CSS를 수정해 아바타 위치와 온라인 유무 점 그리고 추가 내용들 위치가 패널과 유사한 형태로 보이도록 구성
  - 프론트엔드
    - UserProfile
      - JSX 코드 내용 수정
        - 아바타와 추가 내용 보여지는 영역 수정
          - 아바타 이미지 영역
            - user-profile-info-avatar-img-wrapper className 추가
            - img를 추가하고 className을 user-profile-info-avatar-img, src는 아바타 이미지 URL로 구성
            - div를 추가하고 className에 onlineChecked를 조건부로 구성해 온라인 상태와 오프라인 상태 다른 CSS가 적용되도록 구성
          - 아바타 색 영역
            - user-profile-info-avatar-color className 추가
            - style에 backgroundColor를 추가하고 avatarColor 또는 "#ccc"가 적용되도록 구성
            - 닉네임 첫 글자가 보이도록 구성
            - div를 추가하고 className에 onlineChecked를 조건부로 구성해 온라인 상태와 오프라인 상태 다른 CSS가 적용되도록 구성
  - CSS
    - UserProfile
      - user-profile-header-img, user-profile-header-color
        - height를 4rem로 수정
      - user-profile-info
        - flex-direction를 columnd으로 구성
        - border 내용 주석 처리
      - user-profile-info-avatar-img-wrapper, user-profile-info-avatar-color
        - position을 absolute, top을 -1rem으로 구성
      - user-profile-info-avatar-img, user-profile-info-avatar-color
        - width, height를 2rem으로 구성
        - 정렬을 위해 display, align-items, justify-content 추가
        - 폰트 두께는 bold, 텍스트 색은 흰색으로 구성
        - box-shadow는 0 0 0 3px #2f3136으로 구성
        - z-index는 1로 구성
      - user-profile-info-avatar-img
        - object-fit을 cover로 구성
      - user-profile-info-online-dot, user-profile-info-offline-dot
        - position을 absolute로 구성
        - width, height를 0.8rem으로 구성
        - bottom, right를 -1px로 구성
        - 배경색을 초록 계열로 구성
        - border을 2px solid #1e1e1e로 구성
      - user-profile-info-offline-dot
        - 배경색을 회색으로 구성
  - 사용자 프로필에서 아바타 컴포넌트를 재사용하지 않고, 자체적으로 아바타 이미지와 아바타 색 그리고 온라인 유무가 표시되도록 구성하고 CSS까지 수정해 확인한 결과, 다이렉트 채팅방 패널에서 보여지는 것과 유사하게 보여질 것으로 예상했으나 여전히 여러 내용 위치가 이상하게 어긋나게 보이는 것을 확인했으므로 추가 수정이 필요하다.
    - 다이렉트 채팅방 패널을 참고해 수정해봤지만, 여전히 어긋나는 부분들이 있어서 추가 수정 필요
    - 사용자 프로필에서 내용 클릭 시에 모달창으로 세부 내용이 보여지도록 구성 필요
    - 로그인, 회원가입 페이지 배경에 사용되는 여러 이미지를 더 추가해 테스트해봐야 함
    - 해야 할 일에 정리된 내용 처리 필요
    - 다이렉트 채팅방 순서가 변경될 때 부드럽게 변경되는 기능
    - 그룹 채팅방 위치를 자유롭게 변경하는 기능
    - 그룹 채팅방 우클릭 시에 보여지는 컨텍스트 메뉴 CSS 수정 필요 (위치, UI 등)
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/68a6e227e2ba5af6f8635d788e75cca929b0020b)

<br />

- 사용자 프로필 구조, CSS 수정 및 사용자 프로필 채팅 입력창 추가 및 채팅 Zustand 수정
  - 사용자 프로필 구조와 CSS를 추가로 수정해 다이렉트 채팅방 패널 같은 내용으로 보여지도록 구성하고, 사용자 프로필에서 다이렉트 메시지를 보낼 수 있도록 기본적인 구성 추가 및 관련 내용이 전달될 수 있도록 채팅 Zustand에 액션 추가
  - 프론트엔드
    - chatStore
      - userProfileDirectSendMessage 액션 추가
        - userId, message를 전달받도록 구성하고 string으로 타입 정의
        - userInfo를 전달받도록 구성하고 UserInfo로 타입 정의
        - newMessage 객체를 추가해 userId, message, userInfo 내용으로 구성
        - fetch 함수 추가
          - `/directChat/${userId}`로 경로 구성
          - method는 POST, body는 JSON.stringify(newMessage), headers와 credentials는 기존에 사용하던 내용 그대로 구성
        - 올바은 응답이 아닐 시에 에러 메시지를 띄우도록 구성
    - UserProfile
      - JSX 코드 내용 수정
        - 아바타와 추가 내용 보여지는 영역 수정
          - 아바타 관련 내용이 보여지는 부분과 추가 내용이 보여지는 부분을 분리해 구성하면서 아바타와 온라인 유무 내용, 추가 내용 위치가 맞춰지는 것을 확인
        - 추가 내용 영역 수정
          - div에 user-profile-info-content className 추가
          - 본인 프로필이 아닌 다른 사용자 프로필 영역
            - 같이 아는 친구 텍스트 추가 및 같이 있는 그룹 채팅방 사이에 점으로 구분되도록 구성
            - UserProfileChatInput 컴포넌트를 추가해 userId를 props로 전달
    - UserProfileChatInput
      - useAuthStore Zustand에서 userInfo를 불러오도록 구성
      - message useState 추가
        - 초기값은 빈 문자열, string으로 타입 정의
      - inputChangeHandler 함수 추가
        - event를 추가하고 `React.ChangeEvent<HTMLTextAreaElement>`로 타입 정의
        - textarea에 입력한 내용이 setMessage를 통해 업데이트되도록 구성
      - sendMessageHandler 함수 추가
        - 내용은 추가했으나 일단 주석 처리
        - 다시 추가로 구성 예정
      - keyPressHandler 함수 추가
        - event를 추가하고 `React.KeyboardEvent<HTMLTextAreaElement>`로 타입 정의
        - event.key와 "Enter"를 확인하고, 추가로 !event.shiftKey도 확인하는 조건부 추가
          - 모두 확인이 될 경우, event.preventDefault()를 통해 줄바꿈 방지하고 sendMessageHandler 함수가 실행되도록 구성
          - 엔터키를 누르면 내용이 제출되며, 시프트 + 엔터키를 누르면 줄바꿈이 적용되도록 구성
      - JSX 코드 내용 추가
        - 전체를 감싸는 div 추가
        - 전체 내에 div를 추가해 한 번 더 감싸도록 구성
        - textarea를 추가해 onChange에는 inputChangeHandler로 구성하고, onKeyDown은 keyPressHandler로 구성
        - button을 추가해 onClick은 sendMessageHandler로 구성
  - CSS
    - UserProfile
      - user-profile-wrapper
        - width, height를 15rem으로 수정
      - user-profile-header-img, user-profile-header-color
        - height를 6rem로 수정
      - user-profile-info-avatar-img-wrapper, user-profile-info-avatar-color
        - top을 -1.5rem으로 수정
      - user-profile-info-avatar-img, user-profile-info-avatar-color
        - width, height를 3rem으로 수정
        - 폰트 크기를 1.75rem으로 구성
        - box-shadow를 0 0 0 4px #43454d로 수정
      - user-profile-info-online-dot, user-profile-info-offline-dot
        - width, height를 1rem으로 수정
        - border을 3px solid #1e1e1e로 수정
      - user-profile-info-content
        - margin-top을 1rem으로 구성
  - 사용자 프로필에서 아바타 영역과 추가 내용 부분을 분리해 다이렉트 채팅방 패널과 유사하게 보여지도록 구성하고, CSS를 수정해 아바타와 온라인 점이 커진 사용자 프로필에 맞게 보여지도록 구성 및 사용자 프로필에서 다이렉트 메시지를 보낼 수 있도록 사용자 프로필 다이렉트 메시지 입력창과 해당 내용을 전달할 액션을 추가해 확인한 결과, 사용자 프로필에서 구조를 수정한 뒤로 아바타와 온라인 점 그리고 추가 내용이 올바른 위치에서 보여지는 것을 확인했고, 수정된 CSS 내용으로 인해 크기도 적절하게 보여지는 것을 확인했으며, 사용자 프로필에서 다이렉트 메시지를 보낼 수 있도록 내용을 약간 추가했지만 현재 저 내용은 기본 구성만 되어있을뿐 백엔드와 연결되어 있지 않기 때문에 추가로 내용을 구성해 테스트해볼 예정이다.
    - 사용자 프로필에서 상대방에게 다이렉트 메시지를 보낼 수 있도록 추가 구성 필요
    - 사용자 프로필에서 내용 클릭 시에 모달창으로 세부 내용이 보여지도록 구성 필요
    - 로그인, 회원가입 페이지 배경에 사용되는 여러 이미지를 더 추가해 테스트해봐야 함
    - 해야 할 일에 정리된 내용 처리 필요
    - 다이렉트 채팅방 순서가 변경될 때 부드럽게 변경되는 기능
    - 그룹 채팅방 위치를 자유롭게 변경하는 기능
    - 그룹 채팅방 우클릭 시에 보여지는 컨텍스트 메뉴 CSS 수정 필요 (위치, UI 등)
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/2c35d6c2871f6670a91a05141b5b1d9d6d3e0384)

# 오늘 느낀 점

- 사용자 프로필 내의 내용이 다이렉트 채팅방 패널과 유사한 구조로 보이도록 구조와 CSS를 수정하고, 사용자 프로필에서 상대방에게 다이렉트 메시지를 보낼 수 있도록 관련 입력창과 액션을 추가했지만 아직 연결하지도 않고, 백엔드 구성도 되어 있지 않기 때문에 이와 관련된 내용을 더 추가해 테스트해볼 생각이다. 사용자 프로필에서 사용될 다이렉트 메시지 입력창은 기존의 다이렉트 채팅방과 그룹 채팅방에서 사용되는 입력창과 다르게 방 번호를 따로 알 수 없으므로, 다른 방법으로 메시지가 백엔드로 전송되어 해당 사용자와 관련된 다이렉트 채팅방에 메시지가 저장되도록 해야 하며, 만약 해당 사용자와 대화를 나눈 다이렉트 채팅방이 없을 경우 새롭게 생성해 메시지가 전달될 수 있도록 구성해볼 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 닉네임 수정과 그룹 채팅방 제목 수정 내용에서 사용하지 않거나 필요없는 정보를 삭제해 코드 정리를 해야 함 (중복된 데이터 전송이나 사용하지 않는 데이터 전송 관련 내용 등)

- 그룹 채팅방에서 다른 사용자를 클릭할 수 있고, 클릭 시에 다이렉트 채팅방이 생성되어 채팅을 나눌 수 있도록 구성하는 것을 고려중 (이 방법 대신, 다른 사용자 클릭 시에 프로필이 보여지도록 구성하고 그 내용을 통해 다이렉트 메시지를 보내거나 프로필 내용을 보는 그런 방식으로 구성해야 함)

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

- 다크 모드 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
