# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 사용자 계정 삭제 실시간 반영 수정 및 validateDOMNesting 에러 해결
    - 사용자 계정을 삭제했을 때 해당 내용이 화면에 실시간 반영되도록 내용을 수정해주고, "validateDOMNesting"이라는 에러가 콘솔에 뜨는데 해당 문제를 해결
    - 프론트엔드 구성
      - AdminUsers
        - useState를 추가하고, useLoaderData로 들어오는 내용이 useState 초기 값으로 들어가도록 구성
        - deleteUser 내용에서, filter를 통해서 삭제된 사용자 계정을 제외한 내용이 setUsers로 업데이트되도록 구성
      - AdminUser
        - fetch 함수 내용에서 올바른 응답이 들어오는 경우, prop을 통해 전달받은 onDeleteUserData 내용에 email 내용을 다시 전달하도록 구성
        - div 태그가 p 태그 자손으로 들어가지 않도록 변경
          - p 태그 안에 div 태그가 들어가서, "validateDOMNesting" 오류가 발생하기 때문에 둘의 위치를 바꿔서 구성
    - 테스트 결과, 사용자 계정을 삭제했을 때 즉시 화면에서 실시간 반영되며 사용자 계정이 삭제되는 것을 확인했고, 콘솔에서 오류가 발생하는 부분도 태그 위치 변경으로 더 이상 보이지않는 것을 확인했다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/2b4883d80a032c127330f6b7e8c89a0aac410911)

  <br />

  - admin user delete router 수정 (추가 수정 필요)
    - 백엔드에서 구성된 사용자 계정 삭제와 관련된 router에서 사용자 계정 삭제 시, 해당 사용자가 작성한 모든 게시글의 \_id를 확인하고, 그 게시글 \_id를 가지고 일치하는 댓글과 답글도 모두 함께 삭제되도록 구성
    - 백엔드 구성
      - 삭제하려는 사용자 계정의 이메일과 posts 컬렉션에 저장된 이메일을 확인해서 일치하는 게시글을 찾는 내용을 앞으로 위치시켜서 먼저 확인하도록 구성 변경
      - 삭제하려는 사용자가 작성한 게시글이 있는 경우, 해당 게시글의 \_id와 postId를 추출하는 코드 추가
      - for문을 통해서 게시글 \_id와 일치하는 모든 항목을 찾도록 순회하고, 댓글과 답글을 삭제하는 내용에서 사용자 이메일을 확인하는 것이 아닌, 게시글의 \_id를 확인하도록 변경
      - 게시글을 삭제하는 내용에서 변수 이름만 변경
      - 정상적으로 사용자 계정이 삭제되고, email 정보를 다시 전달하는 것이 아닌 성공 메시지만 전달하도록 변경
    - 테스트 결과, 사용자 계정을 삭제했을 때 해당 사용자가 작성한 게시글의 번호와 \_id를 확인하고, 일치하는 모든 댓글과 답글 그리고 게시글을 삭제하는 것은 문제가 없는데, 여기서 추가로 다른 게시글에서 작성한 댓글이나 답글이 삭제되지 않는 것을 확인하고 로직을 잘못 짰다는 것을 깨달았다.
      - 그래서 추가로 삭제하려는 사용자가 작성한 댓글과 답글을 모두 삭제되도록 해줘야 하고, 게시글도 삭제될 때 그 게시글에 작성된 댓글과 답글도 함께 삭제되도록 구성을 다시 변경해줘야 한다.
      - 추가로, 게시글 삭제 시에 그 뒤에 있는 게시글 번호가 -1씩만 줄어드는 것이 아닌, 빈자리 번호가 메워지도록 코드를 변경해야 한다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/d54022bc83b0bc685d35a26aac017f030fffdfde)

<br />

- 추가 및 해결 해야 할 내용
  - 커스텀 Hook에 대한 고려
    - Context API를 사용하는 것은 좋지만, 이 내용을 사용하려는 파일에서 하나하나 추가해서 사용하기 때문에 커스텀 Hook을 구성해서 재사용할 수 있도록 해줄 필요가 있음
  - 백엔드의 user-router.js에서 accessToken, login/success, profile router에서 모두 accessToken 함수 내용을 재사용하고 있는데, 굳이 3개의 router로 나눌 필요가 있는 지 확인해보고 필요가 없다면 하나로 줄여줘야 함
    - 명확하게 하기 위해서 일단은 하나로 합치지 않고, 그대로 나눠서 사용하도록 유지
    - 내용이 엄청 많은 코드로 구성된 것이 아니기 때문에 현재로서는 크게 문제 없다고 생각되어 그대로 유지
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함

# 오늘 느낀 점

- 사용자 계정을 삭제했을 때 화면에 실시간 반영이 되지 않는 문제를 해결해주고, 콘솔에서 확인되는 오류도 더이상 보이지 않는 것을 확인할 수 있었다. 그리고 사용자 계정이 삭제될 때 그 사용자가 작성한 게시글이 모두 삭제되는 것은 문제가 없는데, 댓글과 답글 부분에서 조금 문제가 있어서 그 부분을 수정해줬지만 여전히 내가 생각한 것과 다르게 작동하기 때문에 이 부분에서 추가 수정이 필요하다. 이전에 사용하던 내용인 댓글과 답글에서도 삭제하려는 사용자 이메일과 일치하는 항목을 모두 삭제하도록 하면 될 것 같은데, 한 번 추가해서 테스트를 해봐야 정확히 알 수 있을 것 같다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
