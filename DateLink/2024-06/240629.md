# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 관리자 채팅창의 스크롤, input 초기화 등 내용을 추가하고 UI 구성 변경을 위한 CSS 내용 수정
    - 사용자 채팅창에서의 스크롤 이동과 관련된 코드, input 초기화 관련된 코드 등 작업을 해주고 테마 모드 변경 및 UI 구성도 변경했었는데, 사용자 채팅창만 작업해놓고 관리자 채팅창은 작업을 해주지 않았기 때문에 관리자 채팅창에서도 사용자 채팅창과 유사하게 작업을 해주었다.
    - 프론트엔드 구성
      - useRef, useContext 추가
      - 빈 문자열임을 확인하는 useState, 스크롤을 아래로 내리는 버튼의 유무를 확인하는 useState 추가
        - 빈 문자열을 확인하는 useState 초기값은 true, 버튼 유무는 false로 구성
      - 채팅창의 길이가 늘어나는 것을 확인해서 스크롤을 늘리는데 사용되는 useRef, 메시지가 마지막에 추가된 메시지인지 확인하는 useRef를 추가
        - 둘 다 null을 초기값으로 구성
      - useEffect를 추가해서, 스크롤 관련 내용을 구성하고 의존성 배열에 messages를 넣어서, 스크롤이 맨 밑에 있는 경우 새로운 메시지가 추가되면 스크롤이 자동으로 맨 밑으로 이동하면서 맨 밑으로 이동하는 버튼이 보여지지 않도록 구성
      - 메시지를 전송하는 함수에서, adminId 정보가 정상적으로 넘어오는지 확인하고 메시지 입력이 비어있다면 버튼이 활성화되지 못하도록 해주고 메시지 입력을 했을 경우에만 다음 코드로 이동하도록 구성
        - 메시지를 입력하고 전송이 된 후에, 메시지 입력창을 초기화해서 빈 칸으로 만들고, 버튼은 메시지 입력란이 빈 문자열이기 때문에 비활성화되도록 구성
      - 스크롤을 맨 밑으로 이동하는 함수 추가
      - 스크롤 높이를 확인해서 맨 밑에 있는 경우 스크롤을 맨 밑으로 이동하는 버튼이 보여지지 않고, 스크롤이 맨 밑이 아닌 경우에만 스크롤을 맨 밑으로 이동시키는 버튼이 보여지도록 구성
      - 채팅창에 테마 모드 내용을 추가하고, ul 태그에서 ref 내용을 추가해서 채팅창이 늘어나는 것을 감지하도록 구성
      - 새로운 div를 ul 태그 안에 넣어서, ref를 추가해주고 마지막에 추가된 내용을 찾을 수 있도록 구성
      - onClick에 맨 밑으로 이동시키는 버튼을 작동 시킬 함수를 넣어주고, className도 추가해서 CSS 내용을 구성할 수 있도록 추가
      - input, button을 함께 묶어서 관리하는 className를 추가하고, 테마 모드 관련 내용도 추가
        - input에 placeholder도 추가해서, 기본 색과 커서를 올렸을 때 색이 변하도록 구성
      - 메시지를 전송시키는 버튼에 useState 내용을 확인해서, 불투명도 내용이 적용되도록 구성
        - 메시지 입력을 하지 않으면 메시지를 전송할 수 없도록 구성
    - CSS 구성
      - chats-container
        - border에 선 추가
        - 다크 모드 배경 색 추가
      - bottom-button
        - 아래로 내려가도록 해주는 버튼 구성으로, 배경은 검정색 계열로 구성하고 텍스트는 흰색, 위치가 스크롤 옆, input 컨테이너로부터 위로 떨어있도록 구성
      - input-container
        - 왼쪽 아래만 둥글게해서 채팅창을 뚫고 input 내용이 보이지 않도록 해주고, 버튼과 구분을 위해서 오른쪽에만 border 내용 추가
          - 배경은 기본 흰색, 텍스트는 검정이며, 다크 모드에서 배경은 검정 계열 텍스트는 흰색으로 구성
        - 입력 창이 focus 되었을 때 테두리가 생기지 않고, 깜빡이는 커서만 보이도록 구성
        - 버튼의 오른쪽 아래를 둥글게해서 채팅창을 뚫고 보이지 않도록 구성해주고, 색은 배경을 따라가도록 해주고, 버튼이 hover되었을 때 색이 조금 변하도록 구성
          - 다크 모드의 색도 추가
          - 불투명도 내용을 추가해서, 입력창의 입력이 비어있는 상태에서는 opacity 라는 내용이 button에 적용되어서 버튼이 활성화되지 않고, 입력창에서 내용을 입력하면 버튼에 opacity 내용이 사라지도록 구성
    - 테스트 결과, 관리자 채팅창에서도 사용자 채팅창처럼 UI가 변경되었고, 테마모드 관련 내용도 추가되었으며, 스크롤 이동에 따라서 맨 밑으로 이동하는 버튼이 보여졌다가 사라지는 것을 확인할 수 있었다. 이 외에 채팅을 입력해야 전송 버튼이 활성화되는 것도 똑같이 구성이 되었고, 다시 입력창 내용을 삭제하면 버튼이 비활성화되며 빈 문자열 채팅이 전달되지 않도록 구성을 해주었다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/b78a972ac6e63b54a3c9bb9e00191f6738ce8da7)

<br />

- 추가 및 해결 해야 할 내용
  - 채팅과 관련된 내용 구성
    - 출력되는 메시지 UI 수정 필요
      - 본인이 작성한 메시지는 오른쪽, 상대방 메시지는 왼쪽에 보이도록 구성해야 함
    - 사용자-관리자 사이의 방 번호를 설정해서 서로 채팅이 보이도록 구현해야 함
      - 관리자 부분에서 사용자 \_id를 가져오고 해당 방으로 들어가는 내용을 구성해야 함
        - 이 부분은 구현했지만 아직 부족한 구성이 있어서 추가 작업 필요
      - 관리자 채팅창에서는 채팅 버튼 클릭 시, 바로 채팅창이 들어가지는 것이 아닌 채팅창을 선택해서 들어갈 수 있도록 사용자 항목을 만들어줘야 함
        - 이 내용을 구성하기 위해서 새로운 컴포넌트도 추가 했는데, 아직 로직을 완성하지 못해서 테스트해보지 못함
    - 스크롤 작동에서 추가 작업을 해봐야 함
      - 새로운 메시지가 뜨면, 아래로 가는 버튼이 사라지고, 새로운 메시지 버튼만 보이도록 해야 함
    - 채팅창에서 사용되는 함수 이름 변경도 생각을 해봐야 하는데, 좀 더 명확하게 표현할 필요성을 느낌
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함
  - ul 요소 안의 자식이 li가 아닌, div나 프래그먼트로 사용되는 부분을 수정해야 함

# 오늘 느낀 점

- 관리자 채팅창도 사용자 채팅창처럼 UI가 변경이 되었고 구조도 조금 추가되었는데 여기에 추가로 이제 채팅창을 여는 버튼을 클릭하면, 채팅창이 바로 뜨는 것이 아닌 채팅할 상대를 고르는 목록이 보여지도록 구성을 추가해줘야 한다. 이 구성은 사용자 채팅창은 필요가 없으며 관리자 채팅창에서만 추가를 해주면 된다. 그리고 이 사용자 리스크가 보여지고 클릭 시, 해당 사용자와의 채팅방으로 접속되며 해당 사용자와 나눴던 대화만 보여지도록 구성을 해주면 딱 내가 생각한 채팅창의 모습인데, 여기서 어떤식으로 데이터를 전달하고 문제가 안생기게 해줘야 하는지 그 부분이 아직 완벽하게 짜여지지 않아서 추가로 생각을 해봐야 한다. 그리고 서로 입력한 채팅이 보여지는 것은 문제가 없는데 저장하는 것에 있어서 문제가 조금 있기 때문에 이 부분에 대한 수정을 해줘야 하며, 새로고침했을 때 서로 상대방이 입력한 채팅 내용이 안보이게 되면서 사라지게 되는데, 이게 저장 관련된 내용과 연관되어 있기 때문에 추가 구성이 필요하다. 현재 생각한 방법으로는 서로 입력한 채팅이 상대방의 컬렉션에도 저장이 되면서 거기서 userType이라는 항목 추가해서 저장하고 이제 해당 데이터를 불러와서 화면에 출력할 때, userType 항목을 확인해서 그 항목을 통해서 구분하고 보여주는 방향으로 생각했기 때문에 이에 관련된 로직을 구성해봐야 한다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
