# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 마지막 메시지로 이동하는 버튼을 추가
    - 스크롤을 사용하고 난 후에, 새로운 메시지가 있다면 새로운 메시지 버튼을 클릭해서 새로운 메시지 내용 쪽으로 스크롤이 이동하는 내용을 구성했는데, 여기서 스크롤 내용을 계산해서 이동하는 방식으로 구성해주었다. 그리고 input 창에서 내용을 제출하고 난 후에 빈 내용으로 초기화되도록 구성
    - 프론트엔드 구성
      - 새로운 메시지로 이동하는 버튼을 띄우는 것을 확인하는 useState 추가
      - 또 다른 useRef 추가
      - sendMessage의 마지막 부분에 input이 제출된 후에 빈 문자열로 초기화되도록 구성 추가
      - scrollToNewMessages 함수를 추가해서, 마지막에 추가된 메시지로 이동되면 새로운 메시지로 이동하는 버튼이 보이지않도록 구성
      - ul 요소에 ref를 추가해서 DOM 요소에 접근할 수 있도록 구성
      - ul 요소에 onScroll을 사용해서 ul 요소의 스크롤 변화를 감지하고, 함수가 작동되도록 구성
      - 스크롤 변화를 감지하고, 스크롤바가 수직으로 얼마 내려왔는지 확인하는 값과 요소의 내부 높이 값을 더해서 요소의 전체 콘텐츠 높이보다 작다면 새로운 메시지 버튼이 보이도록 useState 값을 true 구성
        - 만약 더 크거나 같다면 새로운 메시지 버튼이 보이지 않도록 useState를 false 구성
      - 새로운 메시지 버튼은 추가된 useState 내용을 확인해서, true일 때는 버튼이 보여져서 클릭 시에 마지막에 추가된 메시지 쪽으로 이동하고 버튼이 보이지 않게 된다.
        - useState 내용이 false라면 버튼은 보이지않게 구성
    - CSS 구성
      - 새로운 메시지 버튼이 보이는지 확인하기 위해서, input 창과 조금 간격을 줘서 구분만 하도록 구성
    - 테스트 결과, 스크롤이 위로 올라가면 새로운 메시지 버튼이 생겨나고, 해당 버튼을 클릭하면 맨 아래로 이동되는 것을 확인할 수 있었다.
      - 그러나, 이 기능은 문제가 조금 있는데 그 중 하나는 스크롤이 올라갈 때마다 새로운 메시지 버튼이 생겨나기 때문에 이 문제를 수정해줘야 한다.
      - 추가로, 새로운 메시지가 추가되었을 때 스크롤이 위에 있지 않은 상황에서는 바로 새로운 메시지로 스크롤이 따라가야 하지만 스크롤이 어떨때는 이동하고 어떨때는 이동하지 않고 저 버튼이 보이기 때문에 이 부분에 대한 수정도 필요하다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/626bfb116fca1999acd5e0f033257f71ea455e9c)

  <br />

  - input에서 빈 문자열 제출을 하지 못하게 막고, 빈 문자열로 제출했을 때 에러를 표시하도록 내용을 추가
    - input을 제출하고 초기화하는 것은 구성을 해놓았지만, 그 이후에 빈 문자열 상태로 제출 버튼을 누르면 경고도 없이 제출되기 때문에 빈 문자열로 제출하지 못하도록 막아주고, 빈 문자열로 제출하려고 했을 때 placeholder와 input 테두리가 빨간색으로 경고하는 느낌이 되도록 구성을 해주었다.
    - 프론트엔드 구성
      - error 내용을 저장하는 useState 추가
      - sendMessage에서 빈 문자열로 제출되지 않도록, 입력하는 메시지가 빈 문자열 상태인지 확인하고 빈 문자열이라면 setError를 통해서 error가 있음을 알려주면 바로 코드를 끝내도록 구성
        - 만약, 정상적으로 메시지를 입력하고 제출된 후에는 error가 없도록 하기 위해서 setError를 통해서 false로 만들어주도록 구성
      - input에서 내용을 입력하지 않은 채로 제출하면, sendMessage로 인해 error가 true로 변경되는데, 이 때 input에서 내용을 입력하게 되면 input이 빈 문자열이 아닌 것을 확인해서 error를 false로 변경해서 경고 className이 사라지도록 구성
        - 두 가지 방법을 생각했는데, 하나는 error가 true일 경우 바로 setError로 false를 만드는 방법
        - 또 다른 하나는 현재 사용하는 방법으로 입력한 input 내용을 확인해서 빈 문자열이 아닐 때, setError로 false를 만드는 방법을 생각했다.
        - 이 두 가지 방법 중에서 입력에 대해 유효성을 확실하게 검사하며, 코드가 좀 더 간결하고 명확하다고 생각되어 두 번째 방법을 사용했다.
      - input에서 className에 error useState를 확인해서, error가 true일 경우에는 "input-error" 내용이 추가되도록 구성해주었다.
        - error가 false일 경우에는 빈 문자열로 아무런 className도 추가되지 않도록 구성
      - input에서 error가 생겼을 때 이 경고를 확인할 수 있도록 input에 placeholder 내용을 추가
        - 경고가 생기면, input 테두리와 placeholder의 색이 변경되어 알 수 있게 구성
    - CSS 구성
      - input
        - 전체 채팅창 radius에 맞추기 위해서, input의 왼쪽 아래에만 radius 추가
        - border는 none으로 설정하고, 위쪽 border에만 선이 있도록 구성
      - input::placeholder
        - 기본 placeholder 색은 검정색보다는 연한 색으로 변경
      - input:focus
        - 포커스 되었을 때, 주위 테두리가 없도록 outline: none으로 구성
      - input:focus::placeholder
        - 포커스 되었을 때, 기본 placeholder 색보다 조금 더 옅은 색으로 보이도록 구성
      - input-error
        - 빈 문자열로 제출했을 때, 이 className이 적용되는데 이 때 위쪽 테두리만 빨간선으로 변경되도록 구성
      - input-error::placeholder
        - 에러가 발생했을 때, placeholder의 텍스트는 빨간색으로 보이도록 구성
      - input-error:focus::placeholder
        - 에러가 발생하고, 제대로 입력하기 위해서 input을 포커스하면 placehoder의 색이 조금 옅은 빨간색 계열로 보이도록 구성
      - button
        - padding을 추가해서 채팅창 크기에 버튼이 맞도록 구성해주고, 오른쪽 하단 radius를 추가해서 채팅창에 맞도록 구성
    - 테스트 결과, input에서 빈 문자열 상태로 제출하려고 하면 내용이 제출되지 않고 에러가 발생하는 것을 확인했고, 여기서 에러는 input 테두리와 placehoder 색 변경으로 표현을 했으며, 정상적으로 다시 내용을 입력하면 에러가 사라지는 것도 확인할 수 있었다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/3f1096ed6c3db58d8b4a45e8dc9efd9d9d936cf6)

<br />

- 추가 및 해결 해야 할 내용
  - 채팅과 관련된 내용 구성
    - 출력되는 메시지 UI 수정 필요
      - 본인이 작성한 메시지는 오른쪽, 상대방 메시지는 왼쪽에 보이도록 구성해야 함
    - 사용자-관리자 사이의 방 번호를 설정해서 서로 채팅이 보이도록 구현해야 함
    - 스크롤 작동에서 추가 작업을 해봐야 함
      - 스크롤을 이동했을 때는 최신 메시지 버튼이 화면에 보여지고, 해당 버튼 클릭하거나 최신 메시지 쪽으로 이동해서 메시지가 보이도록 해주고, 스크롤을 이동하지 않았을 때는 기존의 방식처럼 항상 최신 메시지로 이동되는 쪽으로 구성을 해봐야 함
      - 추가로, 스크롤 이동했을 때 새로운 메시지가 생기고 그 쪽으로 이동했다면 최신 메시지 버튼이 사라지도록 해줘야 함
    - 채팅창에서 사용되는 함수 이름 변경도 생각을 해봐야 하는데, 좀 더 명확하게 표현할 필요성을 느낌
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함
  - ul 요소 안의 자식이 li가 아닌, div나 프래그먼트로 사용되는 부분을 수정해야 함

# 오늘 느낀 점

- 스크롤이 위쪽에 있을 때, 새로운 메시지가 추가되면 새로운 메시지 버튼이 생겨서 클릭 시 이동하고, 아래쪽에 스크롤이 있는 경우에는 새로운 메시지가 추가되면 그대로 스크롤도 이동해서 새로운 메시지가 보여져야 하지만, 현재 구성된 코드에서는 내가 생각한 것과 조금 다르게 작동하기 때문에 추가로 세세한 수정이 필요해보인다. 그리고 다크 모드에서는 알 수가 없었는데, 라이트 모드로 변경하고 채팅창을 확인해보니 테두리가 허전한게 느껴지며 붕뜬 느낌이 들기 때문에, 여기에 그림자 효과를 추가하거나 테두리 선을 추가해주는게 좀 더 좋을 것 같다는 생각이 든다. 그리고 메시지 제출 버튼의 색이나 hover 되었을 때에 관한 내용이 좀 추가되어야 좀 더 깔끔한 UI 구성이 될 것 같아서 이 부분 또한 수정을 해줘야 하며, 사용자 채팅창 정리가 끝나면 관리자 채팅창도 비슷하게 정리를 해줘야 할 것 같다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
