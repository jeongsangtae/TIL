# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 사용자 채팅 데이터를 DB에 저장하는 내용 추가
    - 사용자 채팅 컨테이너에서 내용을 입력하고 해당 내용이 백엔드를 통해서 DB에 저장하는 내용을 구성해주었다.
    - 백엔드 구성
      - admin-chat-routes
        - 아직 내용은 구성하지 않고 파일만 추가
      - user-chat-routes
        - 사용자 채팅 내용을 입력하면 전달받아서 저장할 수 있도록 구성
        - 액세스토큰에 저장된 내용이 유효한 지 확인하는 내용 구성
        - URL 파라미터로 전달받은 \_id 내용을 ObjectId를 통해서 MongoDB의 \_id 내용으로 변환
        - 새로운 채팅을 저장하는데, \_id 내용으로 변환한 내용과 body로 전달받은 메시지와 이메일, 추가되는 날짜를 저장하도록 구성
          - userChat이라는 컬렉션에 저장되도록 해주고, 저장된 후에 프론트엔드로 저장된 내용을 전달하도록 구성
    - 프론트엔드 구성
      - MainHeader
        - Chat 컴포넌트를 로그인했을 때만 사용할 수 있도록 구성
        - Chat 컴포넌트에 로그인한 사용자의 \_id와 이메일 내용을 prop으로 전달
      - Chat
        - 입력한 채팅 내용을 백엔드로 전달하도록 구성
        - 백엔드로 채팅 내용을 전달하면서, prop으로 전달받은 사용자 이메일을 body에 포함
        - \_id 내용은 URL 파라미터로 전달하도록 구성
    - 테스트 결과, 로그인을 하고 채팅을 입력해서 Send 버튼을 누르면 백엔드로 전송되고, 백엔드에서 액세스 토큰을 확인한 후에 문제가 없다면 해당 사용자의 \_id, 이메일, 데이터를 전송한 시간, 입력한 내용을 DB에 저장하는 것을 확인할 수 있었다.
      - 추가로 테스트해본 결과, 문제를 하나 찾았는데 페이지를 새로고침하고 로그인하면 Chat 컴포넌트에 prop으로 전달하는 내용이 제대로 넘어가지 않아서, 오류가 발생하는 것을 확인했는데 이 부분을 고치기 위해서 추가 수정이 필요하다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/cf40248aca434e8e3388b8e1c835f41137bc90c2)

<br />

- 추가 및 해결 해야 할 내용
  - 커스텀 Hook에 대한 고려
    - Context API를 사용하는 것은 좋지만, 이 내용을 사용하려는 파일에서 하나하나 추가해서 사용하기 때문에 커스텀 Hook을 구성해서 재사용할 수 있도록 해줄 필요가 있음
  - 백엔드의 user-router.js에서 accessToken, login/success, profile router에서 모두 accessToken 함수 내용을 재사용하고 있는데, 굳이 3개의 router로 나눌 필요가 있는 지 확인해보고 필요가 없다면 하나로 줄여줘야 함
    - 명확하게 하기 위해서 일단은 하나로 합치지 않고, 그대로 나눠서 사용하도록 유지
    - 내용이 엄청 많은 코드로 구성된 것이 아니기 때문에 현재로서는 크게 문제 없다고 생각되어 그대로 유지
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함

# 오늘 느낀 점

- 우선 사용자 채팅 부분에서 입력한 내용을 DB에 저장하도록 구성을 해줬는데, 처음 테스트할 때는 문제없이 작동을 했는데, 다시 새로고침하고 테스트를 진행해보니 사용자 데이터가 바로 넘어오지 않는 문제가 발생하게 되면서, 백엔드로 "\_id" 내용이 전달되지 못하면서 오류가 발생했다. 로그인을 하고 한 번 새로고침을 한 뒤에는 Chat 컴포넌트로 문제없이 \_id, 이메일 내용이 전달되지만 로그아웃을 하고 새로고침을 해준 뒤에 다시 로그인하면 그 때는 바로 사용자 정보가 prop으로 전달되지 않기 때문에 오류가 발생하는 건데, 이 문제를 해결하기 위해서 로그인 성공하고 이 데이터를 useState에 저장한 뒤에 전달하는 것이 아닌, Context API에서 로그인 했을 때 얻는 사용자 정보를 바로 전달하거나, Chat 컴포넌트에서 Context API 내용을 사용해서 바로 전달하는 방향으로 내용을 수정해봐야 할 것 같다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
