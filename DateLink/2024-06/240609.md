# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - Socket.io의 역할 및 사용 유무 판단
    - 사용자-관리자 간의 메시지 전달을 구현하는데, 데이터를 DB에 저장하고 실시간으로 메시지를 전송하고 표시해야 하는데 사용되는 방법
      - 방법 1: React와 Socket.io 간 직접 통신
        - 클라이언트(React)와 Socket.io 서버 간의 직접 통신을 통해 실시간 메시지를 전달하고, 동시에 Socket.io 서버에서 백엔드와 통신하여 DB에 데이터를 저장
        - 클라이언트에서 사용자가 메시지를 입력하고 전송 버튼을 누르면 Socket.io를 통해 서버로 메시지를 보낸다.
        - Socket.io 서버에서 메시지를 수신하면 이를 DB에 저장하고, 해당 메시지를 다시 클라이언트들에게 브로드캐스트한다.
      - 방법 2: React에서 Express로 데이터 전송 후, Socket.io로 브로드캐스트
        - 이 방법에서는 클라이언트(React)가 먼저 메시지를 Express 서버로 전송하고, Express 서버가 DB에 저장한 후, Socket.io 서버로 메시지를 브로드캐스트한다.
        - 클라이언트에서 사용자가 메시지를 입력하고 전송 버튼을 누르면 Express 서버로 HTTP 요청을 보낸다.
        - Express 서버에서 메시지를 수신하고 DB에 저장한 후, Socket.io 서버로 메시지를 브로드캐스트한다.
      - 두 방법 모두 사용할 수 있지만, 방법 2가 더 일반적인 방법으로 React 클라이언트가 Express 서버를 통해 메시지를 전송하고, Express 서버가 메시지를 DB에 저장한 후 Socket.io를 통해 실시간으로 다른 클라이언트에게 메시지를 브로드캐스트하는 방식이다.
        - 이 방법을 통해 서버는 중앙에서 모든 비즈니스 로직과 데이터 관리를 처리할 수 있고, 클라이언트는 단순히 서버와 통신하여 데이터를 전송하고, 서버는 데이터를 저장하고 적절한 클라이언트에게 메시지를 전달한다.
      - 간략하게 요약하면, 사용자가 메시지를 입력하고 전송 버튼을 누르면 React 클라이언트에서 메시지를 Express 서버로 HTTP 요청을 통해 전송하고, Express 서버에서 메시지를 수신한 후, 이를 MongoDB에 저장한 다음에 메시지가 성공적으로 저장되면, Express 서버는 해당 메시지를 Socket.io를 통해 모든 연결된 클라이언트에게 브로드캐스트한다.
        - React -> Express로 메시지 전송
          - React 클라이언트가 HTTP POST 요청을 통해 메시지를 Express 서버의 특정 엔드포인트로 전송
        - Express 서버에서 메시지 저장 및 Socket.io로 브로드캐스트
          - Express 서버는 수신한 메시지를 MongoDB에 저장
          - 메시지가 성공적으로 저장된 후, Express 서버는 Socket.io를 통해 저장된 메시지를 모든 연결된 클라이언트에게 브로드캐스트한다.
    - React -> Express -> MongoDbB 이 순서로 전달 및 저장해서 클라이언트에서 바로 MongoDB에 저장된 데이터를 보여주면 될 것 같은데, 굳이 Socket.io가 필요한 이유는 ?
      - Socket.io가 필요한 이유는 `실시간 업데이트`와 `효율적인 데이터 전달` 때문이다.
      - React -> Express -> MongoDB만 사용하는 경우
        - 메시지 전송 및 저장
          - React 클라이언트가 메시지를 Express 서버로 보내고, Express 서버가 메시지를 MongoDB에 저장
        - 메시지 표시
          - React 클라이언트는 메시지를 표시하기 위해 주기적으로 서버에 HTTP 요청을 보내서 새 메시지를 가져와야 함
          - 이 방식은 새 메시지를 실시간으로 보여주지 않는다. 클라이언트가 주기적으로 데이터를 요청하는 방식이기 때문에 일정한 딜레이가 발생한다.
      - React -> Express -> MongoDB -> Socket.io를 사용하는 경우
        - 메시지 전송 및 저장
          - React 클라이언트가 메시지를 Express 서버로 보내고, Express 서버가 메시지를 MongoDB에 저장
        - 실시간 메시지 브로드캐스트
          - Express 서버는 메시지를 MongoDB에 저장한 후, Socket.io를 통해 모든 연결된 클라이언트에게 새 메시지를 실시간으로 전달
        - 메시지 표시
          - React 클라이언트는 Socket.io를 통해 서버에서 전송된 새 메시지를 즉시 수신하고 화면에 표시
      - 주요 차이점
        - 실시간 업데이트
          - Socket.io를 사용하면 서버에서 새 메시지가 발생했을 때, 이를 즉시 모든 연결된 클라이언트에게 전달할 수 있다.
          - 이는 주기적으로 HTTP 요청을 보내는 것보다 훨씬 빠르고 효율적
        - 서버 부하 감소
          - 클라이언트가 주기적으로 서버에 데이터를 요청하는 경우 서버에 부하가 가중될 수 있다.
          - Socket.io를 사용하면 데이터 변경이 있을 때만 클라이언트에 업데이트를 전달하기 때문에 서버 부하를 줄일 수 있다.
      - 예시 시나리오
        - HTTP 폴링 방식
          - 클라이언트가 5초마다 서버에 새로운 메시지가 있는지 확인하는 HTTP 요청을 보냄
          - 서버는 메시지를 조회하여 클라이언트에 응답
          - 이 방식은 서버와 클라이언트 간의 불필요한 트래픽이 발생하고, 새 메시지를 실시간으로 수신하지 못함
        - Socket.io 방식
          - 클라이언트가 메시지를 서버에 전송
          - 서버는 메시지를 저장하고, 즉시 Socket.io를 통해 새 메시지를 모든 클라이언트에게 브로드캐스트함
          - 클라이언트는 실시간으로 새 메시지를 수신하고 화면에 표시
      - Socket.io를 사용하면 클라이언트는 메시지를 실시간으로 수신할 수 있고, 주기적으로 서버에 데이터를 요청할 필요가 없어져 효율적인 데이터 전송이 가능
      - 추가로, 주기적인 요청이 불필요하기 때문에 서버에서 이벤트가 발생할 때마다 클라이언트에 데이터를 전송하고, 서버와 클라이언트 간의 양방향 통신을 통해 효율적으로 데이터를 주고 받음
    - Socket.io는 실시간 업데이트를 효율적으로 처리하고 서버 부하를 줄이기 위해 사용되기 때문에, 실시간 애플리케이션에서 데이터 전송을 최적화하고 UX를 향상시키기 위해 매우 유용한 도구이므로 Socket.io를 사용하는 것이 좋다고 생각 됨

  <br />

  - 채팅 내용은 어떤식으로 구성이 되어야 하는가?
    - 사용자-관리자 간의 채팅에서 로그인한 사용자의 채팅은 오른쪽에서 보여져야 함
      - 반대로 관리자가 로그인해서 채팅을 확인하면 관리자 채팅은 오른쪽에 보여져야 함
      - 즉, 본인이 작성한 채팅은 오른쪽에 보여지고 반대에 사용자 또는 관리자 채팅이 보여지게 구성해야 함
    - 관리자는 한명, 사용자는 여러명이지만 서로 구분이 필요
      - 사용자가 관리자와 개별적으로 채팅을 하고, 사용자 자신과 관리자 간의 독립된 채팅 세션이 필요
    - 사용자 채팅에서는 관리자와의 채팅 내용만 보여지면 되지만, 관리자는 어느 사용자와 채팅을 하고 있는지 구분이 필요함
      - 사용자가 개별적으로 독립된 채팅 세션의 방 번호를 가지고 있고, 관리자는 그 방 번호에 접속해서 채팅을 하는 방식으로 구현을 해야 할 것으로 예상
    - 관리자가 채팅 컨테이너를 열면 사용자를 선택해서 채팅을 할 수 있게 구성이 필요함
      - 관리자는 한명으로 여러 사용자와 개별적으로 채팅이 필요하기 때문에 관리자만 따로 사용자를 선택해서 채팅을 보낼 수 있는 공간이 필요
    - 구성 순서
      - 프론트엔드에서 백엔드로 사용자 메시지를 전달하는 API 엔드포인트가 필요
      - 들어오는 사용자 메시지를 저장할 MongoDB 컬렉션이 필요
        - 저장하는 DB 컬렉션에서, 사용자 개인별로 방 번호를 지정해서 저장해야 함
      - Socket.io에서 DB에 저장된 내용을 가져와서 프론트엔드와 실시간 통신을 해줘야 함
      - 사용자 개인별로 독립적인 채팅이 관리자에게 전달되는 것을 확인해야 함
      - 관리자 채팅에서 사용자를 선택할 수 있도록 구성 추가 필요

<br />

- 추가 및 해결 해야 할 내용
  - 커스텀 Hook에 대한 고려
    - Context API를 사용하는 것은 좋지만, 이 내용을 사용하려는 파일에서 하나하나 추가해서 사용하기 때문에 커스텀 Hook을 구성해서 재사용할 수 있도록 해줄 필요가 있음
  - 백엔드의 user-router.js에서 accessToken, login/success, profile router에서 모두 accessToken 함수 내용을 재사용하고 있는데, 굳이 3개의 router로 나눌 필요가 있는 지 확인해보고 필요가 없다면 하나로 줄여줘야 함
    - 명확하게 하기 위해서 일단은 하나로 합치지 않고, 그대로 나눠서 사용하도록 유지
    - 내용이 엄청 많은 코드로 구성된 것이 아니기 때문에 현재로서는 크게 문제 없다고 생각되어 그대로 유지
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함

# 오늘 느낀 점

- Socket.io가 정말로 필요한 내용인 지, 다시 한 번 확인해보고 있을 때와 없을 때의 차이점을 확인해보니, 필요하다는 생각이 들었으며 만약 없이 구현을 한다면 실시간으로 채팅 내용이 업데이트되도록 하는 부분에서 조금 어려움을 겪을 수도 있을 것 같다는 생각이 들었다. 물론 Socket.io 없이 구현을 하지 못한다고 생각은 되지 않지만, 그래도 Socket.io를 사용하면 좀 더 실시간 업데이트나 효율적으로 데이터 전달하는 부분에서 많이 도움이 될 것 같고, 이제까지 Socket.io 내용을 사용해보지 않았기 때문에 이번 기회에 Socket.io에 대해 조금씩 공부하면서 정보를 찾아보고 적용해보고 싶기 때문에, Socket.io를 함께 사용해서 채팅 기능을 구현해볼 생각이다. 우선 첫 번째로, React에서 입력한 내용이 백엔드로 전송되고 백엔드에서 해당 내용을 저장한 뒤에 Socket.io로 전달하는 부분을 구현해볼 생각이며, 추가로 이전에 찾아놓은 내용을 확인해서 어떤 방식으로 구현을 했는지 좀 살펴보고 참고해서 구현을 해봐야 할 것 같다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
