# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 그룹 채팅방 공지 관련 로직, Zustand 액션 추가 및 그룹 채팅방 공지 관련 백엔드 라우터 추가
  - 그룹 채팅방 공지 내용을 입력할 수 있도록 내용을 구성하고, 여러 useState와 입력 함수, 제출 함수를 추가해 입력한 내용을 Zustand 액션으로 전달하고, 백엔드에 그룹 채팅방 공지 관련 업데이트 라우터를 추가해 프론트엔드 Zustand 액션에서 전달한 그룹 채팅방 공지 내용을 저장할 수 있도록 구성
  - 백엔드
    - group-chat-routes
      - JWT 토큰을 통해 사용자 정보를 불러오도록 구성
        - if문을 통해 사용자 정보가 유효한지 확인
      - 프론트엔드에서 전달한 그룹 채팅방 공지 내용, 사용자 정보, 그룹 채팅방 ID 등 내용을 사용할 수 있도록 구성
      - 그룹 채팅방을 찾는 내용 추가
        - 프론트엔드에서 전달한 그룹 채팅방 ID와 그룹 채팅방 컬렉션에 저장된 그룹 채팅방 목록 ID를 비교해 일치하는 그룹 채팅방을 찾도록 구성
        - if문을 통해 그룹 채팅방이 존재하는지 확인
      - 찾은 그룹 채팅방에 저장된 호스트 이메일과 JWT 토큰에 저장된 이메일이 일치하는지 확인하는 조건부 추가
        - 일치하지 않으면 수정 권한이 없다는 경고를 띄우도록 구성
      - editGroupChatAnnouncement 객체 추가
        - 프론트엔드에서 넘어온 그룹 채팅방 공지 내용을 announcement 키에 저장하도록 구성
      - 그룹 채팅방을 업데이트하는 내용 추가
        - 프론트엔드에서 넘어온 그룹 채팅방 ID와 그룹 채팅방 컬렉션에 저장된 그룹 채팅방 목록 ID를 비교해 일치하는 그룹 채팅방을 찾고, $set을 통해 announcement 항목이 업데이트되도록 구성
        - announcement 항목이 없다면 새롭게 추가되고, 기존에 있다면 업데이트
      - 프론트엔드에 editGroupChatAnnouncement 객체 내용을 전달해 사용할 수 있도록 구성
  - 프론트엔드
    - groupChatStore
      - groupChatAnnouncementForm 액션 타입 정의 추가
        - trimmedAnnouncement 항목을 추가하고 string으로 정의
        - userInfo 항목을 추가하고 UserInfo로 정의
        - modalData 항목을 추가하고, 그 안에 method, groupChatId, announcement으로 구성
          - method는 POST 또는 PATCH가 사용되도록 구성
          - groupChatId와 announcement는 string으로 정의하고 옵셔널 타입으로 구성
      - groupChatAnnouncementForm 액션 추가
        - 매개변수로 trimmedAnnouncement, userInfo, modalData를 받도록 구성
        - 사용자 정보 내용이 requestBody에 포함되도록 객체 디스트럭처링으로 구성
        - requestbody 객체 추가
          - 사용자 정보 내용인 \_id, email, username, nickname, avatarColor
          - 매개변수로 전달받은 trimmedAnnouncement와 modalData로 구성
        - fetch 함수 추가
          - "/groupChatAnnouncementForm" 경로로 구성
          - method는 modalData.method로 구성
          - body를 통해 requestBody 내용이 전달되도록 구성
        - 그룹 채팅방 공지 수정에 실패하면 에러 메시지가 뜨도록 조건부 추가
        - 올바른 공지 수정 시 콘솔에 내용을 띄우도록 구성 추가
        - 에러 발생 시에 alert를 통해 에러 메시지를 띄우도록 구성
    - GroupChatDetails
      - JSX 코드 내용 수정
        - GroupChatPanel 컴포넌트에 groupChatId, announcement props를 추가해 그룹 채팅방 ID와 그룹 채팅방 공지 내용이 전달되도록 수정
    - GroupChatPanel
      - props로 넘어오는 groupChatId를 사용할 수 있도록 구성
      - groupChatAnnouncementEditHandler 함수 수정
        - toggleModal 액션에 전달하는 data 내용을 수정
        - data 내용에 \_id 대신, groupChatId와 announcement를 추가해 그룹 채팅방 ID와 공지 내용이 전달되도록 구성
    - GroupChatAnnouncementForm
      - useAuthStore, useModalStore, useGroupChatStore Zustand에서 각각 userInfo 상태, modalData 상태, groupChatAnnouncementForm 액션을 불러와 사용할 수 있도록 구성
      - announcement useState 추가
        - 초기값은 modalData에 저장된 공지 내용 또는 빈 문자열이 들어가도록 구성
      - errorMessage useState 추가
        - 초기값은 빈 문자열로 구성
      - trimmedAnnouncement 변수 추가
        - announcement useState 내용 공백을 제거하도록 구성
      - announcementValid 변수 추가
        - trimmedAnnouncement 변수 길이 내용이 2이상일 경우 true가 되도록 구성
        - 현재는 주석 처리한 상태
      - inputChangeHandler
        - event 내용에 대한 타입 정의를 `React.ChangeEvent<HTMLInputElement>`로 구성
        - value 변수 추가
          - input에서 입력한 내용을 감지하기 위해 추가
        - if문을 추가해 공백을 제거한 value 변수 길이가 30자 이상일 경우를 확인
          - true일 경우, setErrorMessage를 통해 30자 이하로 입력하라는 메시지가 전달되도록 구성
          - false일 경우, setErrorMessage를 통해 빈 문자열이 전달되도록 구성
      - submitHandler
        - event 내용에 대한 타입 정의를 `React.FormEvent<HTMLFormElement>`로 구성
        - 기본적인 이벤트 방지 추가
        - 로그인이 되어있는지 확인하는 if문 추가
          - userInfo를 확인해, 로그인 상태가 아니면 즉시 종료
        - try-catch문 추가
          - groupChatAnnouncementForm 액션에 trimmedAnnouncement 변수, userInfo 상태, modalData 상태 내용을 전달하도록 구성
          - 정상적으로 내용이 전달되면 콘솔에 성공 메시지를 띄우도록 구성
          - 정상적으로 내용이 전달되지 못할 경우, alert를 통해 에러 메시지를 띄우도록 구성
      - JSX 코드 내용
        - form 관련 내용
          - onSubmit을 추가하고 submitHandler 함수로 구성
        - input 관련 내용
          - type은 text로 구성
          - id, name은 "announcement"로 구성
          - value는 announcement useState 내용으로 구성
          - maxLength는 30으로 설정해 30자를 초과하지 않도록 구성
          - placeholder를 추가해 "내용 입력"이 보여지도록 구성
          - onChange를 추가하고 inputChangeHandler 함수로 구성
        - 에러 메시지가 보여지도록 div를 추가하고 errorMessage useState로 구성
        - 수정 버튼을 추가해 type을 sumbit으로 구성
    - types
      - GroupChatData 타입 정의 수정
        - announcement 항목을 옵셔널 타입으로 추가하고 string으로 구성
      - GroupChatPanelProps 타입 정의 수정
        - announcement 항목을 옵셔널 타입으로 추가하고 string으로 구성
  - 그룹 채팅방 공지 모달을 통해 내용을 입력할 수 있도록 구성 및 입력한 내용과 사용자 정보 등 여러 내용이 함께 Zustand 액션을 통해 백엔드에 전달되도록 구성해주었고, 백엔드에 그룹 채팅방 공지 관련 업데이트 라우터를 추가해 확인한 결과, 공지 모달을 통해 입력한 내용과 사용자 정보 내용이 Zustand 액션을 걸쳐 백엔드에 전달되고 데이터를 확인한 뒤 DB에 저장되는 것을 확인할 수 있었다.
    - 공지 관련 데이터가 저장되는 것은 확인했기 때문에, 해당 내용을 불러와 출력할 수 있도록 구성 필요
    - 공지 폼 컴포넌트를 추가로 수정해 더 자연스러운 UI와 입력창을 깔끔하게 보여주도록 구성 필요
    - 참여자 역할을 구분하는 내용(방장, 일반, 초대 대기중 등) 등 여러 내용을 생각중
    - 정리해야 할 내용은 정리하고 채팅 목록과 관련된 스크롤 관련 기능을 수정해봐야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/5c32d86f2b7e545f6cb79850b4bb646cbedbc7a4)

# 오늘 느낀 점

- 그룹 채팅방 공지 컴포넌트에 여러 useState와 입력하는 함수, 제출하는 함수 내용을 추가해 공지 모달에서 입력한 내용이 Zustand 액션으로 전달되도록 구성하고, 백엔드에 그룹 채팅방 공지 관련 업데이트 라우터를 추가해 Zustand 액션과 연결, 그리고 공지 관련 데이터를 전달받아 해당 데이터를 검사한 뒤 DB에 저장되도록 구성했는데, 저장은 문제없이 되고 있지만 현재 출력하는 로직이 구성되지 않은 상태라서 출력과 관련된 로직을 추가해 화면에 띄우는 것까지 추가로 구성을 해볼 생각이다. 그리고 공지 모달이나 공지 내용 불러와 출력하는 공간, 공지 버튼 등 여러 CSS 내용이 추가되지 않아서 현재 기본 UI로 보여지고 있기 때문에 CSS 내용을 추가해줘야 하고, 패널 내의 사용자 목록에서 호스트와 일반 사용자를 구분하지 못하고 있기 때문에 아이콘이나 뱃지 같은 걸 추가해 구분할 수 있도록 해줄 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 닉네임 수정과 그룹 채팅방 제목 수정 내용에서 사용하지 않거나 필요없는 정보를 삭제해 코드 정리를 해야 함 (중복된 데이터 전송이나 사용하지 않는 데이터 전송 관련 내용 등)

- 그룹 채팅방에서 다른 사용자를 클릭할 수 있고, 클릭 시에 다이렉트 채팅방이 생성되어 채팅을 나눌 수 있도록 구성하는 것을 고려중 (이 방법 대신, 다른 사용자 클릭 시에 프로필이 보여지도록 구성하고 그 내용을 통해 다이렉트 메시지를 보내거나 프로필 내용을 보는 그런 방식으로 구성해야 함)

- 출력되는 채팅 메시지 목록에 스크롤 관련 내용을 추가 수정해야 함

- 채팅 입력창에 적용된 스크롤 기능 추가 수정 필요

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
