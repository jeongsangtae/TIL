# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 관리자 계정으로 사용자 페이지에서 게시글, 댓글, 답글 추가하는 기능 막기
    - 관리자 계정으로 사용자 페이지에 접속한 후에 게시글, 댓글, 답글 추가 기능을 사용할 수 있기 때문에 이 추가 기능을 막아주기 위해서 내용을 수정해주었다.
    - 프론트엔드
      - Posts
        - 글쓰기 버튼이 비활성화될 수 있도록 버튼 클래스에서 로그인 유무 대신에, 사용자 역할을 확인하도록 수정
        - 비로그인과 마찬가지로 관리자 계정도 글쓰기 버튼이 비활성화 되도록 구성
      - Comment
        - 답글쓰기 버튼이 로그인 유무에 따라서 나타나도록 되어있지만, 조건부를 수정해서 사용자 역할에 따라서 나타나도록 변경
        - 글쓰기 버튼과 마찬가지로, 관리자 계정에서도 답글쓰기 버튼이 보이지않도록 구성
      - CreateComment
        - 댓글 추가 버튼이 비활성화될 수 있도록 버튼 클래스에서 로그인 유무 대신에 사용자 역할을 확인하도록 수정
        - 댓글 입력하는 textarea에서 로그인 유무 대신에 사용자 역할을 확인하도록 수정해주고, placeholder 내용에서도 사용자 역할에 따라서 다른 내용이 보여지도록 구성
        - 댓글과 관련된 내용에서, 로그인 유무 대신에 사용자 역할을 확인하도록 변경해서, 비로그인과 관리자 계정 모두 사용할 수 없도록 비활성화 되도록 구성
    - 수정한 내용을 확인해보면, 관리자 계정이 비로그인 상태와 마찬가지로 글쓰기, 댓글, 답글 추가하는 기능이 모두 비활성화된 것을 확인할 수 있었다.
    - 비로그인 상태에서 콘솔을 조작하고 사용하면 에러가 발생하지만, 관리자 계정으로 콘솔을 조작하고 사용하면 에러가 발생하지 않기 때문에 이에 대한 추가 처리가 필요
    - 아직 1차적인 방어만 되기 때문에, 콘솔 조작으로 사용하지 못하도록 2차 방어를 해줘야 함
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/ef1100c87a3eba616fb3e1478013834cf4fbe731)

  <br />

  - 관리자 계정으로 게시글, 댓글 추가 시에 에러 메시지 출력
    - 관리자 계정으로 로그인하면 게시글 추가와 댓글 추가 버튼이 비활성화되어서 사용할 수 없지만, 콘솔에서 강제로 CSS를 조작해서 풀면 사용이 가능해지기 때문에 이 부분에 대해 추가 에러 처리를 해주기 위해서 내용을 수정해주었다.
    - 프론트엔드
      - CreateComment
        - 콘솔에서 CSS 조작으로 비활성화된 내용을 풀고 댓글을 작성한 후에 전송하면, 사용자 역할을 확인해서 요청을 중단하고 오류 메시지가 전달되도록 수정
      - Authentication
        - 인증과 관련된 조건문을 수정해서 로그인 유무가 아닌, 사용자 역할을 확인하도록 수정
        - 사용자 역할을 확인해서 사용자 계정인 경우, 기존의 로직이 그대로 작동하고 비로그인이나 관리자 계정의 경우에는 오류 페이지로 이동해서 에러 메시지가 보여지도록 구성
        - 메시지 출력 부분에서 사용자 역할을 확인하도록 조건부를 추가해서, 비로그인 상태일 때는 로그인 관련 메시지를 보여주고, 관리자 계정일 경우에는 관리자는 사용할 수 없다는 메시지가 보여지도록 구성
    - 답글과 관련된 내용을 수정하지 않은 이유는 답글쓰기 버튼은 조건부로 인해, 화면에서 보이지 않기 때문에 사용할 수가 없으므로 따로 내용을 수정하지 않음
    - 비로그인 상태에서 강제로 CSS 내용을 삭제하고 댓글을 추가하면, alert 내용과 함께 콘솔에 에러가 뜨도록 구성했었는데, 마찬가지로 관리자 계정 또한 강제로 CSS 내용을 삭제하고 댓글을 추가하면 alert 내용과 함께 콘솔에 에러가 뜨는 것을 확인
      - 당연하게도 댓글 추가가 되지 않고, 관리자 계정의 경우 다른 메시지가 출력되는 것을 확인
    - 게시글 추가도 동일하게 관리자 계정으로 강제로 CSS 내용을 삭제하고 동작하면 에러 페이지로 유도하고 메시지가 출력되는 것을 확인
      - 비로그인과 똑같이 작동은 하고, 단지 출력되는 메시지가 비로그인과 관리자 계정에 따라서 다르게 출력되도록 구성
      - 전달되는 메시지가 명확하게 알 수 있도록 구성
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/00bcb346bb0ab451dba961d0a9276649b25b4b83)

<br />

- 추가 및 해결 해야 할 내용
  - 마지막 기능 추가로, 관리자 권한을 부여하는 내용을 생각하고 있음
    - 가입할 때는 일반 사용자로 가입을 할 수 있고, admin 관리자 계정으로 관리자 페이지에서 관리자 권한을 부여하는 내용을 생각 중
  - 새롭게 발견한 문제
    - 관리자 채팅의 사용자 리스트에서 사용자와 나눈 마지막 메시지 내용을 가져오는데, 이 때 새로고침을 하지 않으면 당장 채팅을 나눠도 실시간으로 마지막 메시지가 갱신되지 않아서 새로운 메시지가 있는 지 확인할 수 없기 때문에 추가하는 것도 고려해야 함
    - 한편으로는, 관리자 채팅이라서 사용자가 겪는 불편함이 아니기 때문에 그냥 놔두는 것도 고려 중
  - 배포하는 과정에서 오류가 생겼던 부분과 해결한 오류에 관한 내용을 정리해줘야 함
    - CORS 오류, Rewrite 관련 내용 등
    - 로컬 스토리지 초기화 오류 해결한 방법에 대한 정리가 필요
  - 설계, 결과 이 부분에 대한 내용을 정리해줘야 하고, 발생했던 에러에 대해 최대한 정리해주는 것도 필요함
    - 파일은 구성해놓은 상태이기 때문에 내용 정리만 차분히하면 됨
    - 설계는 완료
    - 결과 진행중
      - 백엔드, DB 완료
      - 프론트엔드 마무리해줘야 함

# 오늘 느낀 점

- 관리자 계정으로 로그인하고 URL을 통해서 사용자 페이지로 이동해서 게시글, 댓글, 답글을 추가할 수 있었는데, 이 내용을 수정해서 비로그인 상태와 동일하게 비활성화 해주었다. 하지만 이 방법은 1차적인 방어일뿐 콘솔에서 내용을 수정하면 여전히 게시글, 댓글을 추가할 수 있기 때문에, 2차 방어로는 비로그인과 동일하게 관리자 계정인 상태에서 강제로 게시글, 댓글을 추가한다면 에러 메시지를 전달하거나 에러 페이지로 이동되도록 내용을 구성해주었다. URL을 통해서 사용자 페이지의 게시글 추가 페이지나 게시글 수정 페이지에 접근하면 관리자 계정도 막히면서 사용할 수 없는 것을 확인할 수 있었다. 답글에서는 사실상 비활성화보다 조건부로 답글쓰기 버튼이 보여지지 않기 때문에 콘솔에서 조작도 불가능하므로, 따로 에러 메시지와 관련된 내용을 추가해주지 않았다. 이제 확인하면서 발생한 오류를 모두 수정했기 때문에 결과 내용을 마무리 지을 수 있을 것 같고, 빠르게 정리한 뒤에 에러 관련 내용도 정리해줄 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
