# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 게시글 제목, 내용 출력과 관련된 로직 수정 및 관리자 페이지 게시글 제목, 내용 로직 추가 및 관리자 페이지의 게시글 세부 내용 CSS 추가
    - 게시글 제목 내용이 너무 길게 작성되었을 경우, 미리보기 형식으로 조금만 보여주고 그 뒤는 ...으로 보여지는데 이 때, 구성된 로직이 중복으로 사용되는 부분을 조건부 내용을 추가해서 하나로 재사용되도록 변경해주고, 불필요하게 중복되는 내용을 제거해주었다. 그리고 관리자 페이지의 게시글 목록에서도 똑같이 적용되도록 구성
    - 프론트엔드
      - Post
        - 게시글 내용에서 미리 보여주는 줄 수 내용 변수 삭제
        - 미리보기에서 보여줄 게시글 제목 글자 수를 수정
          - 데스크탑 환경과 모바일 환경을 분리해서 구성했으나, 하나로 합치고 조건부로 구성
          - 데스크탑 환경에서는 30글자
          - 모바일 환경에서는 10글
        - 제목과 관련된 내용에서 줄바꿈과 줄 길이를 제한하고 보여주는 내용을 줄이기 위해서 전체적으로 수정
          - 데스크탑 환경과 모바일 환경 내용을 따로 분리해서 구성했었으나, 내용을 수정해서 하나로 재사용될 수 있도록 구성
          - titleLines 변수와 truncatedTitle, moreTitleLines 변수 모두 삭제하고 previewTitle 변수 하나로 통합
          - previewTitle 변수에서 split, slice, map, ... 내용, join 내용을 모두 처리하도록 구성
          - 불필요하게 여러 변수에 걸쳐서 작동하지 않고 previewTitle 변수로 모두 처리되도록 구성
        - 주석 처리했던 내용과 관련된 변수 내용 삭제
        - JSX 코드에서 보여지는 제목 내용이 데스크탑 환경인 지 확인하고 조건부로 다른 변수가 적용되도록 구성했지만, 해당 내용을 수정해서 previewTitle 변수만 사용되도록 수정
          - 이전의 내용에서 사용하던 여러 변수를 삭제하고, ... 내용도 중복으로 사용되기 때문에 모두 삭제하고 previewTitle 변수만 사용되도록 구성
          - 불필요하게 구성되어 ... 내용이 중복으로 사용되기 때문에 내용 수정
        - 게시글 내용을 미리보기 내용으로 정리해주는 함수 이름 변경
          - truncateContentWithNewline 함수 이름을 trimContentHandler로 변경
      - AdminPost
        - Post 컴포넌트 내용과 마찬가지로 게시글 제목, 내용이 미리보기 로직 구성
    - CSS
      - PostDetails
        - 주석 처리했던 코드 삭제
      - AdminPostDetails
        - PostDetails 내용에 추가한 것과 마찬가지로 title span 내용에 min-width, text-align 내용 추가
        - 모바일 환경에서는 min-width 내용이 조금 다르게 적용되도록 구성
    - forEach로 구성된 trimContentHandler 함수 내용 설명
      - 매개변수로 content, maxContentLength, lineBreakCharacterLength를 전달받도록 구성
      - 현재까지 계산된 문자열의 총 길이, 잘린 문자열을 저장할 변수 구성
      - split과 forEach를 통해서 문자열 순회 및 처리
        - 문자열을 한 문자씩 쪼개 배열로 만든 후, forEach를 사용해 각 문자를 순회함
      - if문으로 문자가 줄바꿈 문자인지 확인하고, 줄바꿈이면 지정한 글자 수만큼 현재 길이를 증가
        - 줄바꿈 문자가 아닌 일반 문자는 현재 길이에 +1되도록 구성
      - if문으로 현재 길이가 최대 길이를 초과하지 않는 경우에만, 현재 문자를 잘린 문자열 변수에 저장
      - if문으로 현재 길이가 최대 길이를 초과하면, 잘린 문자열에 ...을 추가하여 내용이 생략되었음을 알려주도록 구성
      - 최종적으로 잘린 문자열을 반환하도록 구성
    - 게시글 내용 코드가 문제없이 작동되지만, 함수 이름이 가독성이 좋지 않은 것 같아서 수정해주었는데 괜찮은 것 같고, 게시글 제목 미리보기 관련 로직을 수정해서 좀 더 간결하게 수정해주었는데, 문제없이 작동되는 것을 확인했다.
    - 게시글 제목 미리보기 로직에서 중복되는 코드가 많아서 조건부로 수정하고 중복되는 내용을 삭제해주었는데, 이전보다 훨씬 깔끔해지고 가독성도 좋아진 것 같다고 생각이 된다.
    - 주석 처리된 코드도 삭제해주면서 더 깔끔해졌고, 관리자 페이지의 게시글 목록에서도 관련 내용을 추가해주고 확인해본 결과, 동일하게 작동되는 것을 확인할 수 있었다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/dfdc359ac2ddfedcad38120cc425b189bbb602e5)

  <br />

  - 게시글 내용 다듬는 함수 수정 (관리자 페이지의 내용 포함)
    - 기존에 구성된 trimContentHandler 함수 내용을 좀 더 간결하고 함수형 프로그래밍 스타일로 변경해주기 위해서 코드를 수정해주었다.
    - 프론트엔드
      - Post, AdminPost
        - 게시글 내용 미리보기 관련 함수의 내용을 수정
          - forEach로 처리되는 내용을 reduce를 사용해서 처리되도록 수정
          - 관리자 페이지의 게시글 목록에서도 똑같이 적용되도록 변경
        - reduce를 사용해서 현재 길이와 잘린 문자열을 관리하고 결과값을 반환해서 미리보기 내용을 만들어주고 잘린 내용은 ...으로 보이도록 구성
          - reduce
            - 상태(현재 길이와 잘린 문자열)를 축적하면서 로직을 적용
          - 불변성
            - reduce 내에서 acc를 수정하지 않고 새로운 객체를 반환하여 불변성을 유지
          - 조건에 맞춰 동일하게 문자열을 자르고, 최대 길이를 초과하면 ...을 추가함
        - reduce의 누적 값을 이용해 현재 상태를 축적하는 함수형 프로그래밍 방식으로 변경
          - 코드 설명은 아래에서 계속
    - reduce로 구성된 trimContentHandler 함수 내용 설명
      - 동일하게 매개변수를 전달 받도록 구성
      - split을 통해서 문자열을 한 글자씩 배열로 쪼개도록 구성
        - 각 문자는 배열의 개별 요소가 됨
      - reduce를 통해서 배열의 각 문자에 대해 축약 작업을 진행
        - reduce는 배열을 반복하며, 누적 값 acc를 이용해 특정 로직을 처리
        - 첫 번째 인수는 축약 함수 `(acc, char) => {...}`이고, 두 번째 인수는 초기값 `{currentLength: 0, truncatedContent: ""}`
          - 현재 길이와 잘린 문자열
      - 축약 함수 내부 로직
        - acc 에서 현재 길이와 잘린 문자열을 구조 분해 할당으로 꺼냄
        - 현재 길이는 현재까지 자른 문자열의 길이, 잘린 문자열은 현재까지 자른 문자열
      - 각 문자의 길이를 계산
        - 문자가 줄바꿈 문자면, 줄바꿈에 지정한 글자 수만큼 길이를 더해줌
        - 줄바꿈 문자가 아니라면, 한 글자로 취급해 길이를 1만큼 더해줌
      - 문자열 잘라내는 로직
        - 현재 길이와 추가 길이를 더한 길이가 최대 길이를 넘지 않는 경우에만 문자를 추가
        - 현재 길이 + 추가 길이를 더한 값이 최대 길이 이하일 때, 문자를 더할 수 있음
        - 해당 조건을 만족하면, 현재 길이에 새로운 길이를 더하고, 잘린 문자열을 현재 문자에 추가
      - 최대 길이를 초과하는 경우
        - 새로운 길이가 최대 길이를 초과하면, 더 이상 문자를 추가하지 않고 그대로 리턴
        - 리턴 시에 현재 상태를 그대로 반환
        - 더 이상 새로운 문자를 추가하지 않고 반복을 종료하게 됨
      - 최종 결과 반환
        - 최종적으로 reduce의 결과로 잘린 문자열을 반환
        - 원본 게시글 내용의 길이가 최대 길이를 초과하면 ...을 추가하여 반환
      - 한 글자씩 순차적으로 문자열을 자르면서 줄바꿈이나 일반 문자에 따라 길이를 계산하고, 최대 길이를 초과하면 잘린 문자열에 ...을 붙여서 반환하게 됨
    - forEach를 사용한 로직에서 reduce를 사용하는 로직으로 변경하고 테스트해본 결과, 이전과 동일하게 작동하는 것을 확인
      - reduce를 사용하는 코드가 누적 값을 이용하기 때문에 함수적인 코드 구조를 제공하고, 누적된 값을 반환하는 형태이므로 코드가 좀 더 함수형이고 간결하게 보일 수 있음
      - forEach는 순수 반복문 기반이지만, reduce는 함수형 프로그래밍 스타일로 관리됨
      - reduce는 함수형 스타일로 코드를 간결하게 만들고, react나 함수형 프로그래밍에서 많이 사용됨
      - 코드는 간결한 것 같긴 하지만 reduce로 구성한 로직이 조금 더 복잡하게 느껴질 수 있음
        - 이와 관련된 내용은 따로 정리를 해야 할 것 같음
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/8948f9e9dabab8bfa9f029b6ecb179286a027865)

<br />

- 추가 및 해결 해야 할 내용
  - 마지막 기능 추가로, 관리자 권한을 부여하는 내용을 생각하고 있음
    - 가입할 때는 일반 사용자로 가입을 할 수 있고, admin 관리자 계정으로 관리자 페이지에서 관리자 권한을 부여하는 내용을 생각 중
  - 새롭게 발견한 문제
    - 관리자 채팅의 사용자 리스트에서 사용자와 나눈 마지막 메시지 내용을 가져오는데, 이 때 새로고침을 하지 않으면 당장 채팅을 나눠도 실시간으로 마지막 메시지가 갱신되지 않아서 새로운 메시지가 있는 지 확인할 수 없기 때문에 추가하는 것도 고려해야 함
    - 한편으로는, 관리자 채팅이라서 사용자가 겪는 불편함이 아니기 때문에 그냥 놔두는 것도 고려 중
  - 배포하는 과정에서 오류가 생겼던 부분과 해결한 오류에 관한 내용을 정리해줘야 함
    - CORS 오류, Rewrite 관련 내용 등
    - 로컬 스토리지 초기화 오류 해결한 방법에 대한 정리가 필요
  - 설계, 결과 이 부분에 대한 내용을 정리해줘야 하고, 발생했던 에러에 대해 최대한 정리해주는 것도 필요함
    - 파일은 구성해놓은 상태이기 때문에 내용 정리만 차분히하면 됨
    - 설계는 완료
    - 결과 진행중

# 오늘 느낀 점

- 게시글 제목 미리보기 로직과 관련해서 데스크탑, 모바일 환경에 따라서 다른 변수가 적용되도록 분리해서 구성을 했으나, 굳이 변수를 나누지 않고 하나로 재사용되어 처리해도록 내용을 수정해주었다. 변수를 나누는 것 대신에 조건부로 적용되어서 하나의 변수로 재사용되도록 내용을 구성해주고, 여러 변수로 나눠서 처리하던 내용을 하나의 변수로 사용하게 되면서 훨씬 간결해지고 가독성이 좋아진 것 같다. 게시글 내용 미리보기 로직은 forEach를 사용해서 구성했었는데, forEach는 순수 반복문 기반이기 때문에 React에서 사용하기에 적합한 가에 대한 의문이 생겨서, 다른 내용을 찾아보다가 함수형 프로그래밍 스타일에 맞는 reduce를 사용하면 동일한 동작 구성이 가능하다는 것을 알게되어 reduce로 게시글 내용이 처리되도록 수정을 해주었다. 코드는 이전보다 간결해졌지만, 조금 복잡하다고 생각이 되고, forEach를 사용할 때보다 함수형 프로그래밍 스타일에 맞게 로직이 구성된 것 같아서 만족스럽고, reduce를 사용한 로직이 왜 복잡하게 느껴지는 지에 대한 내용을 조금 정리하고 갈 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
