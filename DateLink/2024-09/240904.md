# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 메인헤더 컴포넌트 조건부, CSS 미디어 쿼리 수정 및 드롭다운 메뉴 컴포넌트, CSS 사용하지 않는 코드 삭제
    - 메인헤더 컴포넌트에서 드롭다운 메뉴와 채팅 컴포넌트에 구성된 조건부 내용을 수정해주고, 해상도에 따른 미디어 쿼리 내용을 추가해주었으며, 드롭다운 메뉴 컴포넌트와 CSS에서 사용하지 않는 코드를 삭제해주었다.
    - 프론트엔드 구성
      - MainHeader
        - 로그인 유무를 확인해서 드롭다운 메뉴가 다르게 출력되고, 로그인한 사용자의 역할에 따라서 채팅 버튼이 보이거나 안보이도록 구성했던 조건부 로직을 수정
        - 로그인 상태를 확인하는 조건부를 드롭다운 메뉴 컴포넌트에 전달하는 토글 관련 내용에 직접 사용해서 비로그인 상태에서는 토글 함수를 전달하고, 로그인 상태일 때는 undefined를 전달하도록 구성
        - 채팅 버튼은 별도의 조건부 내용으로 빼내서, 로그인 유무와 사용자 역할을 확인해서 모두 일치할 때 채팅 컴포넌트가 보여지도록 구성
        - 조건부 로직을 변경한 이유는, 모바일 환경에서 채팅 버튼이 메인헤더 메뉴 내용에 포함되어서 위쪽에 위치하기 때문에, 채팅 버튼이 오른쪽 하단에 위치하도록 기존의 조건부 로직에서 드롭다운 메뉴 컴포넌트를 분리하고, 조건부 내용이 적용되어 보여지도록 구성해주었다.
      - DropDownMenu
        - 사용자 아이콘 뒤에 구성된 원이 모바일 환경에서 다른 className이 적용되도록 구성했으나, 더 이상 사용하지 않기 때문에 삭제
    - CSS 구성
      - MainHeader
        - ham-burger
          - position에 absolute를 추가
          - right: 2rem을 추가해서 오른쪽 벽과 조금만 떨어지도록 구성
        - 중간 해상도 미디어 쿼리
          - 로고의 폰트 사이즈를 1.25rem으로 구성
          - 로고에 margin-left를 2rem으로 구성해서 왼쪽 벽과 조금만 떨어지도록 구성
        - 작은 해상도 미디어 쿼리
          - 로고의 폰트 사이즈를 1.1rem으로 구성
          - 로고에 margin-left를 3rem으로 구성해서 조금 더 떨어지도록 구성
          - 햄버거 버튼의 font-size와 right를 추가해서, 크기가 조금 줄어들고 오른쪽 벽과 좀 더 떨어지도록 구성
        - 매우 작은 해상도 미디어 쿼리
          - 로고의 font-size와 margin-left 수치를 조금씩 더 줄여서 더 작은 크기로 보여지도록 해주고, 왼쪽 벽과 조금 떨어지도록 구성
          - 햄버거 버튼의 font-size와 right 값을 줄여서 크기를 더 줄이고 오른쪽 벽과 떨어지도록 구성
      - DropDownMenu
        - mobile-dropdown-content
          - 이전에 테스트를 위해 사용하던 코드 삭제
        - 테스트를 위해서 드롭다운 아이콘 관련 미디어 쿼리 내용 추가
    - 메인헤더 컴포넌트에서 수정한 조건부가 정상적으로 적용되어서 모바일 환경에서 로그인 유무에 따라서 드롭다운 메뉴가 다르게 보여지는 것을 확인했고, 채팅 버튼이 메인헤더 메뉴에 속한 것이 아닌, 오른쪽 하단에 위치해서 보여지는 것을 확인할 수 있었으며, 해상도에 따라서 로고 크기와 위치 그리고 햄버거 버튼의 크기와 위치가 달라지며 적절하게 배치되는 것을 확인할 수 있었다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/5c4a7737906ce70a2988f57e263da5042a9b2175)

  <br />

  - 오버레이 내용 추가 및 사용
    - 모바일 환경에서 메인헤더 메뉴와 드롭다운 메뉴가 열린 후에 해당 버튼을 다시 클릭해야 닫을 수 있는데, 이 불편함을 해결하기 위해서 배경 클릭 시 닫히도록 내용을 구성하려고 했으나, 메인헤더 메뉴와 드롭다운 메뉴는 별도의 배경이 없어서 닫는 동작을 구현 하기에 어려움이 있기 때문에, 오버레이 컴포넌트를 추가하고 portal을 사용해서 메인헤더 메뉴와 드롭다운 메뉴에 배경을 만들어주고 클릭했을 때 해당 메뉴들이 닫히도록 구성해주었다.
    - 프론트엔드 구성
      - Overlay
        - ReactDOM을 import
        - portal을 사용할 수 있도록, document.getElementById로 "overlays"라는 id를 찾아오도록 구성
          - portalElement 변수로 구성
        - Overlay 컴포넌트에 ReactDOM.createPortal을 추가하고, 그 안에 div를 구성
          - div에서 className은 메인헤더 메뉴와 드롭다운 메뉴 컴포넌트에서 전달되는 className 이름이 들어감
          - onClick을 통해서 메인헤더 메뉴와 드롭다운 메뉴를 닫을 수 있도록 구성
          - children을 사용해서 래퍼 형식으로 사용될 수 있도록 구성
        - div뒤에 ","를 사용하고 앞에서 구성한 portalElement 변수를 추가
      - index.html
        - overlays라는 id를 가진 div를 body안에 추가
        - 위 내용을 추가해서 Overlay 컴포넌트에서 portal을 사용할 수 있게 됨
      - MainHeader
        - Overlay 컴포넌트 추가
        - Overlay 컴포넌트 닫는 함수 추가
          - 이 함수는 클릭 시 무조건 닫기만 되도록, useState 값이 false가 되도록 구성
        - 햄버거 버튼 클릭 시 보여지는 항목에 조건부를 추가해서 메인헤더 메뉴가 열린 지 확인하고, 열려 있다면 Overlay 컴포넌트에 닫는 함수와 className이 props로 전달되도록 구성
      - DropDownMenu
        - Overlay 컴포넌트 추가
        - Overlay 컴포넌트 닫는 함수 추가
          - 함수 클릭 시 무조건 닫기만 작동되도록, useState 값이 false가 되도록 구성
        - 드롭다운 메뉴 클릭 시 보여지는 내용에 조건부를 추가해서 드롭다운 메뉴가 열린 지 확인하고, 열려 있다면 Overlay 컴포넌트에 닫는 함수와 className이 props로 전달되도록 구성
    - CSS 구성
      - Overlay
        - 메인헤더 메뉴 오버레이와 드롭다운 메뉴 오버레이는 똑같은 구조로 배경색의 투명도만 차이를 줘서 구성
          - 투명도 차이를 줘서 구성한 이유는, 같은 투명도면 2개의 오버레이가 겹쳐서 너무 어둡게 보이기 때문에 처음 열린 메인헤더 메뉴는 조금 진하게 주고, 그 다음 열리는 드롭다운 메뉴는 옅게 구성
        - position, top, left, width, height 등으로 구성
        - z-index는 롭다운 메뉴가 더 위에 오도록 메인헤더 메뉴가 1, 드롭다운 메뉴가 2로 구성
    - 오버레이 컴포넌트를 추가해서 구성해준 후에, 배경이 존재하지 않는 메인헤더 메뉴와 드롭다운 메뉴에 오버레이 컴포넌트를 사용해서 배경을 만들어주고, 해당 메뉴 외부인 배경 클릭 시 메뉴들이 닫히는 내용이 문제없이 작동되는 것을 확인할 수 있었다.
      - 현재 2개의 메뉴를 모두 열어놓는 상황에서 오버레이가 겹치기 때문에, 메인헤더 메뉴가 열린 후에 드롭다운 메뉴가 열린다면 메인헤더 메뉴의 오버레이는 잠시 닫히고 드롭다운 메뉴 오버레이가 열린 상태가 지속되며, 드롭다운 메뉴가 닫힌다면 다시 메인헤더 메뉴의 오버레이가 열려서 유지되는 방식을 조건부로 구성해봐야 한다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/1f7ae9d56f45d5d7a5d3493a98601ad6dd4ef1bd)

<br />

- 추가 및 해결 해야 할 내용
  - 컴포넌트를 분리해줄만한 곳이 있는지 확인해봐야 함
    - 컴포넌트 분리만이 아닌, 조건부나 이런 내용에서 중복된 부분을 줄이고 코드 가독성을 향상 시켜줘야 함
  - 마지막 기능 추가로, 관리자 권한을 부여하는 내용을 생각하고 있음
    - 가입할 때는 일반 사용자로 가입을 할 수 있고, admin 관리자 계정으로 관리자 페이지에서 관리자 권한을 부여하는 내용을 생각 중
  - 반응형 관련된 작업 구성
    - react-responsive 라이브러리를 추가해서, 적용이 되는 지 테스트를 진행
      - 완료
    - 해상도에 따라서 다른 내용의 JSX 코드가 보여지도록 구성해야 함
  - 새롭게 발견한 문제
    - 관리자 채팅의 사용자 리스트에서 사용자와 나눈 마지막 메시지 내용을 가져오는데, 이 때 새로고침을 하지 않으면 당장 채팅을 나눠도 실시간으로 마지막 메시지가 갱신되지 않아서 새로운 메시지가 있는 지 확인할 수 없기 때문에 추가하는 것도 고려해야 함
    - 한편으로는, 관리자 채팅이라서 사용자가 겪는 불편함이 아니기 때문에 그냥 놔두는 것도 고려 중

# 오늘 느낀 점

- 모바일 환경에서 구성된 메인헤더 내용의 로고와 햄버거 버튼이 해상도가 작아짐에 따라서 크기가 줄어들고 양 옆으로 간격도 조금 차이가 생기면서 UI가 망가지지 않고, 자연스럽게 변화되는 것을 확인할 수 있었다. 메인헤더 메뉴와 드롭다운 메뉴를 연 후에 다시 닫기 위해서는 열었던 버튼을 통해서 닫아야하는 불편함이 있었는데, 이 불편함을 해결하기 위해서 해당 메뉴 외부인 배경을 클릭했을 때 닫히도록 구성을 해줘야 하지만, 메뉴들은 배경이 존재하지 않기 때문에 오버레이 컴포넌트를 추가해서 배경으로 사용될 수 있도록 해주고, 메뉴들의 외부이자 배경인 오버레이 컴포넌트를 클릭하면 해당 메뉴들이 닫히면서 UX가 개선된 것을 확인할 수 있었다. 이 내용을 구성해주면서 예전에 배우고 연습해봤던 portal도 사용해볼 수 있어서 좋은 기회였다고 생각이 되며, 추가로 조건부를 구성해서 2개의 오버레이가 중첩되어 열리는 것이 아닌, 한 개의 오버레이만 열리도록 구성을 해볼 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
