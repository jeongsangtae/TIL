# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 백엔드의 로그인 라우터에서 세션과 관련된 코드를 삭제, 회원가입 라우터에서 주석처리한 코드 삭제
    - 회원가입 라우터에서 세션과 관련된 내용을 주석 처리했었는데, 이 내용을 정리하기 위해서 삭제를 진행해주고, 로그인 라우터에 구성된 세션과 관련된 내용도 모두 삭제해주고 if문도 조금 정리를 해주었다.
    - 백엔드 구성
      - 로그인과 관련된 post 라우터에서 `req.session.inputData`로 구성된 객체 내용을 모두 삭제
      - message 부분만 남기고 잘못된 이메일 입력, 비밀번호 입력에 message가 프론트엔드로 전달되도록 구성
      - 잘못된 이메일, 비밀번호 입력 if문을 하나로 합쳐서 if-else로 구성 변경
      - 로그인 get과 관련된 라우터는 사용하지 않기 때문에 삭제
    - 테스트 결과, 정상적으로 작동하는 것을 확인할 수 있었고 걱정했던 "isAuthenticated"과 관련된 내용은 이미 프론트엔드에서 삭제해놓은 상태였기 때문에 백엔드에서도 문제없이 삭제를 진행할 수 있었다.
      - 이제 회원가입, 로그인 부분에서 세션과 관련된 내용은 없으며, 사용하지 않기 때문에 세션과 관련된 파일도 삭제를 진행해주면 될 것 같다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/141dcfaad871114546085a86284e6092614a31bf)

<br />

- 추가 및 해결 해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
    - 이 부분은 session을 삭제하게 되면 더 이상 신경쓰지 않아도 되지만, 현재는 session을 그냥 놔둔 상태이기 때문에 잠시 유지
  - 로그인을 유지하고 있을 때, token이 만료 시간에 가까워지면 자동으로 갱신되는 로직을 추가 해야 함
    - 대충 구성만 되어 있는 상태로, 좀 더 자세한 코드와 테스트가 필요함
  - 커스텀 Hook에 대한 고려 및 세션 제거 작업
    - 세션과 연동이 가능한 부분이 있는지도 테스트가 필요함
      - 불가능, 세션이나 jwt 토큰 중 하나만 사용하는 것이 좋다.
      - 세션을 삭제하는 작업을 아직 하지 않아서 해줘야 함
    - Context API를 사용하는 것은 좋지만, 이 내용을 사용하려는 파일에서 하나하나 추가해서 사용하기 때문에 커스텀 Hook을 구성해서 재사용할 수 있도록 해줄 필요가 있음
  - 백엔드의 user-router.js에서 accessToken, login/success, profile router에서 모두 accessToken 함수 내용을 재사용하고 있는데, 굳이 3개의 router로 나눌 필요가 있는 지 확인해보고 필요가 없다면 하나로 줄여줘야 함
    - 명확하게 하기 위해서 일단은 하나로 합치지 않고, 그대로 나눠서 사용하도록 유지
    - 내용이 엄청 많은 코드로 구성된 것이 아니기 때문에 현재로서는 크게 문제 없다고 생각되어 그대로 유지
  - 액세스 토큰, 리프레시 토큰 버튼을 메인헤더에서 제거해야 함
    - 일단 주석처리해서 사용하지 않도록 변경
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함
  - 메인 헤더 깜빡임 확인
    - 게시판에서 새로고침 시에는 깜빡임이 없으나, 프로필, 홈 화면에서는 메인헤더의 변경 깜빡임이 조금 있기 때문에 추가 확인 필요

# 오늘 느낀 점

- 회원가입, 로그인 라우터에서 세션과 관련된 내용을 정리해주었기 때문에, 이제 세션을 사용하기 위해 작업해주었던 파일의 내용을 주석처리 한 후에 마지막 테스트를 해보고 이상없다면 파일 자체를 삭제해주면 될 것 같다. 세션과 관련된 내용을 정리 해준 후에 액세스 토큰 자동 갱신에 관한 로직을 다시 짜봐야 할 것 같은데, 가능할 것 같으면서도 또 불가능할 거 같다는 생각도 들어서 다시 코드를 구성을 해봐야 확실하게 판단이 될 것 같다. 그리고 이번에 세션과 관련된 내용을 정리하면서 코드가 100줄 가량 줄어들었는데 더 정리가 필요한 부분을 찾아서 코드를 더 줄여볼 생각도 하고 있으며, 예외 처리가 더 필요한 부분도 찾아봐야 할 것 같다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
