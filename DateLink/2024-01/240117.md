# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 로그인 form에서 입력한 내용이 콘솔에 저장되도록 구성 (프론트엔드에서 코드 추가)
    - fetch 함수를 추가하고, 백엔드와 연결하기 전에 먼저 로그인 form에서 입력한 내용이 정상적으로 저장이 되고 출력이 되는지 확인하기 위해서 콘솔에 데이터가 출력되도록 구성
    - 회원가입에서 구성한 로직과 유사하게 구현했으며, 테스트 결과 정상적으로 입력한 내용이 form을 통해서 제출했을 때, 콘솔에서 입력한 내용을 확인할 수 있었다.
    - 이제 fetch 함수를 추가해서 백엔드와 연결하고, 입력한 내용을 DB에서 회원가입 데이터와 비교해서 오류 메시지를 받거나, 정상적으로 로그인이 되도록 하는 그런 추가 구성이 필요함
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/c1f34ba2b60d221393a9f9c6454e54ecded6cf0c)

  <br />

  - 로그인 관련 프론트엔드와 백엔드 연결 및 로그인 에러 메시지 출력 (프론트엔드에서 코드 추가)
    - fetch 함수를 사용해서 프론트엔드에서 입력한 내용을 백엔드를 통해서 DB에서 확인하고 올바른 입력의 경우 로그인, 잘못된 입력의 경우 그에 따른 오류 메시지를 출력
    - 회원가입에서 사용한 fetch 함수를 참고해서 거의 유사하게 구성
    - 로그인이 성공한 후에 로그인 모달은 토글을 통해서 닫히지만, 아직 메인 헤더는 변경되지 않기 때문에 이 부분 작업이 필요함
      - 로그인시 메인 헤더가 변경되어야 명확하게 로그인된 사실을 알 수 있기 때문에 해당 내용을 추가해줘야 한다.
    - 로그인을 한 후에 어떤 계정으로 로그인이 되었는지 알 수 있는 방법이 필요함
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/469d229367ff626de7357c215c4a941a31da4be8)

  <br />

  - 로그인 인증 로직 추가 및 로그인 성공 시 메인 헤어 변경 내용 추가
    - 백엔드에서 로그인 성공 시 `req.session.isAuthenticated` 내용을 함께 전송
    - 프론트엔드에서 가져온 `req.session.isAuthenticated` 내용을 useState를 통해서 저장하고 판별해서 조건부로 렌더링하도록 구성
    - 인증이 완료된 경우에는 메인헤더에서 홈, 게시판 그리고 프로필 항목이 보이고 인증이 되지 않은 경우에는 홈, 게시판, 회원가입, 로그인 버튼이 보이도록 구성
    - 아직 메인헤더에서 가져오는 fetch 함수의 내용인 body 부분에서 좀 문제가 있어서 제대로 작동하지 않기 때문에 수정이 필요
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/5bd3dade08e5e6f1e0360aad342aa2a5a431c468)

  <br />

  - MainHeader 컴포넌트의 fetch 함수 오류 수정
    - MainHeader.jsx에 있는 fetch 함수의 body에서 문제가 있던 부분을 고치기 위해서 loginData를 Login.jsx에서 MainHeader.jsx로 전달해서 사용하고 로그인 시 정상적으로 메인헤더의 내용이 변경되는 것을 확인
    - 로그인을 하면 정상적으로 조건부 렌더링이 작동해서 메인헤더가 변경되는 것은 좋지만, 또 다른 오류가 발생하고 있기 때문에 이 부분을 수정해야 함
      - 로그인 모달 창을 열었을 때 오류 발생
        - `converting circular structure to JSON` 오류
      - 새로고침을 했을 때 로그인이 자동으로 해제되는 오류 발생
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/7351c87293ef8c71600709c5e4a985f827ec3569)

<br />

- 추가해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
  - 로그인이 되는지 확인하고, 로그인이 되었다면 메인헤더가 변경되도록 구성해야 함
    - `req.session.isAuthenticated`를 프론트엔드에 전달해서, useState를 이용해 메인헤더가 변경되도록 해주면 될 것 같음 (완료)
    - 현재 결과로 따지면 로그인도 되고, 메인헤더가 변경되긴 하지만 오류가 있어서 추가 작업이 필요함
  - 로그아웃 기능도 추가해야 함
    - 로그인이 성공하면 메인헤더가 변경되고 로그아웃 버튼이 추가되며, 로그아웃 버튼 클릭 시 메인 헤더의 내용이 초기 상태로 돌아오도록 구성을 해줘야 함

# 오늘 느낀 점

- 로그인이 성공하는 것까지는 완성을 했는데, 오류가 좀 있어서 오류를 수정해줘야 한다. 그리고 로그인이 된 후에 새로고침하면 로그인이 풀려버리기 때문에 이 문제를 해결해줘야 하는데 아직 머릿속에 어떻게 해결해야 하는지 정확히 떠오르지않아서 좀 생각을 해보아야 한다. 로그인 관련 문제를 처리하고 프로필에서 내가 작성한 게시글들만 따로 보이도록 해줄 생각이며, 로그아웃도 그냥 버튼이 아닌, 프로필 아이콘을 사용해서 클릭시 하단에 다른 정보가 보여지고 그곳에서 로그아웃 버튼을 클릭할 수 있도록 하는 방향도 생각중이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
