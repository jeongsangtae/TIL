# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 회원가입 후에 모달 창이 닫히고, 회원가입 완료 페이지로 이동
    - 회원가입이 된 후에 모달 창이 닫히도록 하기 위해서 toggle prop을 사용
    - toggle prop으로 인해 모달창이 닫힌 후에 회원가입이 되었다는 것을 알려주기 위해서 회원가입 완료 페이지로 이동
    - 회원가입 완료 페이지로 이동할 때는 useNavigate를 사용해서 "signup-success" 페이지로 이동하도록 구성
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/f6fbd1d02befb483940d25740e2f398f86a23606)

  <br />

  - 로그인 로직 추가 및 사용자 인증 추가 (백엔드에서 코드 추가)
    - 로그인과 관련된 로직을 백엔드에 추가하고, react와 연결할 수 있게 코드를 변경해주었다.
      - 첫 번째로, 이메일이 존재하는지 확인하는 코드
      - 해싱되기전 비밀번호와 해싱된 후 비밀번호를 비교해서 일치하는지 확인하는 코드
        - 즉, 비밀번호가 일치하는지 확인하는 코드
      - 비밀번호까지 확인이 되면, `req.session.user`에 form에서 입력한 로그인 정보를 전달, `req.session.isAuthenticated`은 true로 전달
    - 세션을 사용하고, 사용자 인증과 관련된 미들웨어도 추가해서 해당 미들웨어에서 세션에서 사용자 정보와 인증 상태를 확인하고, 처리하도록 구성해주었다.
      - 사용자가 로그인되어 있지 않으면 다음 미들웨어로 전달하지 않고 종료된다.
      - 로그인한 사용자에 대한 라우트에서 이 미들웨어를 사용해 인증 여부를 확인할 수 있다.
      - if문에서 데이터가 들어오면 `!true`, isAuth에 true가 들어오면 `!true`로 `false || false`로 인해 false가 되어, `next()`를 실행하고 다음 미들웨어로 제어가 전달되는 방식
        - 데이터가 들어오지 않거나, isAuth에 false가 들어오는 경우, if문이 true가 되기 때문에 `return next()`가 실행되며, 미들웨어 함수가 종료되고 다음 미들웨어로의 제어가 전달되지 않는다.
        - 일반적으로 미들웨어 함수는 `next()`를 호출하면 다음 미들웨어로 제어를 전달하고 함수가 계속 실행되는데, `return next()`를 사용하면 `next()`를 호출하면서 동시에 현재 함수의 실행이 종료된다. 미들웨어 함수가 종료되기 때문에 다음 미들웨어로의 제어가 전달되지 않게 된다.
    - 프론트엔드에서 백엔드와 연결해서 추가한 코드가 작동되는지 테스트가 필요
      - 아직 제대로 테스트를 해보지 못해서 테스트를 진행해야 한다.
      - 테스트를 진행하기 전에 우선 로그인 되었을 때, 알 수 있도록 명확하게 알려주는 방법이 필요
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/41991e3c42d1657ea01f34999becf8586009dbf5)

<br />

- 추가해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
  - 백엔드에서 구성한 로그인 로직과 연결할 프론트엔드 로직을 구현해야 함
    - 프론트엔드 로직이 없어서 아직 테스트를 진행해보지 못해서 바로 추가해서 테스트를 진행해야 함
  - 로그인이 되는지 확인하고, 로그인이 되었다면 메인헤더가 변경되도록 구성해야 함
    - `req.session.isAuthenticated`를 프론트엔드에 전달해서, useState를 이용해 메인헤더가 변경되도록 해주면 될 것 같음
  - 로그아웃 기능도 추가해야 함
    - 로그인이 성공하면 메인헤더가 변경되고 로그아웃 버튼이 추가되며, 로그아웃 버튼 클릭 시 메인 헤더의 내용이 초기 상태로 돌아오도록 구성을 해줘야 함

# 오늘 느낀 점

- 회원가입이 완료된 후에 회원가입 모달창이 사라지고 회원가입 완료 페이지로 이동하도록 구성했는데, 일단은 나쁘지 않은 것 같다. 나중에 더 좋은 방법을 찾거나 생각이 난다면 수정할 생각이다. 백엔드에서 로그인 관련 로직을 추가했는데 아직 프론트엔드에서 로그인 관련 로직을 추가하지 않아서, 프론트엔드에서 로직을 구성한 뒤에 연결해서 테스트를 진행해봐야 한다. 테스트를 진행하고 정상적으로 로그인이 된다면 메인헤더가 변경되어 로그인이 되었다는 것을 명확하게 알 수 있도록 해줘야 하며, 추가로 로그아웃을 할 수 있게 관련 로직도 추가해야 한다. 그리고 회원가입과 로그인 모달창에 관련된 괜찮은 UI를 찾았기 때문에 찾은 UI를 참고해서 수정도 해줄 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
