# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 순환 참조가 발생하는 지점 확인 및 테스트
    - `Uncaught typeError: Converting circular structure to JSON` 이 오류를 해결하기 위해 찾아보니 JS에서 JSON으로 객체를 변환하려고 할 때 발생하는 일반적인 오류라고 한다.
      - 이 오류는 객체가 자기 참조하는 경우 발생할 수 있다고 하기 때문에, 이러한 경우 객체는 순환 구조라고 한다.
      - ex) 객체 A가 객체 B를 참조하고 객체 B가 다시 객체 A를 참조하는 경우, 이러한 객체는 순환 구조이다.
      - 이 경우, JSON.stringify() 메서드를 사용하여 객체를 JSON 문자열로 변환하려고하면 위와 같은 오류가 발생한다.
      - 해결 방법으로는 순환 참조를 수정하거나 JSON.stringify() 메서드를 사용하기 전에 순환 참조를 제거해야한다.
      - 순환 참조를 제거하는 가장 쉬운 방법은 객체에서 순환 참조를 찾아 수정하는 것이다.
    - 순환 참조가 발생하는 지점을 찾기 위해서 console.log를 추가해서 찾아보았느나, 제대로 찾지 못했다.
      - 어디에서 발생한 것인지 알 수가 없어서 지금 문제 해결을 못했는데 다른 방향 틀어서 해결할 생각이다.
    - 다른 방법으로, 차라리 메인 헤더에서만 login fetch 함수를 사용해서 데이터를 입력받고 Login.jsx에 해당 데이터를 내려주고, toggle만 사용하는 방향도 생각중
      - 솔직히 제대로 작동할 지, 이걸로 오류가 해결될 지 잘 모르겠지만 여러 방법을 사용해볼 생각이다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/a8cf11a13abbf96d80b32e7396f560ca52478707)

<br />

- 추가 및 해결 해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
  - 로그인이 되는지 확인하고, 로그인이 되었다면 메인헤더가 변경되도록 구성해야 함
    - `req.session.isAuthenticated`를 프론트엔드에 전달해서, useState를 이용해 메인헤더가 변경되도록 해주면 될 것 같음 (완료)
    - 현재 결과로 따지면 로그인도 되고, 메인헤더가 변경되긴 하지만 순환 참조 오류가 있어서 추가 작업이 필요함
  - 로그인 후에, 새로고침시 로그아웃 되어버리는 상황도 수정을 해야 함
    - 로그인하고 새로고침하면 다시 메인헤더가 로그인하지 않은 상태로 돌아오기 때문에 이 부분도 수정이 필요하다.
  - 로그아웃 기능도 추가해야 함
    - 로그인이 성공하면 메인헤더가 변경되고 로그아웃 버튼이 추가되며, 로그아웃 버튼 클릭 시 메인 헤더의 내용이 초기 상태로 돌아오도록 구성을 해줘야 함

# 오늘 느낀 점

- 오늘 하루종일 순환 참조 문제를 해결하기 위해서 console.log를 찍어보고 어디에서 발생하는 건지 찾아보고, 여러 해결 방법도 찾아서 시도해봤으나 결국 순환 참조 문제를 해결하지 못했다. 아무리 console.log를 찍어보아도 어디에서 발생하는지 알 수가 없었으며, 대체 어디가 문제인지 찾을 수가 없었다. 아무래도 내가 콘솔에 찍힌 내용을 정확히 파악하지 못하는 게 좀 문제인 것 같다. 처음으로 돌아가서 로그인과 관련된 코드를 좀 수정하는 방향도 생각중인데, 일단 다시 여러 방법을 시도해서 해결해봐야 할 것 같다. 사실 회원가입, 로그인 관련 로직은 금방 해결할 수 있을 거라고 생각했으나, 지금 생각해보니 자만이었다고 생각이 되며 스스로 반성을 하게 되었는데 포기하지 않고 문제를 해결해볼 생각이다. 그리고 백엔드와 DB를 expressjs 그리고 MongoDB를 사용하고 있는데, 좀 더 진행해보다가 React와 연결해서 작업하는게 너무 어렵다고 생각이 되면 Firebase를 사용하는 방향도 생각중이다. 또 다른 방법으로 차라리 라우트를 사용하지 않고, 그냥 React로만 구성하고 Redux나 Context API를 바로 사용해서 구성하는 방향도 생각중이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
