# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 그룹 채팅방 초대 목록 출력하는 로직 추가
  - 초대된 그룹 채팅방에 대한 정보가 없어서, 화면에 초대된 그룹 채팅방 목록을 출력하기 위해 프론트엔드 로직과 백엔드 로직을 추가해 서로 연결하고 그룹 채팅방 초대 목록이 화면에 보이도록 출력
  - 백엔드
    - group-chat-routes
      - 그룹 채팅방 초대 목록을 조회하는 GET 라우터 추가
        - 저장된 JWT 토큰을 통해 로그인한 사용자 정보를 가져오도록 구성
          - 불러온 사용자 정보가 유효한지 확인
        - 사용자 정보의 \_id 내용에 new ObjectId를 사용해 변환
        - 그룹 채팅방 초대 목록 컬렉션에 저장된 requester, receiver 항목과 userId를 비교해 일치하는 항목을 모두 찾도록 구성
        - 찾은 그룹 채팅방 초대 목록을 프론트엔드로 전달
    - groupChatStore
      - getGroupChatInvites 액션에 대한 타입 정의 추가
        - 비동기 함수 타입으로 정의
      - groupChatInvites 상태의 초기 타입 정의 추가
        - 배열로 구성
      - getGroupChatInvites 액션 추가
        - fetch 함수를 추가
          - 경로는 "/groupChat/invites"로 지정하고, 나중에 필요하면 roomId가 전달되도록 구성해 사용할 계획
          - 기본적으로 GET 메소드를 사용하고 credentials을 추가 구성
        - fetch 함수가 정상적으로 동작하는지 확인하고, 문제가 없다면 백엔드에서 전달한 데이터를 groupChatInvites 상태에 저장해 업데이트하도록 구성
    - DirectChats
      - useGroupChatStore에서 getGroupChatInvites 액션과 groupChatInvites 상태 내용을 불러오도록 구성
      - useEffect를 추가하고, 그 안에 getGroupChatInvites 액션을 추가해서 해당 컴포넌트가 마운트될 때 getGroupChatInvites 액션이 실행되도록 구성
        - 해당 페이지에 들어가면 그룹 채팅방 초대 목록이 있는지 바로 확인할 수 있도록 구성
      - JSX 코드
        - groupChatInvites 상태에 map을 사용해 새로운 배열로 만들고, 출력할 수 있도록 구성
        - key에는 \_id 내용을 사용하고 닉네임, 수락, 거절 내용으로 구성
  - 백엔드에서 그룹 채팅방 초대 목록 내용을 찾아서 프론트엔드로 전달하고 프론트엔드에서는 해당 그룹 채팅방 초대 목록을 전달받아 화면에 출력할 수 있도록 구성한 후에 확인한 결과, 문제없이 초대 받은 사용자 화면에 그룹 채팅방 초대 목록이 보여지는 것을 확인할 수 있었다.
    - 그룹 채팅방 초대 목록이 보여지는 것은 맞지만, 현재 참여하려는 채팅방 제목이 아닌, 채팅방 초대를 보낸 사용자 이름만 보이기 때문에 이 부분에 대한 수정이 필요
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/5ae61b6ec318ada7a6c35d1f9d6f4087fc2eb5c2)

<br />

- 그룹 채팅방 초대 관련 출력하는 내용 수정 및 알림 메시지, 그룹 채팅방 초대 목록 관련 타입 정의 추가
  - 그룹 채팅방 초대 목록 내용에서 그룹 채팅방 제목이 아닌, 초대를 보낸 사용자 이름이 보이기 때문에 그룹 채팅방 제목이 보이도록 수정하고, 그룹 채팅방 목록이나 알림 메시지를 출력하는 내용의 타입 정의가 이루어지지 않아서 타입 에러가 발생하기 때문에 타입 정의를 추가
  - 백엔드
    - group-chat-routes
      - 그룹 채팅방 초대 요청을 보내는 POST 라우터 수정
        - groupChatInvites 컬렉션에 그룹 채팅방 초대 요청에 관한 정보를 저장할 때 requester, receiver 등 정보만이 아닌, 방 제목인 roomTitle 항목도 함께 저장되도록 수정
  - 프론트엔드
    - groupChatStore
      - 재사용 타입 정의 파일에서 GroupChatInvites를 추가로 불러오도록 구성
      - groupChatInvites 상태에 대한 타입 정의 추가
        - GroupChatInvites 타입 정의를 사용하고 배열을 추가해 구성
        - `GroupChatInvites[]`로 구성
    - DirectChats
      - 재사용 타입 정의 파일에서 NotificationData 타입 정의를 불러오도록 구성
      - notificationMessage 객체 내용에서 사용되는 data에 NotificationData 타입 정의가 사용되도록 구성
        - data에 대한 타입 정의가 이루어지지 않아서 타입 에러가 뜨기 때문에, 재사용 타입 정의 파일에 구성한 NotificationData를 불러와 구성
      - JSX 코드
        - groupChatInvites 상태에 map을 사용해 출력하는 부분에서, 닉네임이 보여지도록 구성된 부분을 방 제목이 보여지도록 수정
          - 닉네임이 아닌, 방 제목이 보여지도록 수정해서 어떤 그룹 채팅방에서 초대 요청이 들어왔는지 확인할 수 있도록 구성
          - 추가로 보낸 사용자의 닉네임도 함께 보여주는 것이 좋을 것 같음
    - types
      - GroupChatInvites 타입 정의를 추가
        - 모든 항목을 string으로 설정해 구성
        - FriendRequest 타입 정의와 비슷하지만, GroupChatInvites 타입 정의는 roomTitle을 추가해 구성
  - 그룹 채팅방 초대 내용에서 방 제목이 보이도록 수정한 내용이 정상적으로 출력되는 것을 확인했고, 타입 정의가 되어있지 않은 부분들에 타입 정의를 추가해 주면서 타입 에러 표시가 사라진 것을 확인할 수 있었다.
    - 방 제목만이 아닌, 보낸 사용자 닉네임도 함께 보이도록 수정하는 쪽이 좋아 보임
    - 그룹 채팅방 초대 목록이 출력되기 때문에, 이제 이 내용에 수락 또는 거절 버튼이 활성화되도록 로직을 추가해 줘야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/6681cae7263134271176df5a0f5b056e533a893b)

# 오늘 느낀 점

- 그룹 채팅방 초대 요청에 대해 수락 또는 거절할 수 있도록 로직을 추가하려고 했지만, 생각해보니 그룹 채팅방 초대 목록을 따로 출력하고 있지 않아서 수락 또는 거절에 대해 처리할 수 없기 때문에, 그룹 채팅방 초대 목록이 보이도록 내용을 구성해 주었다. 그룹 채팅방 초대 목록이 정상적으로 출력되는 것을 확인했기 때문에, 이제 수락 또는 거절에 대한 처리가 되도록 구성을 해 줘야 하는데, 여기서 수락 또는 거절하면 내용이 사라지도록 할 지 아니면, 내용은 남아있고 버튼만 사라지도록 할 지 정해야 한다. 수락 또는 거절에 대한 내용은 친구 요청과 다르게 다이렉트 메시지로 전달될 예정이기 때문에, 그 채팅 메시지에서는 해당 내용이 사라지지 않고 유지되어 보이는 것이 맞다고 생각이 되기에, 미리 다이렉트 메시지에 옮기는 것을 고려해 내용 구성을 해 줘야 할 것 같다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 그룹 채팅방 초대하는 기능

- 그룹 채팅방을 삭제할 때, 그룹 채팅방에 저장한 모든 채팅 메시지도 함께 삭제되도록 로직 구성 필요

- 새로운 메시지 추가되었을 때 알림 뜨는 기능 (추가하긴 했으나, 미완성)

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 그룹 채팅방에서 채팅 메시지가 추가되면 전역적으로 알 수 있도록 알림이 떠야 하고, 그 알림 관리를 소켓 Zustand에서 할 수 있도록 구성 필요

- 그룹 채팅방 초대하고 알림을 전송하는 기능에서, 로그인한 사용자가 아닌 친구에게 보내는 그런 구조로 작동되도록 수정이 필요 (비로그인 상태여도 상관이 없음 단순하게 친구한테 친구 요청하면 알림 메시지가 전달되어야 함)

- 추가된 친구와 대화를 나눌 수 있는 다이렉트 채팅방

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
