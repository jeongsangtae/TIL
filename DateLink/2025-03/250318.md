# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 그룹 채팅방 나가기 관련 라우터 로직 수정 (그룹 채팅방 초대 메시지 관련 내용)
  - 그룹 채팅방 나가기 버튼을 클릭 시에 해당 그룹 채팅방과 관련된 모든 초대 메시지 내용이 삭제되는 것이 아닌, 나가는 사용자와 관련된 초대 메시지 내용만 삭제되도록 내용을 수정
  - 백엔드
    - group-chat-routes
      - 그룹 채팅방을 나가는 DELETE 라우터 수정
        - groupChatInvites 컬렉션에서 roomId를 사용해 일치하는 그룹 채팅방을 찾고, 나간 사용자가 receiver 또는 requester에 포함되어 있을 수 있기 때문에 `$or`을 사용해 확인하고 삭제하도록 수정
  - 나가기 버튼을 클릭한 사용자와 관련된 초대 메시지만 삭제되도록 수정하고 테스트한 결과, 해당 채팅방에 저장된 다른 초대 메시지 내용은 삭제되지 않고, 나가기 버튼을 클릭한 사용자와 관련된 초대 메시지 내용만 삭제되는 것을 확인할 수 있었다.
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/a6032889a38c0cfff6da1901aabe639153fd383f)

<br />

- 그룹 채팅방 삭제 소켓 관련 내용 수정 (window.location.href 내용 추가)
  - 그룹 채팅방을 호스트가 삭제할 때, 해당 그룹 채팅방에 참여한 사용자가 그 페이지에 있을 경우, 그룹 채팅방이 삭제되고 홈으로 이동되도록 내용을 수정
  - 프론트엔드
    - groupChatStore
      - getGroupChats 액션 수정
        - groupChatDelete 이벤트가 발생되면 현재 사용자가 삭제된 방에 있는 경우 홈으로 이동하는 조건문 추가
        - 현재 URL과 삭제되는 방 URL이 일치하는지 확인
          - `if (window.location.pathname === `/group-chat/${roomId}`) {...}`
        - 사용자가 삭제된 방에 있을 경우, 홈으로 이동
          - `window.location.href = "/"`
  - 그룹 채팅방을 호스트가 삭제할 때, 삭제된 방에 사용자가 그대로 남아있을 경우 홈으로 이동되도록 수정하고 테스트한 결과, 문제없이 작동되어서 삭제된 방에 남아있는 사용자들은 자동으로 홈 화면으로 이동되는 것을 확인할 수 있었다.
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/5ce209daab3416883b36f5516fd66dcca2d7d3b3)

# 오늘 느낀 점

- 그룹 채팅방에 참여한 사용자가 나가기 버튼을 통해 그룹 채팅방을 나갈 때, 해당 그룹 채팅방에 저장된 모든 초대 메시지를 삭제하는 것이 아닌, 해당 사용자와 관련된 초대 메시지 내용만 삭제되도록 내용을 수정해 주었고, 그룹 채팅방을 호스트가 삭제할 때, 삭제된 방에 그대로 남아있는 사용자들은 자동으로 홈으로 이동되어 해당 그룹 채팅방을 벗어나도록 내용을 수정해 주었다. 그룹 채팅방 추가, 삭제, 나가기, 그룹 채팅방에 추가된 사용자, 나간 사용자 등 실시간 관련 내용을 대부분 구성을 해 준 것 같은데, 빠진 내용이 있는지 확인을 해 봐야 하며, 그룹 채팅방 제목 수정과 관련된 내용도 실시간으로 반영이 되는지 체크가 필요하다. 그룹 채팅방 내부에서 새로운 메시지가 추가되었을 때 실시간으로 알림 전송되는 로직을 구현했었는데, 이 내용에 대해 제대로 테스트가 되지 않아서 문제가 있는지 확실하게 확인이 불가능 했지만, 이번에 그룹 채팅방에 다른 사용자들이 들어올 수 있게 되면서 확실하게 확인이 가능해졌기에 테스트를 진행해 봐야 하며, 문제가 있다면 추가 수정을 진행해 줄 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 새로운 메시지 추가되었을 때 알림 뜨는 기능 (추가하긴 했으나, 미완성)

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 그룹 채팅방에서 채팅 메시지가 추가되면 전역적으로 알 수 있도록 알림이 떠야 하고, 그 알림 관리를 소켓 Zustand에서 할 수 있도록 구성 필요

- 그룹 채팅방 초대하고 알림을 전송하는 기능에서, 로그인한 사용자가 아닌 친구에게 보내는 그런 구조로 작동되도록 수정이 필요 (비로그인 상태여도 상관이 없음 단순하게 친구한테 친구 요청하면 알림 메시지가 전달되어야 함)

- 추가된 친구와 대화를 나눌 수 있는 다이렉트 채팅방

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
