# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 사용자 이름을 백엔드에 전달 및 관리자 채팅이 추가될 때 사용자 이름도 함께 저장 그리고 사용자 삭제시에 채팅도 함께 삭제
    - 사용자 이름을 백엔드에 전달해서, 관리자 채팅이 추가될 때 어떤 사용자와 대화한지 구분하기 위해서 사용자 이름을 함께 저장해주고, 사용자 삭제시에 해당 사용자와 관련된 모든 채팅 내역도 함께 삭제되도록 구성해주었다.
    - 백엔드 구성
      - admin-router
        - 사용자 삭제시에 사용자-관리자 간의 나눈 모든 채팅을 삭제하기 위해서 chatMessages 컬렉션에 저장된 user_id와 백엔드에 넘어온 사용자 \_id를 비교해서 일치하는 모든 항목을 찾아서 삭제
      - admin-chat-routes
        - 어떤 사용자와 대화하는지 확실하게 알 수 있도록, 프론트엔드에서 전달받은 userName 정보를 새로운 메시지가 추가될 때 함께 저장하도록 구성
        - 이전에 사용하던 testUserId 변수를 삭제하고, userId 변수로 변경
          - 변수 이름만 변경
    - 프론트엔드 구성
      - AdminChats
        - userName 정보가 fetch 함수의 body에 포함되어 백엔드로 전달되도록 구성
    - 테스트 결과, 관리자 측에서 새로운 메시지를 제출하면 DB에 사용자 이름이 포함되어 추가되는 것을 확인할 수 있었고, 사용자 삭제시에 해당 사용자와 관련된 모든 채팅이 삭제되는 것을 확인할 수 있었다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/4e1c1b3c053c2e0920fe7ca131e8b492fab6a44f)

  <br />

  - 사용자 리스트에서 검색 기능 추가
    - 만약 많은 사용자가 추가되면, 하나하나 스크롤을 이동하면서 찾기 힘들기 때문에 검색 기능을 사용해서 바로 사용자를 찾고 채팅할 수 있도록 검색 기능을 추가해주었다.
    - 프론트엔드 구성
      - 사용자 검색에서 입력한 내용이 저장될 useState 추가
      - 검색에 사용될 input 추가
        - onChange를 사용해서 입력한 내용이 바로 useState에 업데이트되어 저장되도록 구성
      - filter 함수를 사용해서 입력한 내용과 일치하는 사용자만 찾도록 구성
        - updatedUsersData.filter(...)
          - updatedUserData 배열을 순회하며, userData 객체가 조건에 맞는지 확인
        - userData.name.toLowerCase()
          - userData.name을 소문자로 변환
        - searchTerm.toLowerCase()
          - 검색어를 소문자로 변환
        - .includes(searchTerm.toLowerCase())
          - 변환된 이름에 변환된 검색어가 포함되어 있는지 확인
        - userData.name.toLowerCase().includes(searchTerm.toLowerCase())
          - userData.name을 소문자로 변환하고, searchTerm도 소문자로 변환한 뒤, name에 searchTerm이 포함되어 있는지 확인
        - 최종적으로 filter를 통해서 조건을 충족하는 userData 객체만 포함된 새로운 배열을 반환
      - filter가 적용된 내용에 map 함수를 사용
        - filter 결과 배열의 각 userData 객체를 AdminUserItem 컴포넌트로 변환
        - 각 AdminUserItem 컴포넌트에 userData의 정보를 prop으로 전달
    - toLowerCase, includes
      - toLowerCase
        - 문자열을 소문자로 변환
        - ex) "Hello".toLowerCase()는 -> "hello"를 반환
        - 이 메서드는 대소문자를 구분하지 않고 검색할 때 유용하다.
      - includes
        - 문자열이 특정 문자열을 포함하고 있는지 확인
        - ex) "hello world".includes("world)는 true를 반환
        - 이 메서드는 부분 문자열 검색에 유용하다.
      - 검색어를 대소문자 구분 없이 검색하려면 `toLowerCase()`를 사용해 문자열을 소문자로 변환한 후, `includes()`로 해당 문자열을 포함하고 있는지 확인하면 됨
    - 테스트 결과, 사용자 리스트에서 찾는 사용자의 이름을 입력하면 filter와 map을 통해서 일치하는 내용의 사용자만 보여지게 되고, 클릭하면 해당 사용자와의 채팅방이 열리는 것을 확인할 수 있었다.
      - 의외로 생각보다 어려운 구성이 아닌 간단한 구성으로 JS와 React의 기본적인 기능들로 구현할 수 있었음
      - filter, toLowerCase, includes 같은 메서드로 대소문자 구분 없이 문자열을 쉽게 검색할 수 있음
      - 추가로 다른 방법들이 있는데, 이와 관련된 내용들은 따로 정리
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/e84bc7b01d21cfebf516528f387b7e7e706a6ed3)

  <br />

  - 검색 기능을 구현하는 여러 방법
    - React에서 검색 구현 방법
      - 기본적인 검색 구현
        - 기본적인 React 컴포넌트에서 검색 기능을 구현할 때, JS의 기본 메서드를 사용하는 것이 가장 직관적
        - 앞에서 구성한 filter 함수를 사용하고, toLowerCase와 includes 메서드를 사용
      - filter와 map 메서드 조합
        - filter와 map 메서드를 사용하는 조합은 매우 일반적인 방법으로 위에서 사용
        - filter와 toLowerCase, includes를 사용해서 내용을 찾고 map 함수를 사용해서 보여지도록 구성하는 방법
      - 검색 기능의 고급 구현
        - 여러 개의 조건이나 필터를 추가할 수 있음
        - 기본적인 filter 외에, 검색 조건을 추가해서 다른 필터링 조건을 적용할 수 있음
        - ex) 사용자 이름 외에 사용자 이메일과 같은 내용을 추가로 검색하도록 할 수 있음
    - React에서 검색 기능 구현 패턴
      - 상태 기반 검색
        - 검색어를 state로 관리하고, 필터링은 렌더링 시에 수행되도록 구성하는 방법
        - 현재 구성한 방법이 이 방법
      - 검색 입력 디바운스
        - 사용자 입력을 디바운스하여 성능을 최적화
        - 일정 시간 동안 입력이 멈출 때까지는 작업을 지연시키는 방식이다.
        - 사용자가 입력을 계속하는 동안에는 검색 필터링이나 API 호출이 실행되지 않고, 일정 시간 동안 입력이 멈춘 후에야 실행된다.
        - 디바운스를 통해서 성능을 크게 향상시킬 수 있다.
        - React에서는 디바운스 로직을 사용자 정의 Hook으로 간단하게 구현해서 사용할 수 있다.
        - 사용자 정의 Hook인 useDebounce Hook은 입력이 변경된 후 일정 시간 동안 입력이 없을 때에만 업데이트된 값을 반환한다.
      - 검색 라이브러리 사용
        - 복잡한 검색 기능에는 외부 라이브러리를 사용할 수 있는데, 예를 들어 "fuse.js"같은 라이브러리를 사용해서 구현할 수 있다.
    - 추가 내용으로, 성능 최적화 및 디바운싱
      - 성능 최적화
        - 사용자가 많아질수록 filter와 map 함수가 많은 데이터를 처리하게 되므로, 메모이제이션 등을 이용해 성능을 최적화할 수 있다.
        - 메모이제이션은 컴퓨터 프로그램이 동일한 계산 작업을 반복적으로 수행하지 않도록, 이미 계산된 결과를 저장하고 재사용하는 기술
        - 주로 성능 최적화에 사용되며, 특히 재귀적인 함수나 계산이 많이 반복되는 경우에 효과적이다.
        - 메모이제이션을 통해 불필요한 중복 계산을 피할 수 있으며, 이는 프로그램의 속도와 효율성을 크게 향상시킬 수 있다.
        - React에서는 useMemo와 useCallback Hook을 사용하여 메모이제이션을 적용할 수 있음
          - 이 훅들은 컴포넌트가 불필요하게 다시 렌더링되는 것을 방지하고 성능을 최적화하는 데 도움을 준다.
      - 디바운싱
        - 검색어 입력 시마다 필터링을 하면 성능에 영향을 미칠 수 있으므로, 디바운싱(debouncing)을 적용하여 입력이 완료된 후에만 필터링을 수행하도록 할 수 있다.
        - 이 내용이 사용자 정의 Hook으로 구성한 useDebounce 내용

  <br />

  - 사용자 리스트에서 구성한 검색 기능 CSS 추가
    - 검색 기능만 추가하고, CSS를 구성하지 않아서 UI가 보기에 많이 불편하기 때문에 CSS 내용을 추가해주었다.
    - 프론트엔드 구성
      - 사용자 검색 input에 사용될 돋보기 icon 추가
      - filter 함수 내용을 따로 변수로 만들고, 변수에 map 함수가 사용되도록 구성 변경
      - icon과 input을 하나의 div로 감싸서 검색 컨테이너를 구성
        - 검색 컨테이너에 돋보기 icon과 input이 들어가도록 구성
        - input은 다크 모드 내용도 구성할 수 있게 테마 모드 관련 className도 추가
    - CSS 구성
      - search-container
        - position, display 등 기본적인 내용 구성
        - 안에 들어갈 내용이 수평이 맞도록 align-items를 center로 구성
        - padding을 추가해서 약간의 공간 추가
        - 사용자 리스트와 구분해줄 밑줄을 border-bottom로 구성
      - search-icon
        - positon을 absolute로 구성해서, input 필드 안에 배치되도록 구성
        - 색은 회색 계열로 구성
        - 아이콘을 클릭해도 입력창에 영향이 없도록 pointer-events를 none으로 구성
      - search-input
        - 돋보기와 간격을 주기 위해서 padding-left 추가
        - width를 100%로 적용해서 꽉 차도록 구성
        - 배경은 투명으로 구성해서, 백그라운드 색이 적용되도록 구성
        - border 기본 구성을 해주고, 색은 투명으로 적용해서 색만 focus에서 따로 적용시키도록 구성
        - 다크 모드에서 텍스트가 흰색으로 보이도록 구성
      - search-input:focus
        - 3가지 구성 방법으로 구성
          - focus 테두리 거리 조절 없는 상태
            - outline은 none, border 색만 조절
          - box-shadow를 통한 focus 테두리 조절
            - outline은 none, border 색은 배경색을 따르도록 구성
            - box-shadow에서 4번째인 spread-radius에만 1px를 구성해주고, 색을 구성
          - focus 테두리를 자유롭게 추가 조절할 수 있는 상태
            - outline에서 border와 유사한 구성을 해주고, outline-offset을 통해서 거리 조절을 할 수 있게 구성
      - search-input:focus::placeholder
        - opacity를 추가해서, input이 포커스되면 placeholder가 반투명 상태가 되도록 구성
    - 테스트 결과, 사용자 검색 부분의 UI가 꽤 만족스러운데 여기서 focus 되었을 때 테두리가 안에 구성된 내용과 거리가 어느정도 되는 것이 UI에 보기 좋을지 선택을 해야 하고, 사용자 검색과 사용자 리스트간의 밑줄을 통해서 구분하는게 굳이 필요한지도 다시 한 번 검토해봐야 한다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/f7f83798568287833fd538acd8a88da81fa5099a)

<br />

- 추가 및 해결 해야 할 내용
  - 채팅과 관련된 내용 구성
    - 채팅창에서 사용되는 함수 이름 변경도 생각을 해봐야 하는데, 좀 더 명확하게 표현할 필요성을 느낌
    - 관리자 \_id와 이름이 필요한지 확인하고 필요없다면 삭제하는 것도 고려를 해봐야 함
  - 채팅 부분의 문제인지 정확히 파악이 되지 않지만, 토큰 갱신에서 오류가 있는지 갑자기 로그인 해제가 아닌 토큰 에러와 함께 로그인한 데이터가 날라가는 문제를 발견해서 이 부분에 대한 파악이 좀 필요하다.
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함
  - ul 요소 안의 자식이 li가 아닌, div나 프래그먼트로 사용되는 부분을 수정해야 함

# 오늘 느낀 점

- 사용자 삭제시에 해당 사용자와 관련된 모든 채팅도 삭제되도록 구성을 해주었고, 관리자 채팅 부분의 사용자 리스트에서 검색 기능도 추가를 해주었기 때문에 사실상 채팅과 관련된 기능은 거의 구성이 끝난 것 같은데, 여기서 추가로 검색 기능이 focus 되었을 때 border가 어느정도의 거리 조절이 필요한지 확인해서 내용을 변경해줘야 하고, 검색 기능 구현이 생각보다 어렵지 않아서 채팅창 내부에서도 검색 기능을 추가하는 것이 어떨 지 생각을 해보고 있는데, 굳이 문의 채팅에 검색까지 필요한건지 의문도 들어서 고민을 해봐야 한다. 그리고 관리자 \_id와 이름 데이터를 넘기지않고 그냥 삭제하는 것도 괜찮을 것 같은데, 또 한편으로는 DB에 관리자가 입력한 채팅 데이터를 저장할 때 관리자 \_id를 저장해서 명확하게 구분할 수 있도록 해주는 것도 좋다고 생각되어서 다시 한 번 코드를 봐보고 정말로 필요없다고 생각이 되면 삭제하고, 조금이라도 필요할 것 같으면 그냥 그대로 남겨둘 생각인데 관리자 이름 데이터는 굳이 필요없을 것 같다는 생각도 들어서 이 내용은 삭제하는 쪽으로 생각을 해야 할 것 같다. 마지막으로 검색 기능에서 성능 최적화와 디바운싱에 대해서 좀 더 알아야 할 것 같아서, 이 내용에 대해서 좀 더 알아보고 정리를 해줄 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
