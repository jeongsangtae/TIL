# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 채팅 입력에 따라서 textarea가 자동으로 늘어나도록 구성 추가
    - 채팅 입력에서 줄 넘김을 통해서 라인이 늘어날 때, 자동으로 textarea가 늘어나도록 구성해주고 줄 넘김을 통해서 입력한 내용이 화면에 그대로 출력되도록 구성
    - 프론트엔드 구성
      - textareaRef라는 이름의 useRef 추가
      - sendMessage 함수에서 새로운 메시지가 전송된 후에, textarea 크기가 다시 원래대로 돌아도록 해주기 위해서 textareaRef.current.style.height를 auto로 지정
        - textarea에 구성된 ref를 확인하고, 입력한 내용이 제출되면 높이에 구성된 auto를 통해서 자동으로 다시 원래 크기로 돌아오도록 구성
      - inputChangeHandler 함수에서 입력 내용에 따라서 입력 필드의 높이가 자동으로 조절되도록 구성 변경
        - textarea에서 ref를 추가한 내용을 확인해서, 입력 필드의 높이를 자동으로 측정하고 높이를 조절
      - handleKeyPress 함수를 사용해서, 사용자가 엔터 키를 눌러 메시지를 전송할 때 호출되도록 구성
        - 사용자가 내용을 입력하고 엔터 키를 누르면 메시지가 전송되도록 해주고, 줄 넘김을 하려면 시프트 키와 엔터 키를 눌러서 새 줄이 추가되도록 구성
      - chatToggleHandler 함수에서 setTimeout과 scrollToBottomHandler 함수를 사용해서, 채팅을 열었을 때 스크롤이 맨 아래에 있도록 구성
        - 채팅 창을 열 때 스크롤이 맨 아래에 이동되어 있도록 구성
      - textarea에 ref를 추가해서, textareaRef를 사용
        - row는 1로 설정
      - button을 감싸는 div 삭제
    - CSS 구성
      - Chat
        - message class에서 white-space를 pre-line으로 구성해서, 줄 넘김을 통해서 입력한 내용이 화면에 그대로 출력되도록 구성
      - Chats
        - input-container, input-container textarea 등 내용을 이전 코드로 다시 변경해서 기존의 UI를 사용하도록 구성
    - 테스트 결과, textarea에서 줄 넘김을 통해서 라인이 계속 추가될 때 그에 따라서 높이가 증가하는 것을 확인할 수 있었고, 채팅 내용을 입력하고 제출하면 다시 원래대로 돌아오는 것도 확인할 수 있었다.
      - 문제는 textarea의 높이는 증가하지만 채팅 내용의 container는 줄어들지 않아서 채팅 입력창이 채팅 내용을 가려버리는 상황이 발생하기 때문에, 채팅 입력창이 늘어남에 따라서 채팅 내용 컨테이너가 줄어들도록 구성을 해줘야 한다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/68114ed65c33225348e987eb6dfc56b299b1fa5f)

  <br />

  - 채팅 입력에 따라서 textarea가 자동으로 늘어나는데, 이 때 채팅 컨테이너가 자동적으로 줄어들도록 구성 추가
    - 채팅 입력에서 줄 넘김을 통해서 라인이 늘어날 때, textarea가 늘어나도록 해주는 문제는 해결했지만, 반대로 채팅 컨테이너가 줄어드는 부분은 구성해주지 않아서 textarea가 채팅 컨테이너의 채팅 내용을 가리는 구조가 되기 때문에, textarea 크기가 늘어나는 것에 따라서 채팅 컨테이너는 줄어들도록 구성을 해주었다.
    - 프론트엔드 구성
      - textarea의 초기 높이를 설정하는 useState 추가
      - 채팅 입력창이 늘어날 때, 채팅 내용이 보여지는 컨테이너가 줄어들도록 useEffect를 추가
        - useEffect를 추가하고, chatContainerRef.current를 사용해서 채팅 컨테이너의 DOM 요소를 참조
        - if문을 통해서 채팅 컨테이너 요소가 존재하는지 확인하고, 채팅 컨테이너의 높이를 설정하도록 구성
          - 입력 필드의 높이(textareaHeight)와 16px을 뺀 값으로 설정
          - 이 계산으로 입력 필드가 커지면 채팅 컨테이너의 높이가 줄어들게 됨
          - 입력 필드가 커지고 채팅 컨테이너가 줄어들 때, 채팅창이 맨 아래에 있도록 해주기 위해서 scrollToBottomHandler 함수를 추가
        - 의존성 배열로 textareaHeight를 추가해서 textareaHeight가 변경될 때마다 useEffect가 작동
      - sendMessage 함수에서 메시지가 제출된 후에 늘어난 textarea 높이를 다시 초기 값으로 설정하는 내용 추가
      - inputChangeHandler 함수에서 입력 필드의 높이를 제한해서 160px까지만 커지도록 구성 추가
        - 제한을 하지 않으면, 채팅 컨테이너 제일 상단까지 textarea가 늘어나기 때문에 160px까지 늘어나면 더 이상 늘어나지 않도록 해주기 위해서 제한하기 위한 if-else문을 추가
    - CSS 구성
      - user-messages-container
        - padding이 하단은 적용되지 않도록 padding-bottom을 0으로 구성
      - input-container textarea
        - textarea가 일정 높이에 도달했을 때 더이상 늘어나지 않고, 스크롤이 생기도록 해주기 위해서 overflow-y를 auto로 구성
        - textarea가 일정 높이에 도달했을 때, 채팅 내용 컨테이너와 그대로 거리가 유지되도록 max-height를 설정
    - 테스트 결과, textarea가 늘어나는 동시에 채팅 컨테이너가 줄어들어서 채팅을 더이상 가리지 않게 되었고, textarea에서 일정 높이까지 늘어나면 스크롤이 생기면서 어떤 내용을 입력했는지 자유롭게 확인할 수 있는 것도 확인해주었다.
      - textarea가 늘어나면서 채팅 컨테이너가 줄어드는 것은 좋지만, 문제는 textarea가 늘어남에 따라서 전송 버튼쪽도 같이 늘어나기 때문에 이 부분을 수정해줘야 한다.
      - 채팅을 입력하면 1px 늘어나고, 제출하면 1px 다시 줄어드는 문제가 있는데 이 부분을 확인하고 수정해줘야 함
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/055dc77ba0e6e838b61094c5fd5c5fef68a26864)

<br />

- 추가 및 해결 해야 할 내용
  - 채팅과 관련된 내용 구성
    - 채팅창에서 사용되는 함수 이름 변경도 생각을 해봐야 하는데, 좀 더 명확하게 표현할 필요성을 느낌
  - 컴포넌트를 분리해줄만한 곳이 있는지 확인해봐야 함
    - 컴포넌트 분리만이 아닌, 조건부나 이런 내용에서 중복된 부분을 줄이고 코드 가독성을 향상 시켜줘야 함
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함
  - 함수 이름에서 헷갈리는 부분이나, 명확하게 해줘야 할 부분을 찾아서 수정해야 함
  - 전체적으로 코드에 주석을 추가해서 어떤 코드가 어떤 기능을 하는지 알 수 있도록 해줘야 함
  - ul 요소 안의 자식이 li가 아닌, div나 프래그먼트로 사용되는 부분을 수정해야 함
  - 채팅 부분에서 엔터를 눌러서 다음 라인으로 넘어가서 채팅이 입력되도록 해야 함
    - 이 부분은 수정해서 엔터를 통해서 제출하고, 시프트 + 엔터를 통해서 다음 라인으로 넘어가도록 구성
  - Chats 컴포넌트에서 많은 내용이 모아져 있는 것 같아서 컴포넌트 분리를 고려해야 함
    - 관리자 채팅인 AdminChats도 확인해줘야 함
  - 답글 추가와 수정 컴포넌트를 합치는 것을 다시 생각해봐야 함
    - 이 부분은 결국 분리하는 것으로 결정을 했었는데, 추가로 다시 확인이 필요함
  - 페이지로 구성되어있는데, action 함수가 사용되지 않는 부분을 확인해야 함
  - 새로고침했을 때, 채팅창이 한번 열리면서 닫히는 문제를 해결 해야 함
  - 채팅에서 입력한 내용이 그대로 보여지도록 수정해야 함
    - font-size로 조절하기 때문에, 이 부분에 대한 수정이 필요
    - 다른 방법이 있다면 그 방법을 찾아서 시도해봐야 함

# 오늘 느낀 점

- 채팅 입력을 통해서 채팅 입력 필드 높이가 증가하는 동시에, 채팅 컨테이너의 높이가 줄어들도록 내용을 구성해줬는데, 이 내용을 추가해준 후로 문제가 하나 생겼는데 채팅을 처음에 입력하면 ul 요소의 길이가 1px 줄어들고, 제출하면 다시 1px 늘어나는데 이 부분을 확인하고 수정 해주기 위해서 여러 구성을 변경해봤지만 해결하지 못해서, console.log를 추가해서 다시 확인해보고 내용을 수정해줄 생각이다. 그리고 새로고침을 했을 때 채팅창이 한번 열리고 닫히는 모션이 작동하기 때문에 확인하고 수정을 해줘야 한다. 채팅 입력 필드가 늘어나면 제출 버튼도 함께 늘어나기 때문에, 이 부분을 수정해서 채팅 제출 버튼이 하단에 위치하도록 구성을 변경해서 textarea만 늘어나도록 해주고 제출 버튼은 그대로 크기를 유지하도록 해줄 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
