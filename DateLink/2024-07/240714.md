# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 말풍선, 검색 관련 CSS 수정 및 사용하지 않는 코드 삭제
    - 수정하려고 생각했던 CSS 내용을 조금씩 수정해주고, 주석처리해놓고 사용하지 않던 내용 삭제
    - 프론트엔드 구성
      - AdminChats, AdminMainHeader에서 주석처리하고 사용하지 않는 부분과 console.log로 더 이상 확인할 부분이 없는 곳은 삭제해주었다.
    - CSS 구성
      - Chat, AdminChat
        - 말풍선 색을 변경
      - AdminUserList
        - focus 테두리 거리 조절을 자유롭게 조절할 수 있는 내용으로 수정
    - 테스트 결과, 채팅 부분에서 라이트 모드일 때 말풍선 색을 변경해서, 상대방 채팅과 내 채팅 구분을 더 확실하게 할 수 있도록 해주고, 검색 기능이 활성화되었을 때 주위 원 테두리 거리를 조금 더 늘려서 검색 기능창이 더 눈에 띄도록 구성을 해주었으며, 사용하지 않는 주석처리된 코드를 삭제해주었다.
      - 관리자 \_id와 이메일 내용을 삭제하는 것도 고려를 했지만, 관리자 \_id는 params를 통해서 백엔드에 전송하고 있고, 관리자 이메일은 나중에 추가 관리자가 생겼을 때 구분하는데 사용할 수도 있고, 현재 관리자 내용 하나로 성능에 크게 문제가 없기 때문에 그냥 남겨놓는 것으로 결정하게 되었다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/fd1f327e49ad002f7aac8cf613562931025aac35)

  <br />

  - 게시글에서 검색 기능 추가 (실패)
    - 관리자 채팅의 사용자 리스트에서 검색 기능을 추가하고 사용해보니, 게시글 부분에서도 추가하면 UX 부분에서 향상될 것으로 생각되어 검색 기능을 추가하기 위해서 코드를 구성해주었다.
    - 프론트엔드 구성
      - 검색어를 저장할 useState 추가
      - fetchData 함수의 매개변수에 searchQuery 내용 추가
        - fetch 함수의 쿼리 파라미터에 search 내용 추가
      - paginationFetchData 함수의 매개변수에 searchQuery 내용 추가
        - fetchData 함수를 호출하여 데이터를 가져온 후, 상태를 업데이트
      - onPageChange 함수는 페이지 번호가 변경될 때 URL을 업데이트하고 state를 변경
        - new URLSearchParams(location.search)를 통해서 현재 URL의 쿼리 파라미터를 가져오도록 구성
        - params.get("search")를 통해서 쿼리 파라미터에서 search 값을 가져옴
        - navigate를 사용해서 search 내용이 포함된 새로운 URL로 이동하도록 구성
        - 주 목적은 사용자가 페이지 번호를 변경할 때 호출
        - 페이지 번호가 변경될 때 호출되며, 검색어가 유지된 상태로 페이지를 이동
        - 페이지네이션 버튼 클릭 시 호출되도록 구성
      - searchHandler 함수를 새롭게 추가해서, 검색어가 변경될 때 URL을 업데이트하고 상태를 변경하도록 구성
        - 검색어가 변경될 때 URL을 업데이트하고 state를 변경
        - navigate를 사용해서 새로운 URL로 이동을 하는데, 이 때 검색 시 항상 페이지 번호를 1로 설정해서 새로운 검색어로 검색할 때 첫 번째 페이지로 이동하도록 구성
        - 검색어가 변경되었을 때 검색 결과를 처음부터 다시 보여주는 역할을 하도록 구성
        - 주 목적은 사용자가 새로운 검색어를 검색할 때 호출
        - 새로운 검색어로 검색할 때 호출되고, 페이지 번호를 1로 설정하고 검색어를 반영하여 URL을 업데이트
        - 검색 버튼 클릭 시 호출되도록 구성
      - useEffect에서 location.search 내용을 추가해서 컴포넌트가 마운트되거나 location.search가 변경될 때 실행되도록 구성
        - location.search를 통해서 URL의 쿼리 파라미터를 기반으로 상태를 업데이트하고 데이터를 가져오도록 구성
        - new URLSearchParams(location.search)를 통해서 현재 URL의 쿼리 파라미터를 가져오도록 구성
        - params.get("search")를 통해서 쿼리 파라미터에서 search 값을 가져옴
        - const page = parseInt(params.get("page"))를 통해서 쿼리 파라미터에서 page 값을 가져옴
        - searchTerm과 page 내용을 업데이트하는 useState 내용을 사용해서 search, page 상태를 업데이트
        - paginationFetchData(page, search)를 통해서 데이터를 가져와 상태를 업데이트
        - location.search를 의존성 배열로 추가
      - 검색창으로 사용될 input을 추가하고, 검색한 내용이 실행될 수 있도록 button 추가
        - 아직 CSS 구성은 하지 않은 상태
    - 구성한 코드의 전체 흐름 파악
      - 페이지 변경
        - onPageChange 함수가 호출되면 URL 쿼리 파라미터를 업데이트하고 페이지 상태를 변경
      - 검색어 변경
        - searchHandler 함수가 호출되면 URL 쿼리 파라미터를 업데이트하고 페이지 상태를 1로 설정
      - 컴포넌트 마운트 및 URL 변경
        - useEffect가 실행되어 URL 쿼리 파라미터를 기반으로 상태를 설정하고 데이터를 가져옴
      - 데이터 가져오기
        - fetchData 함수가 호출되어 서버로부터 데이터를 가져오고, paginationFetchData 함수가 상태를 업데이트
    - 테스트 결과, 검색어를 입력하면 URL이 변경되는 것을 확인했는데, 문제는 URL이 변경되고 입력한 검색어와 일치하는 내용만 따로 보여지지 않기 때문에 추가 작업이 필요해보인다.
      - 생각해보니 백엔드에서 작업을 해주지 않아서, 아무리 검색해도 검색한 내용의 데이터만 가져오지 못하는 것 같아서 백엔드 구성을 해봐야 확실하게 알 수 있을 것 같다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/ddf132881df94c5496b2e53b2b8cf575b8ad52f1)

  <br />

  - 게시글에서 검색 기능 추가 성공 (백엔드에서 검색 필터 구성)
    - 검색어를 입력하면 URL만 변경이 되고 검색한 내용을 찾지 못했는데, 사용자 리스트에서와는 달리 게시글 검색 기능은 페이지 이동도 해야 하며, 백엔드에서 데이터를 불러와서 보여줘야 하기 때문에, 백엔드에서 검색과 관련된 필터 내용을 구성해주었다.
    - 백엔드 구성
      - 게시글을 가져오는 get rotuer에서 작업
      - 검색어 쿼리 파라미터를 가져오는 내용 추가
      - filter 변수를 추가해서 검색어가 있을 경우 조건을 확인해서 문서를 찾도록 구성
        - "$or" 연산자를 사용해서 조건 중 하나라도 만족하는 문서를 찾도록 구성
          - title, content, name 중 하나라도 검색어를 포함하는 문서를 찾도록 구성
        - "$regex" 연산자를 사용하여 검색어를 포함하는 문서를 찾도록 구성
          - ex) 검색어가 example이라면 title, content, name에 example을 포함하는 문서를 찾음
        - "$regex" 연산자에 "$options"에 "i"를 사용해서 대소문자를 구분하지 않도록 구성
          - "i"는 case-insensitive(대소문자 구분 없음) 옵션을 의미
          - 검색어가 example 이라면 Example, EXAMPLE, eXample 등 모두 매칭됨
      - filter 변수를 find 메서드에 전달하여 필터링된 결과를 가져오도록 구성
        - 게시글을 가져오는 posts 변수의 find에서 모든 내용을 찾았으나, filter 변수를 사용해서 필터링된 결과를 가져오도록 변경
      - "$regex"와 "$or" 연산자를 결합해서 여러 조건을 배열로 제공해서 배열 안의 조건 중 하나라도 만족하는 문서를 반환하도록 구성
    - 테스트 결과, 게시글 검색을 하면 title, content, name에서 검색한 내용과 일치하는 내용 모두 보여주는 것을 확인할 수 있었다.
      - 검색한 내용과 일치하는 항목을 제목, 내용, 이름에서 모두 찾는 건 좋지만 이 내용을 좀 더 세분화해서 제목, 내용, 이름을 선택해서 검색할 수 있도록 변경해줄 생각이다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/2a8deced1586ac37a80afb33a687fd6fc8a65dbb)

<br />

- 추가 및 해결 해야 할 내용
  - 채팅과 관련된 내용 구성
    - 채팅창에서 사용되는 함수 이름 변경도 생각을 해봐야 하는데, 좀 더 명확하게 표현할 필요성을 느낌
  - 게시글 검색 기능 관련 내용 수정 필요
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함
  - ul 요소 안의 자식이 li가 아닌, div나 프래그먼트로 사용되는 부분을 수정해야 함

# 오늘 느낀 점

- 관리자 채팅에서 관리자 \_id와 이메일을 삭제하지 않고 그대로 유지하는 방향으로 결정을 했고, 채팅 부분에서 검색 기능을 추가하는 대신에 게시글 부분에서 검색 기능을 추가해서 원하는 게시글을 찾을 수 있도록 해줬는데, 현재 게시글 검색 기능은 검색을 하면 제목, 내용, 이름에서 일치하는 모든 항목을 한번에 찾도록 구성이 되어있는데, 이 구성을 변경해서 게시글 검색 기능에서 제목, 내용, 이름을 선택해서 원하는 항목을 선택하고 해당 항목에서 일치하는 내용을 찾을 수 있도록 해줄 생각이다. 그리고 현재 게시글 부분에서 검색을 하고 난 후에 게시글이 5개가 안되는 상황에서, 페이지네이션 기능이 활성화되어 여러 페이지로 이동하는 버튼이 보여지는데 이 오류에 대해 어떤 문제가 있거나 코드에서 누락된 곳이 있는지 확인을 해줘야 하고, 프론트엔드에서 구성한 코드 방식이 일반 JS에서 사용하는 방식이기 때문에 이걸 변경해서 react에서 사용하는 방식으로 변경해줄 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
