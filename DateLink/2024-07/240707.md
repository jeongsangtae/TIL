# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 마지막 메시지 정보를 가져오기 & 마지막 메시지 정보를 출력 (출력하는 부분은 미완성)
    - 마지막 메시지 정보를 fetch 함수와 get 메소드를 통해서 가져오고 useState에 저장하는 것은 구성을 하고, 이 내용을 전달하고 출력하기 위해서 map 함수를 사용해야 하는데 이미 map 함수에서는 사용자 정보를 전달하기 때문에 마지막 메시지 정보를 전달하고 출력하는 부분은 제대로 구현하지 못했다.
    - 백엔드 구성
      - params를 통해서 전달받은 userId 정보를 new Object로 변환
      - chatMessages 컬렉션에서 userId 내용을 사용해서 일치하는 데이터를 찾고, 날짜를 기준으로 내림차순 정렬해서 하나의 결과만 가져와서 배열로 구성
        - 마지막 메시지 하나만 가져오도록 구성
      - 이 정보를 프론트엔드에서 사용할 수 있게 json으로 전달
    - 프론트엔드 구성
      - AdminUserList
        - 마지막 메시지와 관련된 useState 추가
        - 새로운 useEffect를 추가하고, fetch 함수 내용을 구성해서 백엔드 엔드포인트와 연결
        - 백엔드에서 가져온 마지막 메시지 정보를 useState에 저장하도록 구성
    - 테스트 결과, 마지막 메시지 정보는 문제없이 가져오지만, 이 내용을 전달하고 출력하는 부분에서 조금 문제가 생겨서 아직 정확한 테스트를 해보진 못함
      - 마지막 메시지 정보를 전달하기 위해서는 map 함수로 새로운 배열을 만들고 전달해야 하는데, 이 때 map 함수는 이미 사용자 정보를 전달하는데 사용하고 있기 때문에 여기에 포함시켜서 전달해야 하는데, 이 부분 구현을 아직 하지 못해서 추가 구성으로 함께 전달하도록 해주고 마지막 메시지 정보가 출력되는지 확인이 필요하다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/b6b58b8a669c5e039865af539b170c94096aa610)

<br />

- 추가 및 해결 해야 할 내용
  - 채팅과 관련된 내용 구성
    - 사용자-관리자 사이의 방 번호를 설정해서 서로 채팅이 보이도록 구현해야 함
      - 관리자 부분에서 사용자 \_id를 가져오고 해당 방으로 들어가는 내용을 구성해야 함
        - 관리자 채팅을 열면, 사용자 리스트가 보여지고 거기서 클릭해서 들어간 사용자 \_id의 정보가 넘어와서 사용될 수 있도록 추가 구성을 해야 함
      - 관리자 채팅창에서는 채팅 버튼 클릭 시, 바로 채팅창이 들어가지는 것이 아닌 채팅창을 선택해서 들어갈 수 있도록 사용자 항목을 만들어줘야 함
        - 관리자 채팅에서 채팅 버튼을 클릭하면 채팅방이 열리는 것이 아닌, 사용자 리스트가 열리도록 수정한 상태로, 사용자를 클릭하면 사용자 \_id가 넘어오는 것까지는 확인해서 추가로 내용을 수정해서 사용자 채팅방으로 넘어가도록 구성해줘야 함
    - 스크롤 작동에서 추가 작업을 해봐야 함
      - 대부분의 스크롤 문제는 해결되었지만, 상대방이 새로운 메시지를 추가했을 때 스크롤이 맨 밑에 있다면 그대로 스크롤도 함께 이동되어야 하지만 스크롤이 이동되지 않고 새로운 메시지 버튼이 뜨기 때문에 이 부분을 수정해줘야 함
      - 이 부분은 수정해서 정상적으로 작동하지만, 수치를 조금 변경해서 세부 조정이 필요함
    - 사용자 계정이 삭제될 때, 해당 채팅도 함께 사라지도록 구성을 변경해줘야 함
    - 채팅창에서 사용되는 함수 이름 변경도 생각을 해봐야 하는데, 좀 더 명확하게 표현할 필요성을 느낌
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함
  - ul 요소 안의 자식이 li가 아닌, div나 프래그먼트로 사용되는 부분을 수정해야 함

# 오늘 느낀 점

- 마지막 메시지를 AdminUserItem에서 가져오고 출력하려고 했는데, 데이터는 가져오는 것은 문제가 없었는데 출력하는 부분에서 문제가 있어서 구성한 내용을 AdminUserList로 옮기고 다시 테스트해보려고 했으나, 여기서 출력을 하기 위해서 map 함수에 마지막 메시지 내용을 구성해서 새로운 배열로 만들고 AdminUserItem에 prop으로 전달해야 하는데, map 함수는 사용자 정보를 전달하는데 사용하고 있기 때문에 추가로 함께 전달하도록 구성을 해야 하는데, 이 부분은 처음 접해보는 부분이라서 제대로 구현하지 못해서 테스트를 진행해보지 못했다. 현재 생각한 방법으로 가져온 마지막 메시지 내용을 사용자 정보 배열에 포함 시켜서 map 함수에서 함께 사용되도록 해야 할 것 같은데, 아직 제대로 코드를 구성해보지 못했기 때문에 로직 구성을 해보고 어떻게 하나의 배열에 사용자 정보와 마지막 메시지를 합칠 것인지 테스트해봐야 할 것 같다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
