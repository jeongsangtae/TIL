# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- children props 재사용 타입 정의 추가 및 빠진 타입 정의 추가, 코드 정리
  - 재사용 가능한 ChildrenProps 타입 정의를 추가하고, children props가 사용되는 파일에서 ChildrenProps 내용을 불러와 구성하고, 추가로 빠진 타입 정의 그리고 주석 처리되거나 사용되지 않는 코드를 삭제해 정리
  - 프론트엔드
    - DirectChatPage
      - 사용하지 않는 컴포넌트 내용 및 주석 처리된 내용을 삭제
    - DirectChatMainContent
      - ChildrenProps 타입 정의를 불러오고, children props에 타입 정의
    - DirectChatSidebar
      - DirectChatSidebarProps 타입 정의를 추가하고, onFriendToggle에 타입 정의
      - 주석 처리한 toggleFriend useState, friendToggleHandler 함수 내용 삭제
    - DirectChats
      - CSS 파일 주석 처리
      - 주석 처리한 내용들 삭제
    - Friends
      - FriendsProps 타입 정의를 추가하고, toggleFriend에 타입 정의
      - 주석 처리한 toggleFriend useState, friendToggleHandler 함수 내용 삭제
      - JSX 코드 내의 주석 처리된 온라인, 친구 버튼 삭제
    - Authentication
      - ChildrenProps 타입 정의를 불러오고, children props에 타입 정의
    - types
      - ChildrenProps 타입 정의 추가
        - children 항목에 ReactNode로 타입 정의
  - children props에 대한 타입 정의를 위해 파일 내부에서 ReactNode를 추가하지 않고, 재사용 타입 내용만 불러와 구성하면서 좀 더 코드가 간단해졌고, 사용하지 않는 코드들을 정리해 주면서 이전보다 훨씬 깔끔해진 것을 확인할 수 있었다.
    - 친구 관련 내용이나 다이렉트 채팅방 세부 내용이 메인 콘텐츠 영역에 문제없이 보이긴 하지만, 현재 친구 관련 내용이 보인 상태에서 다이렉트 채팅방을 클릭하면 세부 내용이 친구 관련 내용 아래에 그대로 보여지므로 내용을 수정해 두 내용중에 하나만 열리도록 구성해야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/7fae406bbe008a656725a8abbfec0cbfa7c6e4e8)

<br />

- 다이렉트 채팅 메인 콘텐츠에 출력하는 내용 전환되도록 구성 추가 및 친구 목록 관련 토글하는 내용 삭제하고 navigate 추가
  - 친구 관련 내용 또는 다이렉트 채팅방 세부 내용이 메인 콘텐츠 영역에서 보여질 때, 하나의 내용이 보여지고 다른 내용을 클릭하면 전환되어 이전 내용은 보이지 않고 클릭한 내용이 보여지도록 구성을 추가해 주었고, 친구 목록 관련 토글 내용을 삭제해 친구 버튼 클릭 시에 홈으로 이동되며 항상 친구 관련 내용이 보여지도록 구성
  - 프론트엔드
    - DirectChatMainContent
      - useLocation, useNavigate를 추가해 사용할 수 있도록 구성
      - selectedMainContent useState 추가
        - 초기값은 null
        - 저장될 수 있는 내용은 friends, directChat, null이 되도록 타입 정의
      - friendToggleHandler 함수 수정
        - navigate를 통해 /me 경로로 이동되도록 구성
      - useEffect 추가
        - 의존성 배열로 location.pathname을 추가
        - 조건문을 추가해 location.pathname가 "/me"일 때, setSeletedMainContent 내용을 통해 friends로 업데이트
        - else if를 추가해 `location.pathname.startsWith("/me/")`이 true면 setSeletedMainContent 내용을 통해 directChat으로 업데이트
          - startsWith 내용으로 인해 문자열이 특정 문자열로 시작하는지를 확인하고, 경로 내용이 "/me/" 이렇게 시작할 경우 true가 됨
      - JSX 코드 내용 수정
        - selectedMainContent 내용을 확인해 friends 일 경우
          - Friends 컴포넌트 내용이 보여지고, Friends 컴포넌트에 toggleFriend props로 true 내용을 전달
        - selectedMainContent 내용을 확인해 directChats일 경우
          - children이 적용되도록 구성
        - 메인 콘텐츠 영역에 구성된 이전 내용은 주석 처리
  - 친구 관련 내용 그리고 다이렉트 채팅방 세부 내용이 함께 보이지 않고, 두 내용 중에 하나의 내용이 보여진 상태에서 다른 내용을 클릭하면 해당 내용으로 전환되어 이전 내용이 보이지 않도록 구성하고 테스트한 결과, 친구 관련 내용이 보여질 때 다이렉트 채팅방을 클릭하면 다이렉트 채팅방 세부 내용이 보여지고 친구 관련 내용은 보이지 않는 것을 확인할 수 있었다.
    - 반대 경우인 다이렉트 채팅방 세부 내용이 보여질 때 친구 버튼을 클릭하면 친구 관련 내용이 보여지고 다이렉트 채팅방 세부 내용은 보이지 않는 것을 확인
    - 친구 버튼 클릭 시에 친구 관련 내용이 토글되어 숨겨지는 것이 아닌, 그대로 친구 관련 정보가 보여지는 것을 확인
    - 로그아웃을 하면 친구 관련 내용이 로그아웃한 상태에서 그대로 보여지는 오류가 있기 때문에 이와 관련해 수정을 해야 하고, / 경로 내용을 /me 경로로 모두 수정하는 것을 고려해야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/ff9b3b25b631d721bb0d0108b72c7772363d708d)

<br />

- 다이렉트 채팅 로그인 유무 확인하는 내용 위치 변경 및 로그인 시에 키 중복 오류 수정 실패
  - 로그아웃한 상태에서 친구 관련 내용이 그대로 계속 보여지는 문제가 발생해 다이렉트 채팅 메인 콘텐츠 컴포넌트에서 로그인 유무를 확인하도록 수정하고, 로그인하면 친구 관련 내용에 로그인한 사용자 정보가 표시되고, 로그인한 사용자 키 관련 중복 문제가 발생해 관련 오류를 수정하기 위해 여러 내용 테스트
  - 프론트엔드
    - DirectChatMainContent
      - 로그인 유무를 확인할 수 있도록 isLoggedIn 상태와 관련된 내용을 추가
      - 키 중복 관련 오류 내용을 테스트하기 위해 여러 내용 추가
    - DirectChatSidebar
      - 로그인 유무를 확인하는 isLoggedIn 상태와 관련된 내용을 삭제
    - Friends
      - 로그인하면 실행되는 useEffect 내에서 친구 목록 전체를 불러오는 것이 아닌, 로그인한 친구 목록을 불러오는 내용 추가해 테스트하고 주석 처리
        - 키 중복 관련 오류 테스트
  - 사용자가 로그인하기 전에 친구 관련된 내용이 보여지지 않도록 구성을 해주고 테스트한 결과, 추가한 내용이 문제없이 적용되어 로그인하기 전에 친구 관련 내용이 보이지 않는 것은 문제가 없지만, 사용자가 로그인했을 때 발생하는 키 중복 관련 오류는 제대로 해결하지 못해서 추가 수정이 필요하다.
    - 토글 내용을 사용해 친구 관련 내용을 보여줄 때는 키 중복 관련 오류가 없었지만, 새롭게 추가한 로직을 통해 항상 친구 관련 내용이 보여지도록 구성한 뒤에 키 중복 관련 오류가 발생하므로, 이와 관련된 로직을 수정해 봐야 함
    - 임시방편으로, 로그인하면 전체 친구 목록이 아닌 로그인 되어있는 친구 목록이 보여지도록 구성하면 키 중복 오류가 발생하지 않지만, 이 방법으로는 근본 문제를 해결할 수가 없기 때문에 다른 방법을 시도해봐야 함
    - filter 메서드를 사용해 중복된 키 내용이 보이지 않도록 할 수는 있지만, 이 방법 또한 근본 해결책이 아니기 때문에 근본적인 원인을 찾아 수정해볼 생각임
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/c4c1738938b178093c0ab8edeb86455599702ff5)

# 오늘 느낀 점

- 서브 사이드바 옆인 메인 콘텐츠 영역에 친구 관련 내용이나 다이렉트 채팅방 세부 내용이 보여지는데, 이 때 친구 관련 내용이 보여진 상황에서 다이렉트 채팅방을 클릭하면 친구 관련 내용은 보여지지 않고 다이렉트 채팅방 세부 내용이 보여지도록 구성을 했는데, 이 내용이 잘 적용되어 반대의 상황도 정상적으로 작동하긴 하지만, 문제는 로그아웃하고 다시 로그인하면 로그인한 사용자 정보가 친구 관련 내용에 보여지고, 그로 인해 키 중복 관련 오류까지 발생하기 때문에 이에 대한 내용 수정이 필요한 상황이다. 로그인한 사용자 정보가 친구와 관련된 내용으로 전달될 이유도 없고, 전달되는 그런 로직도 없는 것 같은데 관련 내용이 전달되어 로그인한 사용자 정보가 친구 목록에 함께 보여지고 키 중복 오류가 발생해 관련 오류를 해결하기 위해 여러 방법을 테스트했지만, 임시 방편이나 보호 필터 같은 내용만 성공하고 근본적인 원인을 찾지 못했기에 추가로 테스트를 진행해 근본적인 오류를 해결해 볼 생각이고, 이 내용을 처리한 다음에 CSS 관련 내용을 추가할 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 로그아웃 버튼 등 여러 버튼들이 텍스트가 아닌 아이콘으로 보여지도록 수정 필요

- 홈으로 이동 시에 친구 버튼과 다이렉트 채팅방 목록이 사이드바 옆으로 보여지고, 친구 버튼 클릭 또는 다이렉트 채팅방 클릭 시에 그 옆으로 해당 내용이 보여지도록 수정 필요

- 그룹 채팅방은 그룹 채팅방에 참여한 사용자 목록이 사이드바 옆으로 보여지고, 그 옆에 채팅 관련 내용이 보여지도록 수정 필요

- 출력되는 채팅 메시지 목록에 스크롤을 추가해 보기 편하도록 변경해야 하고, 메시지가 언제 추가되었는지 구분할 수 있도록 저장된 날짜 데이터를 불러와 표기해야 함

- 채팅 입력창에 적용된 스크롤 기능 추가 수정 필요

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 삭제 시에 다이렉트 채팅방 삭제 확인 로직 필요 (친구 삭제 시에 다이렉트 채팅방을 그대로 남겨놓고 삭제 확인창은 따로 추가하지 않을 예정)

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 그룹 채팅방 초대하고 알림을 전송하는 기능에서, 로그인한 사용자가 아닌 친구에게 보내는 그런 구조로 작동되도록 수정이 필요 (비로그인 상태여도 상관이 없음 단순하게 친구한테 친구 요청하면 알림 메시지가 전달되어야 함)

- 추가된 친구와 대화를 나눌 수 있는 다이렉트 채팅방 (진행중)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
