# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 빈 채팅 입력창 제출 방지 및 엔터키 동작 수정 및 비활성화 CSS 추가
  - 채팅 입력창에서 빈 문자열 상태로 전송이 되지 않도록 방지하고, 추가로 빈 문자열인 상태에서는 제출 버튼이 활성화되지 않도록 구성했으며, 메시지를 입력하고 엔터 키를 클릭하면 바로 메시지 전송이 되고, 시프트 + 엔터 키를 통해 줄바꿈이 적용되도록 내용을 수정
  - 프론트엔드
    - ChatInput
      - isMessageValid 변수 추가
        - message useState 내용에 trim().length를 사용하고 0보다 큰지 확인
        - 공백 포함 글자 길이가 0이 넘을 경우 true
      - sendMessageHandler 함수 수정
        - event 내용을 삭제하면서 타입 정의 내용도 함께 삭제
          - 클릭 관련 이벤트로 타입 정의했기 때문에 삭제
          - event.preventDefault() 내용도 함께 삭제
        - if문 내에 !isMessageValid를 추가해 메시지가 비어있는지 확인하도록 수정
          - 콘솔에 따로 출력하는 에러 메시지없이 조용히 return하도록 수정
        - sendMessage에 전달하는 message 내용에 .trim()을 추가해 앞뒤 공백이 제거된 메시지를 전달
      - keyPressHandler 함수 추가
        - event에 대한 타입 정의는 키보드 이벤트로 타입 정의
        - if문 내의 `event.key === "Enter"`
          - 사용자가 엔터 키를 눌렀는지 확인
        - if문 내의 `!event.shiftKey`
          - 시프트 키를 누르지 않았을 때만 아래 if문 내의 로직 실행
          - 즉, 단순히 엔터 키만 눌렀을 때를 구분
        - if문 내의 내용
          - 기본 동작을 막아서 textarea의 줄바꿈을 막음
            - 엔터 키를 눌러도 줄이 바뀌지 않도록 함
          - `sendMessageHandler()`를 실행해 메시지를 전송
            - 앞에서 줄바꿈을 막은 후에, 메시지 전송하는 함수 실행
        - 최종적으로 엔터 키를 누르면 메시지가 전송되고, 시프트 + 엔터 키를 누르면 줄바꿈이 적용되도록 구성
      - JSX 코드 내용 수정
        - textarea 내에 onKeyDown prop을 추가해 keyPressHandler 함수로 구성
        - 전송 버튼에서 !isMessageValid를 조건부로 사용해 true일 떄는 disable className이 추가되고, false일 때는 빈 문자열이 추가되도록 구성
  - CSS
    - Chats
      - 스크롤 관련 내용에서 사용되는 색 내용을 rgb가 아닌 헥사 코드 방식으로 수정
    - ChatInput
      - disable
        - opacity는 0.5로 불투명하게 구성
        - pointer-events를 none으로 구성
        - 해당 class가 활성되면 버튼이 비활성화 되어 클릭되지 않도록 구성
  - 빈 문자열 상태에서 메시지 전송이 되지 않도록 방지하고, 엔터 키로 메시지를 제출하고 시프트 + 엔터 키로는 줄바꿈이 적용되도록 구성하고 확인한 결과, 모두 문제없이 적용되어 빈 문자열일 때는 제출 버튼이 활성화되지 않으며, 메시지를 입력하고 엔터 키로 바로 전송이 가능하고, 줄바꿈을 할 때는 시프트 + 엔터 키로 적용되는 것을 확인할 수 있었다.
    - 콘솔에서 제출 버튼에 적용된 class를 삭제하고 빈 문자열로 제출하려고 하는 동작까지 모두 막아진 것을 확인
    - 채팅을 추가한 사용자 닉네임이 전송되고, 전송된 내용을 불러와 화면에 출력하도록 구성해야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/cc7175ae00f6f04421352b06a9c665c7b783e811)

<br />

- 사용자 닉네임 DB에 저장 및 사용자 닉네임 정보 전달, 출력 및 재사용 타입 정의 수정
  - 채팅을 추가한 사용자 닉네임이 백엔드로 전송되고, 백엔드에서 해당 내용을 포함해 DB에 저장, 그리고 채팅 목록을 불러올 때 채팅을 추가했던 사용자 닉네임을 함께 불러와 화면에 출력하도록 구성
  - 백엔드
    - chat-routes
      - 채팅 메시지를 추가하는 POST 라우터 수정
        - 프론트엔드에서 보낸 req.body 데이터에 nickname을 포함
        - 새로운 메시지를 저장할 때, nickname 항목을 포함해 저장하도록 구성
  - 프론트엔드
    - chatStore
      - sendMessage 액션 수정
        - newMessage 객체 데이터에 nickname 항목을 추가하고, userInfo.nickname으로 구성
    - Chats
      - JSX 코드 내용 수정
        - Chat 컴포넌트에 nickname props를 추가해 message.nickname 데이터를 전달
    - Chat
      - nickname props를 전달받고, ChatMessage 타입 정의 내용에서 nickname 항목까지 불러와 타입 정의
      - JSX 코드 내용 수정
        - 닉네임과 날짜 내용을 감싸는 div를 추가하고, chat-header className으로 구성
        - 닉네임에 chat-nickname className 추가
        - 날짜에 chat-date className 추가
        - 메지시 내용에 chat-message className 추가
    - ChatInput
      - 콘솔 로그 관련 내용 삭제
    - types
      - ChatMessage 타입 정의 수정
        - nickname 항목을 추가해 string으로 타입 정의
  - 채팅을 추가한 사용자 닉네임이 저장되고, 해당 내용을 함께 채팅 목록에서 출력하도록 구성하고 확인한 결과, 채팅 목록에서 채팅을 추가한 사용자 닉네임, 날짜 그리고 채팅 내용이 보여지는 것을 확인할 수 있었다.
    - 사용자 닉네임, 날짜, 채팅 내용이 문제없이 보여지긴 하지만, 현재 CSS 구성이 제대로 되어있지 않아서 UI가 조금 불편하기 때문에 이에 대한 CSS를 추가해야 함
    - 사용자 닉네임이 업데이트될 때 다른 내용에서 사용되는 사용자 닉네임이 함께 업데이트되도록 구성을 해야 하고, 이전에 우선 사용자 닉네임을 업데이트하는 그런 로직이 필요함
    - 채팅 입력창 내의 제출 버튼에 대한 내용을 수정해 텍스트 대신에 아이콘이 제출 버튼으로 사용되도록 구성해야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/0622ea05bddd8876b9c06552c920e5ff69341392)

# 오늘 느낀 점

- 채팅 입력창에서 빈 문자열로 제출이 되지 않도록 방지하는 내용을 추가하고, 엔터 키로는 채팅 메시지를 제출하고, 시프트 + 엔터 키로는 줄바꿈이 되도록 구성을 해주었고, 채팅 목록에서 채팅을 추가한 사용자 닉네임을 보여주도록 구성했는데, 현재 CSS 내용이 제대로 구성되지 않아서 UI가 좀 불편하므로 수정해 줄 생각이다. 사용자 닉네임 업데이트 관련된 로직도 현재 없는 상태고, 사용자 닉네임이 업데이트될 때 다른 내용에서 사용되는 사용자 닉네임도 함께 업데이트 되도록 로직을 구성해 봐야 하며, 채팅 입력창에서 제출 버튼으로 사용되는 내용이 텍스트로 구성되어 있는데 이 내용은 텍스트보다는 아이콘이 더 적절하다고 생각되어 수정할 생각이다. 추가로 채팅 목록에서 같은 닉네임의 사용자가 연속되어 채팅을 추가할 때, 닉네임이 중복으로 보여지지 않고 한 번만 보여준 상태에서 채팅 목록이 쭉 나열되어 보여지도록 구성해 볼 생각이고, 여기서 날짜가 바뀐 상태에서 추가된 채팅 메시지는 커서를 올리면 짧게 줄여서 시, 분 정도의 날짜가 보이도록 구성해볼 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 같은 닉네임이 연속되어 채팅을 추가한 경우, 닉네임이 중복되어 보이지 않고 한번만 보여준 채로 채팅 내용이 쭉 보여져야 함 (채팅 메시지에 커서를 올렸을 때 짧게 줄여진 날짜가 보여야함)

- 일 날짜가 바뀐 상태에서 추가된 메시지는 닉네임을 다시 보여주고, 그 일 안에서 연속된 채팅 메시지는 닉네임을 한 번만 보여주는 구조 그리고 커서를 올렸을 때 시, 분 날짜 데이터가 보이도록 구성해야 함

- 서브 사이드바 관련 UI 수정 필요

- 닉네임 업데이트 관련 로직 추가 필요

- 사용자 닉네임 데이터를 채팅 데이터에 추가해 저장할 경우, 닉네임 업데이트 관련 로직이 작동될 때 함께 업데이트 되도록 구성이 필요함

- 로그아웃 버튼 등 여러 버튼들이 텍스트가 아닌 아이콘으로 보여지도록 수정 필요

- 그룹 채팅방은 그룹 채팅방에 참여한 사용자 목록이 사이드바 옆으로 보여지고, 그 옆에 채팅 관련 내용이 보여지도록 수정 필요

- 출력되는 채팅 메시지 목록에 스크롤을 추가해 보기 편하도록 변경해야 하고, 메시지가 언제 추가되었는지 구분할 수 있도록 저장된 날짜 데이터를 불러와 표기해야 함

- 채팅 입력창에 적용된 스크롤 기능 추가 수정 필요

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 삭제 시에 다이렉트 채팅방 삭제 확인 로직 필요 (친구 삭제 시에 다이렉트 채팅방을 그대로 남겨놓고 삭제 확인창은 따로 추가하지 않을 예정)

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 그룹 채팅방 초대하고 알림을 전송하는 기능에서, 로그인한 사용자가 아닌 친구에게 보내는 그런 구조로 작동되도록 수정이 필요 (비로그인 상태여도 상관이 없음 단순하게 친구한테 친구 요청하면 알림 메시지가 전달되어야 함)

- 추가된 친구와 대화를 나눌 수 있는 다이렉트 채팅방 (진행중)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
