# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 라우터 구조 수정 테스트 및 로그인 페이지, 메인 페이지 새로고침 오류 테스트 및 여러 내용 테스트
  - 라우터 구조를 변경해 메인 페이지에서 새로고침 시에 로그인 페이지로 이동하는 오류를 테스트하고, 수정한 라우터 구조가 정상적으로 작동하는지 그리고 다른 내용들은 문제없이 작동하는지 테스트
  - 프론트엔드
    - router
      - 기존 라우터 구성을 주석 처리하고, 새로운 라우터 구조를 추가
      - "/login", "/", "/me", "/group-chat" 경로를 모두 형제로 구성
        - "/login" 경로
          - TestMainContent 컴포넌트 내용을 출력
        - "/" 경로
          - Navigate를 통해 "/login" 경로로 이동하도록 구성
        - "/me" 경로
          - RootLayout 페이지 컴포넌트 내용을 출력
          - NotFound 컴포넌트를 errorElement로 사용
          - children을 추가해 EmptyChatPage 페이지 컴포넌트를 index로 구성
            - EmptyChatPage 페이지 컴포넌트 대신에 DirectChatPage 페이지 컴포넌트가 들어오도록 수정 필요
            - EmptyChatPage 페이지 컴포넌트로 구성되어서 홈에서 친구 관련 내용과 다이렉트 채팅방 관련 내용이 보이지 않고 있음
          - children 내에 ":roomId" 경로를 추가하고 DirectChatDetailsPage 페이지 컴포넌트를 출력
        - "/group-chat" 경로
          - RootLayout 페이지 컴포넌트 내용을 출력
          - NotFound 컴포넌트를 errorElement로 사용
          - children을 추가해 GroupChatPage 페이지 컴포넌트를 index로 구성
          - children 내에 ":roomId" 경로를 추가하고 GroupChatDetailsPage 페이지 컴포넌트를 출력
    - Authentication
      - 테스트를 위해 추가했던 useEffect, authChecked useState, refreshTokenExp 액션, renewToken 액션 모두 주석 처리
      - Navigate를 통해 "/login" 경로로 이동하는 내용도 주석 처리하고 이전 코드를 사용하도록 구성
    - TestMainContent
      - useNavigate를 추가해 사용할 수 있도록 구성
      - useAuthStore Zustand에서 isLoggedId 상태를 불러와 사용할 수 있도록 구성
      - useEffect 추가
        - isLoggedId 상태를 조건부로 사용해 true일 때, navigate를 통해 "/me" 경로로 이동하도록 구성
          - navigate에 replace: true를 추가해 뒤로 가기를 눌러도 "/login"으로 이동되지 않도록 구성
        - 의존성 배열로 isLoggedId 상태를 추가
    - SideBar
      - logoutHandler 함수 수정
        - 테스트를 위한 "/me" 경로 navigate 추가
  - 메인 페이지에서 새로고침 시에 로그인 페이지로 이동하는 오류를 해결하기 위해 여러 방법을 테스트해 본 결과, 보호 컴포넌트를 수정하는 것으로는 오류를 해결할 수 없고, 다른 오류들이 더 생기는 문제가 발생하기 때문에 라우터 구조를 수정해 관련 오류가 해결된 것을 확인할 수 있었다.
    - 라우터 구조에서 DirectChatPage 페이지 컴포넌트가 사용되지 않아서 서브 사이드바 관련 내용이 보여지지 않고 있는데, 해당 내용을 구성해 관련 내용들이 문제없이 적용되는지 확인이 필요함
    - 로그인 페이지를 따로 나누는 것은 간단하지만, 따로 나누고 그 이후 로그인 유지나 조건부로 처리에 대한 문제가 쉽지 않은 것 같아서 이에 대해 좀 더 생각과 테스트가 필요함
    - 조금 다른 방법이지만, 로그인 관련 기능을 복잡하게 구성하지 않고 사이드바에 보여지는 로그인 또는 회원가입 버튼을 없애고, 로그아웃하면 "/me" 경로에서 바로 로그인 모달이 전체 화면을 가리면서 보여지도록 하는 방향을 생각중이며, 어떤 구조가 더 간단하고 편리한지 확인이 필요함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/f75f1c468930ce4f98adea49625fc3aff28c7c40)

# 오늘 느낀 점

- 로그인 페이지에서 로그인하면 메인 페이지로 이동이 되는데, 이 때 메인 페이지에서 새로고침했을 때 해당 페이지가 유지되지 않고 로그인 페이지로 이동되는 오류가 발생했고, 이 문제를 해결하기 위해 보호 컴포넌트에서 여러 방법을 테스트하고 처리해보려고 했으나 하나를 해결하면 또 다른 문제가 발생하고, 오히려 구조가 이상해지고 복잡해지는 것 같아서 라우터 구조를 전체적으로 수정해 해당 문제를 처리해주었다. 수정한 라우터 구조가 문제없이 작동되어, 현재는 큰 이상이 없기 때문에 이 구조로 진행을 하면서 사이드바 옆에 서브 사이드바 내용인 친구 관련 내용과 다이렉트 채팅방 관련 내용이 보여지도록 구성을 해줘야 하고, 이후 메인 콘텐츠 영역도 문제없이 출력하는지 확인이 필요하다. 만약 이 구조가 문제 있거나 너무 복잡하다면 조금 다른 방법으로 로그인 관련 페이지를 따로 구성하지 않고, 처음에 페이지에 접속하면 "/me" 경로에서 전체 화면을 가리는 로그인 모달이 보여지고, 그 다음 로그인하면 메인 내용이 보여지는 구조 그리고 로그아웃하면 다른 경로로 이동되는 것이 아닌, "/me" 경로에서 다시 전체 화면을 가리는 로그인 모달이 보여지는 구조로 구성하는 것을 생각해봤는데, 어떤 방식이 더 나은지 확인이 필요하며 최대한 깔끔하고 직관적인 방법을 선택해 구성할 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 로그아웃 버튼 등 여러 버튼들이 텍스트가 아닌 아이콘으로 보여지도록 수정 필요

- 홈으로 이동 시에 친구 버튼과 다이렉트 채팅방 목록이 사이드바 옆으로 보여지고, 친구 버튼 클릭 또는 다이렉트 채팅방 클릭 시에 그 옆으로 해당 내용이 보여지도록 수정 필요

- 그룹 채팅방은 그룹 채팅방에 참여한 사용자 목록이 사이드바 옆으로 보여지고, 그 옆에 채팅 관련 내용이 보여지도록 수정 필요

- 출력되는 채팅 메시지 목록에 스크롤을 추가해 보기 편하도록 변경해야 하고, 메시지가 언제 추가되었는지 구분할 수 있도록 저장된 날짜 데이터를 불러와 표기해야 함

- 채팅 입력창에 적용된 스크롤 기능 추가 수정 필요

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 삭제 시에 다이렉트 채팅방 삭제 확인 로직 필요 (친구 삭제 시에 다이렉트 채팅방을 그대로 남겨놓고 삭제 확인창은 따로 추가하지 않을 예정)

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 그룹 채팅방 초대하고 알림을 전송하는 기능에서, 로그인한 사용자가 아닌 친구에게 보내는 그런 구조로 작동되도록 수정이 필요 (비로그인 상태여도 상관이 없음 단순하게 친구한테 친구 요청하면 알림 메시지가 전달되어야 함)

- 추가된 친구와 대화를 나눌 수 있는 다이렉트 채팅방 (진행중)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
