# 오늘 한 일

### JS 토이 프로젝트 제작 (JS, ExpressJS, MongoDB로 만드는 게시판 + EJS)

- 게시판 제작 진행 과정

  - 쿠키 만료 시간 추가
    - 기본적으로 세션 만료 시간이 2주정도인데 여기서 쿠키의 만료 시간을 24시간으로 설정해서 세션도 함께 적용되도록 하였다.
    - 세션을 분리해놓은 파일에서 store 다음에 cookie 객체를 만들어서 maxAge로 `24*60*60*1000`으로 설정해 24시간으로 설정
    - mongodb에서 세션-쿠키 객체 속성에 대해 maxAge외에 expires, secure, httpOnly, domain, path, sameSite 이렇게 있다.
      - originalMaxAge: 세션이 얼마나 지속될 수 있는지를 밀리초 단위로 나타낸다. 이 값이 null이면 세션이 브라우저를 닫을 때까지 유지된다. 쿠키의 만료 시간을 설정
      - expires: 세션이 만료되는 시각이다. 이 값이 null이면 세션이 브라우저를 닫을 때까지 유지된다.
      - secure: 불리언 값으로, HTTPS 프로토콜을 사용하여 통신할 때만 쿠키를 전송하도록 지정한다.
      - httpOnly: 불리언 값으로, HTTP 프로토콜로만 쿠키에 접근할 수 있도록 지정한다. 클라이언트에서 쿠키에 접근할 수 있는지 여부를 설정한다.
      - domain: 쿠키가 사용될 도메인을 설정한다.
      - path: 쿠키가 적용되는 URL 경로를 지정한다.
      - sameSite: 쿠키를 어떤 경우에만 전송할 수 있는지 지정한다. 'strict', 'lax', 'none' 중 하나의 값을 가질 수 있다. SameSite 옵션을 설정하여 CSRF 공격 방지를 수행한다.
    - 나는 여기서 maxAge만 추가하였고, 나머지는 기본 값으로 두었다. domain은 설정할 수도 있지만 현재는 비어두었다.
    - domain 속성 값은 주의해야하는데 도메인을 지정하면 해당 도메인에 속한 모든 하위 도메인에서 쿠키를 사용할 수 있게 된다. ex) example.com 도메인에 쿠키를 지정하면, www.example.com이나 api.example.com 등과 같은 모든 하위 도메인에서도 쿠키를 사용할 수 있게 된다. 이것이 바람직하지 않을 경우, domain 속성 값을 생략하거나, 적절하게 설정하는 것이 필요하기 때문에 기본 값으로 두는게 좋다고 생각이 된다.
  - 프로필 페이지 사용자 인증 추가
    - 프로필에서 사용자 인증이 되지않으면, 401페이지로 이동하며 콘솔에서 401에러가 뜨게된다.
    - 정상적으로 사용자 인증이 된다면, 프로필 페이지의 내용이 보여지게 된다.
  - 로그아웃 버튼 추가
    - 로그아웃 버튼을 헤더에 추가해놓았는데 기존의 헤더의 버튼들은 a태그로 단순하게 원하는 페이지로 이동하는 기능만 있지만, 로그아웃 버튼은 form으로 감싸주며 button으로 변경해주었는데 form에서는 action에 /logout, method에 POST를 주어 동작하도록 구성하였다.
    - 다른 버튼들과 다르게 로그아웃 버튼은 클릭 시 form을 통한 동작이 되어야하는데 그 동작은 사용자 인증이 해제되어야하며, 사용자 인증이 되었을 때 볼 수 있는 프로필 페이지가 보이지않게 되어야한다. (사용자 인증이 해제되어 인증이 되지않은 상태가 되기 때문이다.)
    - 로그아웃 router.post에서는 먼저 user를 null로 만들어 id와 email이 보이지않게 되고, isAuthenticated를 false로 만들어 인증이 되지않은 상태로 만든다. 그 다음 메인페이지로 리다이렉션해준다.
    - 로그아웃이 되면 사용자 인증이 해제된 상태이기 때문에 개인이 볼 수 있는 프로필 페이지는 인증이 되지않은 상태로 뜨며, 메인 페이지로 이동해 게시글만 볼 수 있도록 한다.

  <br />

- 게시판 제작 진행 다음 목표

  - 본격적으로 회원가입, 로그인 관련 로직을 구성해야함 (express-session, connect-mongodb-session, bcryptjs 패키지를 추가해 작업할 예정)
  - 회원가입, 로그인 로직을 구성하고 프로필 내용을 구성할 생각인데, 이 내용은 로그인한 계정이 작성한 게시글의 목록을 볼 수 있도록 할 생각
  - 로그인 했을 때 헤더에 보이는 버튼 수정
    - 로그인 시 게시글, 글쓰기, 프로필, 로그아웃 버튼이 보이도록 수정해야 함
  - 로그아웃 했을 때 헤더에 보이는 버튼 수정
    - 로그아웃 시 게시글, 가입하기, 로그인 이 세 가지 버튼이 보이도록 수정해야 함
  - 게시글 삭제시, 로그인한 이메일의 비밀번호를 확인해 삭제되도록 변경해야함
  - 페이지당 5개의 게시글까지만 보여지도록 해놓았으니, 이제 페이지네이션도 똑같이 한 화면에는 5개까지의 페이지버튼이 보이도록하고, 그 다음 6~10 이런 페이지 버튼은 다음 페이지 버튼을 클릭 시 보이도록 하려고 생각 중 (보류)
  - 한 가지 확인해야 할만한게 수정 페이지에 가게되면 조회수가 1씩 계속 증가되는데 수정하지 않고, 취소해도 증가하는 부분을 확인해봐야함 (이 부분은 로그인 기능을 추가하면 그 ID를 통해서 쿠키나 세션을 사용해 저장하고, 사용자가 클릭 시 조회수가 중복으로 상승하지 않도록 하는 로직을 구상 중)
  - CSS 부분에서 조언을 구해야할 부분
    - input에서 focus 되었을 때 background color 변경 유무
    - navbar 글씨 크기
    - 회원가입, 로그인 UI 그리고 border 또는 box-shadow 사용 유무 어떤게 나은지
    - 회원가입, 로그인에서 a태그로 만든 부분 색 관련 물어보기
    - 회원가입 이름이 적당한지 그냥 가입하기가 맞는지
    - 회원가입, 로그인 label, input 간격이 괜찮은지 물어보기

<br />

# 오늘 느낀 점

- 세션과 쿠키를 추가하면서 mongodb에서 여러 속성들을 볼 수 있었는데 아직은 저 모든 속성을 알 수없지만 천천히 알아가면 된다고 생각이 된다. 현재는 maxAge만 사용하지만 아마 나중에 더 큰 프로젝트는 만들게 된다면 httpOnly, secure, domain 등 여러 속성을 사용하지않을까 생각이 된다. 현재는 저 속성들이 어떤 역할을 하는지 정도만 알고 가면 된다고 생각이 되며, domain 속성을 나중에 배포시 변경해줘야하나 생각했지만 chatgpt에게 물어보니 위에서 설명한 답변이 나와서 현재는 내가 건드릴 수 있는 설정이 아닌 것 같기 때문에 기본으로 놔두는게 맞다고 생각이 된다. 그리고 maxAge는 더 짧게 더 길게 가능하지만, 다른 은행이나 금융기관은 30분~1시간정도 설정한다고 하는데 게시판과 같은 서비스는 보안 요구사항이 상대적으로 낮을 수 있기 때문에 24시간이면 적당하다는 생각이 들었다. 더 짧아도 문제는 없겠지만 현재는 24시간이면 적당하다고 생각이 된다.

- 프로필 페이지는 현재는 사용자 인증에 따른 페이지가 보이도록 설정해놓고 아직 ejs나 세부적인건 구성하지 않았는데 내가 생각한 구성은 인증이 되었을 때 그 인증된 사용자 정보로 작성한 게시글들만 보이도록 하려고 생각하고 있다. 현재는 프로필 페이지는 사용자 인증이 되었는지 확인하는 페이지로 사용되고 있는데 가입하기, 로그인 이 페이지의 사용자 인증 관련 부분이 모두 구성되고 수정된 후에 프로필 페이지를 구성할 생각이다.

- 로그아웃 버튼을 통해 사용자 인증이 해제되며 메인 페이지로 이동되도록 해 프로필 페이지도 볼 수 없고 401 페이지가 뜨도록 되어있는데 이제 여기서 추가해야할 부분은 로그아웃 버튼을 클릭 했을 때 게시글, 가입하기, 로그인 버튼만 보이도록 수정을 해야한다. 물론 로그인 되었을 때의 버튼도 수정을 해주어야하는데 이 부분은 차근차근 수정해 나아갈 생각이다.

<br />

# 내일 할 일

- JS, ExpressJS, MongoDB로 게시판 제작 + (EJS)

<br />

# 앞으로 해야 할 일

- Advanced-js(고급 JS)에 대해 공부하며 이해하기 (JS 공부)

- Python으로 웹 스크래퍼 만들어보기

- Python, PHP 공부할 거 찾아보기

- Python 셀레니움, 브라우저 드라이버에 대해 한번 찾아보기

- Python 데이터 분석도 한번 봐보기
