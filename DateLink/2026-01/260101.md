# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- Zustand 접근 방식 차리
  - React Hook (React 내부)
    - ex) `const { directChatForm } = useDirectChatStore()`
      - `useDirectChatStore()` 내용은 React 컴포넌트 전용으로 렌더링과 연결된 경우 사용
    - 컴포넌트는 React 함수 컴포넌트로, Hook 규칙 충족
      - 최상위에서 호출
      - React 렌더 사이클 안에 있음
  - 렌더링과 무관한 순수 상태 접근 (React 외부)
    - ex) `const { directChatForm } = useDirectChatStore.getState();`
      - `useDirectChatStore.getState()` 내용은 React와 무관한 순수 상태 접근으로 렌더링과 무관
      - Zustand 순수 store 접근 API
    - getState는 현재 상태 스냅샷을 한 번 가져오는 것
    - 구독도 하지 않고, 리렌더링도 하지 않는 상태
    - 내부적으로 store 객체에서 값 꺼냄
    - 컴포넌트가 아니며 커스텀 훅도 아님
    - React가 렌더 컨텍스트를 알 수 없음
    - React 규칙상 Hook 호출 불가
    -
  - 결론
    - React에 걸려 있으면 Hook, React 밖이면 getState 사용
    - 유틸 함수, 서비스 레이어, API 헬퍼에서는 반드시 `getState()` 사용

<br />

- 실시간 통신 애플리케이션 초기 설계, 현재 진행도, 추후 예정 및 여러 내용 정리
  - 초기에 구성하려는 내용과 달라진 내용
    - 초기 구성
      - 회원가입, 로그인
        - 초기에 바로 보이지 않고, 메인 페이지에서 기능을 사용하려고 할 때 로그인 또는 회원가입으로 유도해 진행하는 구조
        - 로그인 페이지와 회원가입 페이지 서로 이동할 수 있는 구조
      - 메인 페이지
        - 비로그인 상태
          - 로그인이 필요하다는 텍스트 메시지 출력
          - 회원가입 또는 로그인 버튼
          - 임의의 버튼 클릭 시 회원가입 또는 로그인 하러가기 모달 출력되는 구조
        - 로그인 상태
          - 다이렉트 메시지로 이동하는 버튼
            - 친구 버튼
              - 전체 친구, 온라인, 친구 대기 목록, 친구 추가
            - 다이렉트 채팅방
              - 1:1 대화를 나눈 상대와 채팅 메시지 출력
          - 참여한 그룹 채팅방으로 이동하는 버튼 목록
          - 새롭게 방을 추가할 수 있는 생성 버튼
      - 그룹 채팅방
        - 사용자를 초대할 수 있는 코드 또는 링크를 발행하는 버튼
          - 코드 또는 링크를 복사해 전달한 뒤 발행한 내용으로 입장하는 구조
        - 그룹 채팅방에 참여한 사용자 목록과 채팅 목록 출력
          - 채팅방에 참여한 사용자는 온라인/오프라인 구분해 출력
      - 프로필, 프로필 수정
        - 프로필 정보와 프로필 수정하는 내용
      - 존재하지 않는 페이지, 권한없는 페이지 (오류 관련 내용)
        - 존재하지 않는 URL 또는 권한이 없는 상태로 URL을 통해 채팅방에 접근할 때 오류 페이지로 리다이렉트
    - 현재 구성
      - 회원가입, 로그인
        - 초기 앱 애플리케이션 접근 시에 바로 로그인 페이지 출력
        - 로그인 페이지에서 회원가입 페이지 이동 또는 반대로 전환할 수 있도록 구성
      - 메인 페이지 (홈 화면)
        - 사이드 바와 친구 버튼, 다이렉트 채팅방 목록 출력
          - 사이드 바는 홈 버튼과 그룹 채팅방 목록, 그룹 채팅방 추가 버튼으로 구성
          - 해당 내용 하단에 사용자 정보가 보여지도록 구성
          - 친구 목록과 다이렉트 채팅방이 전환되어 보여지는 구조로 구성
          - 메인 영역에 친구 관련 버튼 출력
            - 온라인, 사용자, 대기 중, 친구 추가하기 버튼으로 구성
            - 친구 검색할 수 있는 기능 포함
            - 친구 클릭 시에 다이렉트 채팅방 이동 또는 채팅방 생성 후 이동
          - 다이렉트 채팅방 목록
            - 대화를 나눈 모든 다이렉트 채팅방 목록 출력
            - 다이렉트 채팅방 클릭 시 해당 채팅방 이동
            - 메인 영역이 다이렉트 채팅방 내용으로 변경되며 해당 사용자와 나눈 채팅 목록과 입력창, 패널을 출력
            - 사용자 온라인/오프라인 유무 출력
            - 채팅방 목록에서 닫기 버튼을 클릭해 채팅방 보이지 않도록 구성
        - 사용자 정보
          - 아바타와 닉네임 출력
            - 아바타는 아바타 색 또는 아바타 이미지 출력
          - 프로필 수정하는 버튼과 로그아웃 버튼으로 구성
            - 프로필 수정
              - 닉네임과 아바타 수정 가능
              - 아바타는 기본으로 제공되는 색 목록 또는 이미지 URL을 넣어서 이미지 출력 가능
            - 로그아웃 버튼
              - 클릭 시 로그인 페이지로 이동
      - 다이렉트 채팅방
        - 채팅 목록과 채팅 입력창
          - 채팅 목록에서 날짜를 기준으로 나눠서 구분
        - 다이렉트 채팅방 패널
          - 해당 사용자 아바타와 친구 시작일, 같이 아는 친구와 같이 참여한 채팅방 목록 출력
            - 친구가 아닐 경우 친구가 아님을 출력
            - 같이 아는 친구 클릭 시 해당 친구와 관련된 다이렉트 채팅방으로 이동
            - 같이 참여한 채팅방 클릭 시 해당 채팅방으로 이동
          - 아바타는 아바타 색 또는 아바타 이미지 출력
      - 그룹 채팅방
        - 초대 버튼과 온라인/오프라인이 나뉜 사용자 목록
          - 초대 버튼 클릭 시에 초대할 친구 목록 및 검색창 출력
          - 온라인 영역
            - 온라인 상태의 사용자 목록만 출력
            - 온라인 상태의 사용자는 불투명도가 적용되지 않음
          - 오프라인 영역
            - 오프라인 상태의 사용자 목록만 출력
            - 오프라인 상태의 사용자는 불투명도가 적용되어 온라인 사용자 목록보다 희미하게 보임
        - 채팅 목록과 채팅 입력창
          - 채팅 목록에서 날짜를 기준으로 나눠서 구분
        - 다이렉트 채팅방 패널
          - 그룹 채팅방을 생성한 호스트 아바타와 닉네임
            - 호스트 아바타는 아바타 색 또는 아바타 이미지 출력
          - 공지사항, 총 참여자 수와 목록, 그룹 채팅방 생성일 출력
            - 공지사항은 현재 호스트만 수정 및 삭제 가능
            - 공지사항 내용이 길어지면 펼치기와 접기 기능 사용 가능
            - 참여자 목록이 보여지며 온라인/오프라인 유무 출력과 호스트는 왕관 아이콘으로 확실하게 구분
            - 참여자 목록에서 온라인 사용자 목록이 상단에 우선 보여지며, 그 아래로 오프라인 사용자 목록 출력
      - 존재하지 않는 페이지, 권한없는 페이지
        - 존재하지 않는 URL 또는 권한이 없는 상태로 URL을 통해 채팅방에 접근할 때 오류 페이지로 리다이렉트
        - 리다이렉트된 페이지에서 버튼 클릭 시에 홈 화면으로 이동
  - 구성한 내용중 보완해야 할 점
    - 채팅방 입장 시에 이전에 읽었던 채팅 내용이 그대로 유지되는 기능이 약간 불안정하기 때문에 이 부분은 추가 수정 필요
    - 다이렉트 채팅방 목록에서 친구가 아닌 사용자 로그인 시에 온라인/오프라인 유무가 변경되지 않는 내용 추가 수정 필요
    - 그룹 채팅방 우클릭 시에 보여지는 컨텍스트 메뉴 위치와 UI 수정 필요
  - 추가로 구성해야 할 내용
    - 사용자 프로필 관련 내용
      - 구조 및 CSS 추가 필요
    - 다이렉트 채팅방 목록이 정렬될 때 부드럽게 정렬되는 UI 내용
    - 그룹 채팅방 위치 위아래로 자유롭게 변경하는 내용
    - 기본이 다크 모드인데, 라이트 모드를 추가해야 할 지 고민중
      - 해당 내용은 확정이 아니고 고민 단계
    - 화면 투명도 관련 내용
      - Electron을 통해 실행 가능한 프로그램으로 먼저 변환한 뒤 추가하는 것을 고려했으나, 미리 테스트해본 후 변환하는 것도 좋다고 생각되어 추가할 예정
  - 프로젝트 완성한 이후 추가 업데이트할 내용
    - 배포를 우선으로 하고, 테스트를 통해 문제가 없는지 기능 확인 예정
    - Electron을 활용해 바로 실행 가능한 프로그램처럼 만들어줄 예정
      - ex) Visual Studio Code, Discord, Slack, Notion 등
        - 웹 기술 기반 + 설치형 앱
      - 최근 알게된 사실로 Tauri 라는 프레임워크가 Electron을 대체하고 훨씬 가볍고 인기있다는 정보가 있어서 내용을 구성할 때 추가로 찾아볼 예정

# 오늘 느낀 점

- React 내부 또는 외부에서 Zustand에 접근하는 방식에 대해 정리하고, 현재 진행중인 프로젝트 초기 설계는 어떤식으로 했는지, 현재 어떤 내용이 구성되어 있는지, 구성한 내용중에 보완할 점은 없는지, 앞으로 추가해야 할 내용은 무엇이 있는지, 프로젝트를 완성한 후 어떤 내용을 추가로 업데이트할 지 등 여러 내용을 정리했는데 초기에 설계한 내용보다 규모가 좀 더 커진 것 같다는 생각이 들고, 앞으로 추가 및 보완해야 할 내용이 얼마 남지 않았다고 생각했지만 조금 복잡할 수도 있는 내용들이 남은 것 같아서 빠르게 진행을 해야 한다고 생각이 되었다. 그리고 다 완성한 후에 배포하고 바로 실행 가능한 프로그램처럼 만들 예정인데, 프로젝트 초기에 구성할 때는 Electron을 알게 되어 해당 프레임워크로 진행할 예정이었지만, 최근 Electron 대체용으로 훨씬 가볍고 인기 있는 Tauri가 있다는 것을 알게 되어서 나중에 정보를 찾아보고 비교해 진행해볼 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 닉네임 수정과 그룹 채팅방 제목 수정 내용에서 사용하지 않거나 필요없는 정보를 삭제해 코드 정리를 해야 함 (중복된 데이터 전송이나 사용하지 않는 데이터 전송 관련 내용 등)

- 그룹 채팅방에서 다른 사용자를 클릭할 수 있고, 클릭 시에 다이렉트 채팅방이 생성되어 채팅을 나눌 수 있도록 구성하는 것을 고려중 (이 방법 대신, 다른 사용자 클릭 시에 프로필이 보여지도록 구성하고 그 내용을 통해 다이렉트 메시지를 보내거나 프로필 내용을 보는 그런 방식으로 구성해야 함)

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

- 다크 모드 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
