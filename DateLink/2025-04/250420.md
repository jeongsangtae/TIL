# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 다이렉트 채팅방 세부 페이지 인증 관련 내용 삭제 및 채팅 메시지 날짜 변환 내용 추가 및 채팅 메시지 날짜로 구분하는 로직 추가
  - 다이렉트 채팅방 세부 페이지에서 더이상 사용하지 않는 인증 관련 로직을 삭제해 주고, 채팅 메시지 날짜를 출력할 수 있도록 전달하고 해당 내용을 변환해 보여주도록 구성해 주었으며, 채팅 메시지를 날짜별로 구분해 출력할 수 있도록 로직을 추가
  - 프론트엔드
    - DirectChatDetails
      - 사용하지 않는 인증 관련 로직 삭제
    - Chats
      - prevDate 변수
        - 이전 메시지의 날짜를 저장하는 변수
      - dateLineAndMessages 변수
        - messages 내용에 map 함수를 사용
        - 메시지의 날짜에서 년, 월, 일을 추출
          - `const [year, month, day] = message.date.split(" ")[0].split(".")`
        - currentDate 변수
          - 추출한 년, 월, 일을 "2025년 4월 12일"처럼 보이도록 가공
        - showDateLine 변수
          - 이전 메시지 날짜와 현재 메시지 날짜가 다르면 날짜 라인을 보여주도록 구성
          - `const showDateLine = currentDate !== prevDate`
        - 현재 메시지 날짜를 prevDate에 저장해 다른 메시지 비교에 사용하도록 구성
          - `prevDate = currentDate`
        - 반환하는 내용
          - message.\_id를 key로 사용
          - showDateLine을 확인해 true일 때 출력하는 내용
            - 가공된 currentDate 내용이 출력되도록 구성
            - 날짜 구분에 사용되도록 date-line className 추가
          - Chat 컴포넌트에는 그대로 message와 date 내용이 props로 전달되도록 구성
      - JSX 코드 내용 수정
        - message에 map 함수를 사용하는 부분과 Chat 컴포넌트에 내용을 전달하는 부분을 주석 처리하고, dateLineAndMessages 변수 내용이 보여지도록 구성
    - Chat
      - date를 props로 전달받고, date 관련 타입 정의를 추가
      - 전달받은 날짜 관련 내용을 " " 기준으로 날짜와 시간 분리하고, `[0]`를 사용해 날짜 부분만 추출한 뒤에 "." 기준으로 다시 나눠 년, 월, 일로 각각 구조 분해 할당하도록 구성
        - `const [year, month, day] = date.split(" ")[0].split(".")`
      - 구조 분해 할당한 내용에 년, 월, 일을 뒤에 붙이고 출력
    - ChatInput
      - 중복되는 내용 주석 처리 및 콘솔 로그 삭제
  - CSS
    - Chats
      - 구분하는 날짜 내용이 중앙에 오도록 구성
      - 폰트 크기와 색 그리고 마진을 추가해 조정
  - 채팅 메시지가 날짜별로 구분되어 출력되도록 내용을 구성하고 테스트한 결과, ex) 2025년 4월 18일에 추가된 메시지는 18일 부분에서만 보여지고, 19일에 추가된 메시지는 2025년 4월 19일로 구분된 부분에서 보여지는 것을 확인할 수 있었다.
    - 날짜로 구분이 되도록 하는 내용 양옆으로 선을 추가하면 좀 더 확실하게 구분이 되고 UI가 더 좋아질 것 같음
    - 채팅 메시지 옆에 출력되는 날짜가 좀 더 업그레이드 되어 오전/오후 구분이 된 후에 출력되도록 수정해야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/f18aff9041edda02e3d0fdfd3b3c92eae5a02ac5)

<br />

- 채팅 메시지 날짜 출력하는 내용 수정
  - 전달받은 채팅 메시지 날짜 데이터를 날짜와 시간으로 분리하고, 조금 잘라내거나 변환한 뒤에 오전/오후 구분도 되도록 조건부를 추가하고, 해당 데이터를 다시 조합해 출력될 수 있도록 구성
  - 프론트엔드
    - Chats
      - 콘솔 로그 내용 삭제
      - 주석 처리한 내용 삭제
    - Chat
      - props로 전달받은 date 내용에 split을 사용해 " " 기준으로 날짜와 시간을 분리
      - 날짜 부분을 "." 기준으로 년, 월, 일로 분리
      - 시간 부분을 ":" 기준으로 시, 분으로 분리
      - shortYear 변수
        - 년도의 뒷 2자리만 보여지도록 slice 사용
        - `const shortYear = year.slice(2)`
      - numMonth 변수
        - 문자열로 되어 있는 내용을 10진수 숫자로 변환
          - ex) 04 -> 4
        - `const numMonth = parseInt(month, 10)`
      - numDay 변수
        - 문자열로 되어 있는 내용을 10진수 숫자로 변환
        - `const numDay = parseInt(day, 10)`
      - numHour 변수
        - 문자열로 되어 있는 내용을 10진수 숫자로 변환
        - `const numHour = parseInt(hour, 10)`
      - am 변수
        - 오전인지 확인하는 변수
          - 12시 이전이면 오전
        - `const am = numHour < 12`
      - resultHour 변수
        - am이 true일 경우
          - `numHour === 0`를 확인하고 true일 경우
            - 12로 표기
          - `numHour === 0`를 확인하고 false일 경우
            - numHour을 그대로 표기
        - am이 false일 경우
          - `numHour > 12`를 확인하고 true일 경우
            - numHour에 12를 빼서 표기
          - `numHour > 12`를 확인하고 false일 경우
            - 12로 표기
        - 최종적으로 오전일 때 0시는 12로 표기되고 나머지는 그대로 표기하며, 오후일 때는 12~23은 12를 뺴고 표기하고 12는 그대로 12로 표기
      - ampm 변수
        - am을 확인해 true일 때는 오전, false일 때는 오후로 표기
        - `const ampm = am ? "오전" : "오후"`
      - resultDate 변수
        - 자르고, 변환된 날짜 문자열을 다시 조합해 하나의 날짜 데이터로 구성
      - JSX 코드 내용 수정
        - 날짜 부분에서 resultDate 내용이 출력되도록 수정
  - 채팅 메시지 날짜를 그대로 출력하는 것이 아닌, 좀 더 디스코드 스타일처럼 보이도록 날짜 데이터를 자르고 변환해 테스트한 결과, 년도 뒤 2자리와 월, 일이 보여지고 그 다음 저장된 시간에 따라서 오전/오후도 구분되어 출력되는 것을 확인할 수 있었다.
    - 오전/오후는 잘 구분되어 보여지므로, 여기에 어제 기준을 추가해서 어제 추가된 메시지는 날짜가 아닌, ex) 어제 오후 4:33 이런식으로 출력되어 보여지도록 수정해봐야
    - 채팅 메시지 옆이 아닌 아래쪽에 날짜 데이터가 보여지므로, 채팅 메시지 옆에 보여지도록 수정이 필요하고, CSS를 추가해 크기 조절도 필요함
    - 레이아웃 관련 CSS를 추가해 전체적인 CSS 틀을 구성해야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/80634092ebdbf5814831679b6bdb3cc70c5c68e7)

# 오늘 느낀 점

- 채팅 메시지를 저장할 때 날짜 부분에서 년, 월, 일, 시, 분 같은 내용을 포함해 저장하지 않고, 프론트엔드에서 기존의 저장된 채팅 메시지 날짜 데이터를 받아서 가공해 원하는 내용대로 출력될 수 있도록 구성해 주었으며, 날짜별로 구분되어 채팅 메시지가 나뉘어 보이도록 구성한 결과, 이전보다 UI가 좀 더 보기 편해졌다고 생각이 된다. 채팅 메시지 날짜 데이터를 가공해 오전/오후 구분이 잘되어 출력되고 있지만, 여기에 어제 기준을 추가해 어제 추가된 메시지는 어제 오전 이런식으로 보여지면 사용자들이 좀 더 보기 편할 것으로 생각되어 추가할 생각이고, 채팅 메시지 아래가 아닌 옆에 날짜 데이터가 보여지고 CSS를 추가해 크기 조절도 해주면 이전보다 더 보기 편해질 것으로 생각이 된다. 그리고 레이아웃 관련 CSS를 추가해 전체적인 CSS 틀을 먼저 구성하고 그 다음 채팅방 세부 페이지 또는 레이아웃에 포함된 버튼들 CSS를 구성해 줄 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 출력되는 채팅 메시지 목록에 스크롤을 추가해 보기 편하도록 변경해야 하고, 메시지가 언제 추가되었는지 구분할 수 있도록 저장된 날짜 데이터를 불러와 표기해야 함

- 채팅 입력창에 적용된 스크롤 기능 추가 수정 필요

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 삭제 시에 다이렉트 채팅방 삭제 확인 로직 필요 (친구 삭제 시에 다이렉트 채팅방을 그대로 남겨놓고 삭제 확인창은 따로 추가하지 않을 예정)

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 그룹 채팅방 초대하고 알림을 전송하는 기능에서, 로그인한 사용자가 아닌 친구에게 보내는 그런 구조로 작동되도록 수정이 필요 (비로그인 상태여도 상관이 없음 단순하게 친구한테 친구 요청하면 알림 메시지가 전달되어야 함)

- 추가된 친구와 대화를 나눌 수 있는 다이렉트 채팅방 (진행중)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
