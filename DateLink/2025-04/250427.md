# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 그룹 채팅방 컨텍스트 메뉴 전역적 이벤트 관련 내용 추가
  - 그룹 채팅방을 우클릭하면 메뉴창이 열리고, 그 메뉴창을 닫기 위해 그룹 채팅방을 다시 우클릭하면 닫을 수 있는데, 이 때 우클릭을 그룹 채팅방에서 클릭하는 것이 아닌 다른 외부 공간을 클릭하면 메뉴창이 닫히도록 우클릭과 관련된 전역적 이벤트 관련 내용을 추가
  - 프론트엔드
    - GroupChat
      - contextMenuOpenHandler 함수 수정
        - `event.stopPropagation()`를 추가해 우클릭 이벤트가 전역 우클릭 이벤트까지 퍼지지 않도록 막음
      - useEffect 수정
        - contectMenuOutsideClickHandler -> outsideClickHandler로 함수 이름 수정
          - 외부 좌클릭 이벤트로 확실하게 구분
        - outsideContextMenuHandler 함수 추가
          - 외부 우클릭을 감지하는 함수
          - contextMenu의 visible 내용을 확인해 true일 때, 기본 브라우저 이벤트를 방지하고 contextMenuCloseHandler 함수를 실행해 메뉴창을 닫도록 구성
        - 우클릭 이벤트를 전역에 등록
          - `document.addEventListener("contextmenu", outsideContextMenuHandler)`를 추가
          - contextmenu 즉, 우클릭 이벤트가 전역에 등록되도록 구성
        - 컴포넌트가 언마운트되거나 context.visible이 변경되면 contextmenu 내용도 클린업되도록 구성
  - 컨텍스트 메뉴를 여는 우클릭 이벤트가 전역 우클릭 이벤트에 퍼지지 않도록 구성하고, 우클릭 이벤트가 전역적으로 사용될 수 있도록 구성하고 테스트한 결과, 문제없이 작동되어 그룹 채팅방을 우클릭하면 메뉴창이 열리고 그룹 채팅방 외의 외부를 다시 우클릭하면 메뉴창이 닫히는 것을 확인할 수 있었다.
    - 메뉴창이 열리지 않은 상태에서, 우클릭 시에 브라우저 기본 컨텍스트 메뉴가 열리는데 이 기본 동작을 막는 것도 고려를 해봐야 함
    - 아이콘 내용 추가 및 CSS를 구성해야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/2243772d1da38b59b67914cb39406fac3d44c55f)

<br />

- react icons 관련 내용 타입 에러 해결 및 사이드바 홈 버튼 아이콘, CSS 추가 및 사이드바 로그아웃 버튼 아이콘 추가
  - react icons 관련 패키지를 추가하고 컴포넌트 내에서 아이콘을 불러와 구성했지만, 타입 에러가 발생해 이와 관련된 문제를 해결해 주었고, 사이드바 홈 버튼에 사용될 아이콘과 로그아웃에 사용될 아이콘을 추가하고, 사이드바 홈 버튼에 CSS 내용을 추가
  - react icons 타입 에러 해결 방법
    - 타입 에러 발생 원인
      - react-icons 관련 아이콘을 추가하고 사용하면 "JSX 구성 요소를 사용할 수 없습니다. 원래 반환 형식 'ReactNode'은(는) 그렇다면 JSX 요소가 아닙니다. '정의되지 않음' 형식은 '요소 | null' 형식에 할 수 없습니다." 같은 타입 에러가 발생
      - react-icons 라이브러리의 최신 버전인 5.5.0에서 JSX 구성 요소를 제대로 반환되지 않거나 정의되지 않은 값이 반환되는 문제가 발생
    - 해결 방법
      - react-icons 버전을 5.3.0 또는 5.4.0 같은 버전으로 다운 그레이드하면 문제가 해결됨
  - 프론트엔드
    - SideBar
      - BsFillChatSquareFill, LuLogOut 아이콘을 react-icons에서 불러오도록 구성
      - JSX 코드 내용 수정
        - 홈 버튼에 home-button className을 추가
        - 홈 버튼에 텍스트 대신, BsFillChatSquareFill 아이콘을 사용
        - BsFillChatSquareFill 아이콘에 chat-icon className을 추가
        - 홈 버튼 아이콘인 BsFillChatSquareFill 아이콘에 div 추가해 eye, left-eye, right-eye className으로 구성
        - 로그아웃 버튼에 LuLogOut 아이콘을 추가
  - CSS
    - SideBar
      - home-button
        - position을 relative로 구성
        - width, height로 크기 조절
        - transition을 추가해 커서를 올리면 크기가 커지도록 구성
      - chat-icon
        - top을 추가해 위치 조정
        - 폰트 크기 조절
        - position을 relative로 구성
        - z-index를 1로 구성해 eye 내용 뒤에 보이도록 구성
      - eye
        - position을 absolute로 구성
        - top을 추가해 위치 조정
        - width, height로 크기 조절
        - z-index를 2로 구성해 앞에 보이도록 구성
      - left-eye, right-eye
        - 각각 left, right 추가해 위치 조정
  - 홈 버튼과 로그아웃에 추가한 아이콘 내용이 잘 보여지고, 홈 버튼에 구성한 CSS 내용도 잘 적용되어 보여지는 것을 확인할 수 있었다.
    - 홈 버튼에 구성된 CSS 내용이 생각한 것과 조금 달라서 추가로 수정이 필요하고, 아이콘을 추가한 로그아웃 버튼에 대한 CSS 내용도 추가해야 함
    - 그룹 채팅방 세부 페이지, 홈 화면에서 친구 목록 표기와 관련된 CSS 내용 그 외에 여러 CSS 내용을 추가하고 수정해 UI 구성을 해줘야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/c7a8e1adf15dfb24b6223c190a96091aca52dfd3)

# 오늘 느낀 점

- 그룹 채팅방 컨텍스트 메뉴와 관련된 내용은 여기서 마무리를 해도 될 것 같고, 우클릭을 통해 브라우저 기본 컨텍스트 메뉴를 여는 동작에 대해 전역적으로 작동하지 않도록 구성을 하는 부분은 좀 고민을 해보고 결정을 해야 할 것 같다. 우선은 CSS 내용에 집중해 빠르게 전체적인 UI를 잡아야 다른 기능을 더 추가하던지 확실하게 결정이 될 것 같아서, UI와 UX가 불편하지 않도록 CSS 내용을 간단하게라도 빠르게 전체적으로 구성하는 것이 좋을 것으로 생각된다. 홈 버튼 CSS를 조금만 더 수정하고, 그 다음 로그아웃 관련 버튼 그리고 사이드바에서 보여지는 그룹 채팅방 목록 버튼, 친구 목록 관련 버튼에 대해서 우선적으로 CSS 구성을 추가할 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 그룹 채팅방 목록에서 그룹 채팅방 우클릭 시에 수정 또는 삭제 버튼이 보여지고 클릭될 수 있도록 구성해야 함

- 홈으로 이동하는 버튼, 로그아웃 버튼, 그룹 채팅방 버튼 등 여러 버튼들이 텍스트가 아닌 아이콘으로 보여지도록 수정 필요

- 홈으로 이동 시에 친구 버튼과 다이렉트 채팅방 목록이 사이드바 옆으로 보여지고, 친구 버튼 클릭 또는 다이렉트 채팅방 클릭 시에 그 옆으로 해당 내용이 보여지도록 수정 필요

- 그룹 채팅방은 그룹 채팅방에 참여한 사용자 목록이 사이드바 옆으로 보여지고, 그 옆에 채팅 관련 내용이 보여지도록 수정 필요

- 출력되는 채팅 메시지 목록에 스크롤을 추가해 보기 편하도록 변경해야 하고, 메시지가 언제 추가되었는지 구분할 수 있도록 저장된 날짜 데이터를 불러와 표기해야 함

- 채팅 입력창에 적용된 스크롤 기능 추가 수정 필요

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 삭제 시에 다이렉트 채팅방 삭제 확인 로직 필요 (친구 삭제 시에 다이렉트 채팅방을 그대로 남겨놓고 삭제 확인창은 따로 추가하지 않을 예정)

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 그룹 채팅방 초대하고 알림을 전송하는 기능에서, 로그인한 사용자가 아닌 친구에게 보내는 그런 구조로 작동되도록 수정이 필요 (비로그인 상태여도 상관이 없음 단순하게 친구한테 친구 요청하면 알림 메시지가 전달되어야 함)

- 추가된 친구와 대화를 나눌 수 있는 다이렉트 채팅방 (진행중)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
