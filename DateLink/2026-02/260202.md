# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 그룹 채팅방 위치 드래그 밑줄 관련 내용, CSS 추가
  - 그룹 채팅방 목록에서 그룹 채팅방을 드래그해 위치를 변경할 때 옮겨지는 위치에 선이 보여지도록 관련 내용과 CSS를 추가
  - 프론트엔드
    - GroupChats
      - activeIndex useState 추가
        - 초기값은 null로 구성
        - 타입은 number 또는 null로 구성
      - overIndex useState 추가
        - 초기값은 null로 구성
        - 타입은 number 또는 null로 구성
      - dragStartHandler 함수 추가
        - `setActiveIndex(groupChats.findIndex((c) => c._id === event.active.id))`
        - 그룹 채팅방 목록에 findIndex를 사용하고 그룹 채팅방 ID와 event.active.id를 비교해 일치하는 채팅방 인덱스를 찾고 해당 인덱스를 setActiveIndex로 저장
        - 그룹 채팅방 목록에서 드래그가 시작된 채팅방의 ID와 일치하는 채팅방을 찾아서 해당 채팅방 위치를 setActiveIndex를 통해 저장
      - dragOverHandler 함수 추가
        - event.over가 유효한지 확인하는 조건부 추가
        - `setOverIndex(groupChats.findIndex((c) => c._id === event.over!.id))`
        - 그룹 채팅방 목록에 findIndex를 사용하고 그룹 채팅방 ID와 event.over!.id를 비교해 일치하는 채팅방 인덱스를 찾고 해당 인덱스를 setOverIndex로 저장
        - 그룹 채팅방 목록에서 드래그 중인 채팅방이 현재 올라가 있는 대상의 ID와 일치하는 채팅방을 찾아서 해당 채팅방 위치를 setOverIndex를 통해 저장
      - JSX 코드 내용 수정
        - DndContext 내용 수정
          - onDragStart props 추가
            - dragStartHandler로 구성
          - onDragOver props 추가
            - dragOverHandler로 구성
        - SortableContext 내용 수정
          - SortableGroupChat 컴포넌트에 activeIndex, overIndex props 전달
    - SortableGroupChat
      - activeIndex, overIndex props를 전달받도록 구성
      - useSortable 라이브러리에서 isOver를 추가로 불러오도록 구성
      - showTopLine 변수 추가
        ```
        const showTopLine =
          isOver &&
          activeIndex !== null &&
          overIndex !== null &&
          activeIndex > overIndex
        ```
        - 채팅방 위에 드래그 중인 아이템이 올라가 있고, 드래그를 시작한 채팅방의 위치가 현재 대상보다 아래쪽에 있었다면 해당 채팅방의 위쪽에 이동 표시선 출력
          - 채팅방을 드래그해 위로 올릴 때 겹친 다른 채팅방이 아래로 내려가며 위에 선이 보여짐
        - isOver는 현재 드래그 중인 아이템이 해당 요소 위에 올라가 있는 상태인지 확인하는 내용
        - activeIndex는 드래그를 시작한 채팅방의 인덱스
        - overIndex는 드래그 중 현재 겹쳐 있는 채팅방의 인덱스
        - `activeIndex > overIndex`는 아래에 있던 아이템을 위로 끌어올리는 중
      - showBottomLine 변수 추가
        ```
        const showTopLine =
          isOver &&
          activeIndex !== null &&
          overIndex !== null &&
          activeIndex < overIndex
        ```
        - 채팅방 위에 드래그 중인 아이템이 올라가 있고, 드래그를 시작한 채팅방의 위치가 현재 대상보다 위쪽에 있었다면 해당 채팅방의 아래쪽에 이동 표시선 출력
          - 채팅방을 드래그해 아래로 내릴 때 겹친 다른 채팅방이 위로 올라가며 아래에 선이 보여짐
        - isOver는 현재 드래그 중인 아이템이 해당 요소 위에 올라가 있는 상태인지 확인하는 내용
        - activeIndex는 드래그를 시작한 채팅방의 인덱스
        - overIndex는 드래그 중 현재 겹쳐 있는 채팅방의 인덱스
        - `activeIndex < overIndex`는 위에 있던 아이템을 아래로 끌어내리는 중
      - JSX 코드 내용 수정
        - 전체를 감싸는 div에 className 추가
          - item으로 구성
        - showTopLine을 조건부로 구성해 일치하면 그룹 채팅방 위에 선이 보여지도록 구성
          - div로 구성하고 insert-line-top className 추가
        - showBottomLine을 조건부로 구성해 일치하면 그룹 채팅방 아래에 선이 보여지도록 구성
          - div로 구성하고 insert-line-bottom className 추가
        - 이 외에 테스트를 위해 추가했던 내용 주석 처리
  - CSS
    - GroupChat
      - dragging
        - opacity를 0.5로 구성
    - SortableGroupChat
      - item
        - position을 relative로 구성
      - insert-line-top
        - position을 absolute로 구성
        - left, right는 2px로 구성
        - top은 -8px, height는 4px로 구성
        - 배경색은 초록색으로 구성
        - 포인트 이벤트는 none으로 구성
      - insert-line-bottom
        - position을 absolute로 구성
        - left, right는 2px로 구성
        - bottom은 -8px, height는 4px로 구성
        - 배경색은 초록색으로 구성
        - 포인트 이벤트는 none으로 구성
  - 그룹 채팅방 목록에서 그룹 채팅방을 드래그해 위치를 변경하면 겹치는 다른 채팅방이 위 또는 아래로 이동하며 해당 위치에 맞게 선이 보여지도록 내용을 추가해 확인한 결과, 드래그한 채팅방을 위로 이동하면 겹친 채팅방이 아래로 내려가며 겹친 채팅방 위에 선이 보여지고, 반대로 아래로 이동하면 겹친 채팅방이 위로 이동하며 겹친 채팅방 아래에 선이 보여지는 것을 확인할 수 있었다.
    - 그룹 채팅방 드래그 시에 옮겨가는 위치에 따라서 선이 보여지는 내용은 문제가 없지만, 드래그해 옮기는 채팅방이 완전히 해당 위치에 이동하기 전에 겹친 채팅방이 드래그하는 채팅방 위치로 이동하고 있기 때문에 해당 내용을 수정해, 미리 이동하지 않도록 구성해봐야 함
    - 그룹 채팅방 목록 변경 시 관련 내용을 저장하지 않아 새로고침 시에 초기화되기 때문에 해당 내용 추가 수정 필요
    - 다이렉트 채팅방 목록, 그룹 채팅방 내의 사용자 목록, 사용자 정보가 보여지는 아바타 내용에서 테두리 두께 설정 확인 필요
    - 로그인, 회원가입 페이지 배경에 사용되는 여러 이미지를 더 추가해 테스트해봐야 함
    - 해야 할 일에 정리된 내용 처리 필요
    - 다이렉트 채팅방 순서가 변경될 때 부드럽게 변경되는 기능
    - 그룹 채팅방 우클릭 시에 보여지는 컨텍스트 메뉴 CSS 수정 필요 (위치, UI 등)
    - 다크 모드 및 라이트 모드 관련 내용
    - 화면 투명도 관련 내용
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/b365b2406e660e3df6c54d5301dcdf26b6836640)

# 오늘 느낀 점

- 그룹 채팅방 목록에서 그룹 채팅방 드래그해 위아래로 이동하면 겹친 채팅방이 이동하는데, 이 때 이동하는 위치에 따라 겹친 채팅방 위아래에 선이 보여지도록 구성을 해준 내용이 문제없이 보여지는 것을 확인했다. 선 관련 내용은 문제가 없지만 드래그한 채팅방이 이동하며 겹친 채팅방 위치로 완전히 들어가기전에 겹친 채팅방이 먼저 드래그한 채팅방 위치로 이동하고 있기 때문에 해당 내용을 수정해, 드래그 시작 시에 드래그한 채팅방 공간에 바로 겹친 채팅방이 들어오지 않으며 완전히 겹친 채팅방 위치로 이동하면 그 때 겹친 채팅방이 이동하도록 수정을 해볼 생각이며, 채팅방을 드래그해 다른 채팅방과 겹칠 때 드래그하는 채팅방이 겹친 채팅방 뒤쪽에 위치해 이동하며 가려지고 있으므로 드래그하는 채팅방이 이동하면 겹친 채팅방 앞쪽에 위치해 이동할 수 있도록 수정해볼 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 닉네임 수정과 그룹 채팅방 제목 수정 내용에서 사용하지 않거나 필요없는 정보를 삭제해 코드 정리를 해야 함 (중복된 데이터 전송이나 사용하지 않는 데이터 전송 관련 내용 등)

- 그룹 채팅방에서 다른 사용자를 클릭할 수 있고, 클릭 시에 다이렉트 채팅방이 생성되어 채팅을 나눌 수 있도록 구성하는 것을 고려중 (이 방법 대신, 다른 사용자 클릭 시에 프로필이 보여지도록 구성하고 그 내용을 통해 다이렉트 메시지를 보내거나 프로필 내용을 보는 그런 방식으로 구성해야 함)

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

- 다크 모드 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
