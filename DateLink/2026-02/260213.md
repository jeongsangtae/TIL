# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 재정렬 그룹 채팅방 목록 액션 관련 내용 삭제 및 그룹 채팅방 관련 POST, DELETE 라우터 수정 및 코드 정리
  - 재정렬 그룹 채팅방 목록 액션 내용을 삭제해 정리하고, 사용자 컬렉션 내의 그룹 채팅방 순서 항목이 그룹 채팅방 생성과 삭제 시에 바로 업데이트되도록 관련 라우터를 수정하고 여러 콘솔 로그나 주석 처리된 내용 삭제
  - 백엔드
    - group-chat-routes
      - 그룹 채팅방 추가하는 POST 라우터 수정
        - result 변수 추가
          - groupChats 컬렉션에 새로운 채팅방을 추가하는 내용이 바로 실행되지 않고 result 변수로 사용되도록 구성
        - result 변수 데이터를 확인하는 콘솔 로그 추가
        - groupChatId 변수 추가
          - `result.insertedId`를 통해 ObjectId 형식으로 된 그룹 채팅방 ID를 가져오고, toString을 추가해 문자열로 변환
        - users 컬렉션 내의 groupChatOrder 항목을 업데이트하는 내용 추가
          - users 컬렉션에 저장된 \_id와 로그인한 사용자 \_id를 비교해 일치하는 사용자를 찾고, `$push`를 통해 groupChatOrder 배열의 마지막에 그룹 채팅방 ID를 추가하도록 구성
            - `$push: { groupChatOrder: groupChatId }`
      - 그룹 채팅방 삭제하는 DELETE 라우터 수정
        - 로그인한 사용자 정보를 가져오는 othersData 변수 추가
          - othersData 변수가 유효한지 확인하는 조건부 추가
        - roomId 데이터를 확인하는 콘솔 로그 추가
        - users 컬렉션 내의 groupChatOrder 항목을 업데이트하는 내용 추가
          - 그룹 채팅방 내의 users 배열에 저장된 사용자 ID들을 ObjectId로 변환한 뒤, `$in`을 사용해 해당 ID를 가진 사용자들을 조회하도록 구성
            - `_id: { $in: groupChat.users.map((id) => new ObjectId(id)) }`
          - `$pull`을 사용해 groupChatOrder 배열에서 문자열로 변경된 방 번호와 일치하는 요소를 찾아 배열에서 제거하도록 구성
            - `$pull: { groupChatOrder: roomId.toString()`
  - 프론트엔드
    - chatStore
      - userProfileDirectSendMessage 액션 수정
        - resData를 확인하는 콘솔 로그 삭제
    - groupChatStore
      - GroupChatStore 타입 정의 수정
        - reorderGroupChats 액션 관련 타입 삭제
      - reorderGroupChats 액션 삭제
      - getGroupChatUsers 액션 수정
        - resData를 확인하는 콘솔 로그 삭제
    - GroupChats
      - reorderGroupChats 액션 불러오는 내용 삭제
      - 사용자 정보 확인하는 콘솔 로그 삭제
      - sortedGroupChats useMemo 수정
        - 주석 처리한 내용 삭제
      - dragEndHandler 함수 수정
        - reorderGroupChats 액션 관련 내용 삭제
      - JSX 코드 내용 수정
        - 주석 처리된 groupChats.map 내용 삭제
  - 주석 처리한 재정렬 그룹 채팅방 목록 액션 내용을 삭제하면서 해당 내용과 관련된 내용도 모두 삭제해 정리하고, 사용자 컬렉션 내의 그룹 채팅방 순서 항목이 그룹 채팅방 생성 또는 삭제 시에 업데이트될 수 있도록 관련 라우터를 수정해 확인한 결과, 재정렬 그룹 채팅방 목록 액션 관련 내용은 모두 정리된 것을 확인했고, 그룹 채팅방 생성 시에 사용자 컬렉션 내의 그룹 채팅방 순서 항목은 바로 업데이트되는 것을 확인했지만, 삭제와 관련된 내용은 삭제한 사용자만이 아닌 함께 그룹 채팅방에 참여한 사용자 컬렉션 내의 그룹 채팅방 순서 항목까지 모두 삭제하는 것을 확인해야 하는데 이 때, 사용자 정보에 그룹 채팅방 순서 항목이 없을 경우 에러가 발생하면서 제대로 테스트해보지 못했기 때문에 수정 후 다시 테스트해봐야 한다.
    - 그룹 채팅방 추가는 테스트를 완료했고, 삭제 관련 내용은 중간에 오류로 인해 제대로 테스트해보지 못한 상태이기 때문에 추가 수정 후 테스트 필요
    - 사용자 정보에 저장된 그룹 채팅방 순서 내용이 없을 때 발생하는 오류 수정 필요
    - 그룹 채팅방 나가기 또는 초대 수락 시, 사용자 정보에 저장된 그룹 채팅방 순서 내용 업데이트 필요
    - 다이렉트 채팅방 목록, 그룹 채팅방 내의 사용자 목록, 사용자 정보가 보여지는 아바타 내용에서 테두리 두께 설정 확인 필요
    - 로그인, 회원가입 페이지 배경에 사용되는 여러 이미지를 더 추가해 테스트해봐야 함
    - 해야 할 일에 정리된 내용 처리 필요
    - 다이렉트 채팅방 순서가 변경될 때 부드럽게 변경되는 기능
    - 그룹 채팅방 우클릭 시에 보여지는 컨텍스트 메뉴 CSS 수정 필요 (위치, UI 등)
    - 다크 모드 및 라이트 모드 관련 내용
    - 화면 투명도 관련 내용
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/a955daef90b01c769f602fc28a5502a3fc88d757)

# 오늘 느낀 점

- 재정렬 그룹 채팅방 목록 액션을 삭제하면서 그와 관련된 내용도 모두 삭제해주었고, 사용자 컬렉션 내의 그룹 채팅방 순서 항목이 그룹 채팅방 생성 또는 삭제 시에 업데이트되도록 구성을 해주었는데, 생성과 관련된 내용에서는 문제가 없었지만 삭제와 관련된 내용에서는 그룹 채팅방에 참여한 다른 사용자 정보도 함께 확인하려한 순간 에러로 인해 제대로 테스트를 진행하지 못했기 때문에 추가 수정을 하고 다시 테스트해볼 생각이다. 사용자 컬렉션 내의 그룹 채팅방 순서 내용이 없을 경우 발생하는 오류를 해결하면, 그룹 채팅방 나가기 또는 초대 수락으로 새롭게 참여했을 때 사용자 컬렉션 내의 그룹 채팅방 순서 내용이 바로 업데이트되어 프론트엔드와 백엔드 내용이 일치할 수 있도록 구성해줄 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 닉네임 수정과 그룹 채팅방 제목 수정 내용에서 사용하지 않거나 필요없는 정보를 삭제해 코드 정리를 해야 함 (중복된 데이터 전송이나 사용하지 않는 데이터 전송 관련 내용 등)

- 그룹 채팅방에서 다른 사용자를 클릭할 수 있고, 클릭 시에 다이렉트 채팅방이 생성되어 채팅을 나눌 수 있도록 구성하는 것을 고려중 (이 방법 대신, 다른 사용자 클릭 시에 프로필이 보여지도록 구성하고 그 내용을 통해 다이렉트 메시지를 보내거나 프로필 내용을 보는 그런 방식으로 구성해야 함)

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

- 다크 모드 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
