# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 그룹 채팅방 순서 길이 관련 에러 수정 및 그룹 채팅방 나가기, 초대 수락 라우터 수정
  - 그룹 채팅방 순서 길이와 관련된 에러가 발생해 해당 문제를 해결하고, 그룹 채팅방 나가기 또는 초대 수락으로 들어왔을 때 사용자 컬렉션 내의 그룹 채팅방 순서 항목이 업데이트되도록 나가기와 초대 수락 라우터 수정
  - 백엔드
    - group-chat-routes
      - 그룹 채팅방 생성하는 POST 라우터, 삭제하는 DELETE 라우터 수정
        - 콘솔 로그 내용 삭제
      - 그룹 채팅방 나가는 DELETE 라우터 수정
        - users 컬렉션 내의 groupChatOrder 항목을 업데이트하는 내용 추가
          - users 컬렉션에 저장된 \_id와 로그인한 사용자 \_id를 비교해 일치하는 사용자를 찾고, `$pull`을 사용해 groupChatOrder 배열에서 문자열로 변환된 방 번호와 일치하는 요소를 찾아 배열에서 제거하도록 구성
            - `{ $pull: { groupChatOrder: roomId.toString() } }`
      - 그룹 채팅방 초대 수락하는 POST 라우터 수정
        - users 컬렉션 내의 groupChatOrder 항목을 업데이트하는 내용 추가
          - users 컬렉션에 저장된 \_id와 로그인한 사용자 \_id를 비교해 일치하는 사용자를 찾고, `$addToSet`을 사용해 groupChatOrder 배열의 마지막에 그룹 채팅방 ID를 추가하도록 구성
            - `$addToSet`를 사용하면 자동으로 중복 방지 가능
            - `{ $addToSet: { groupChatOrder: groupChatId } }`
  - 프론트엔드
    - GroupChats
      - sortedGroupChats useMemo 수정
        - order 변수 추가
          - `userInfo?.groupChatOrder`가 null 또는 undefined일 때 빈 배열이 사용되도록 구성
        - order 길이를 확인하는 조건부 추가
          - order 길이가 0일 경우 !로 인해 true로 적용되어 `return groupChats` 실행
          - order 길이가 0이 아닐 경우 !로 인해 false로 적용되어 해당 조건부를 통과해 그 뒤 내용 실행
        - orderMap 변수 수정
          - new Map에 사용하는 `userInfo.groupChatOrder` 대신 order 변수가 사용되도록 수정
  - 그룹 채팅방 순서가 사용자 정보에 없을 경우 에러가 발생하면서 전체 내용이 보이지 않기 때문에 해당 에러를 해결하기 위해 조건부를 수정하고, 그룹 채팅방 나가기 또는 초대 수락으로 들어갈 경우 사용자 정보 내의 그룹 채팅방 순서 내용이 업데이트되도록 백엔드 내용을 수정해 확인한 결과, 사용자 정보에 그룹 채팅방 순서 내용이 없어도 더이상 에러가 발생하지 않는 것을 확인했고, 그룹 채팅방 나가기 또는 초대 수락으로 들어갔을 때 사용자 정보 내의 그룹 채팅방 순서 내용이 바로 업데이트되어 추가되거나 삭제되는 것을 확인할 수 있었다.
    - 다이렉트 채팅방 목록, 그룹 채팅방 내의 사용자 목록, 사용자 정보가 보여지는 아바타 내용에서 테두리 두께 설정 확인 필요
    - 로그인, 회원가입 페이지 배경에 사용되는 여러 이미지를 더 추가해 테스트해봐야 함
    - 해야 할 일에 정리된 내용 처리 필요
    - 다이렉트 채팅방 순서가 변경될 때 부드럽게 변경되는 기능
    - 그룹 채팅방 우클릭 시에 보여지는 컨텍스트 메뉴 CSS 수정 필요 (위치, UI 등)
    - 다크 모드 및 라이트 모드 관련 내용
    - 화면 투명도 관련 내용
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/53b38e0691a76bd7ff2954005df3b257cf211a6f)

# 오늘 느낀 점

- 그룹 채팅방 순서 내용이 사용자 정보에 없을 경우 발생하는 에러도 해결하고, 그룹 채팅방 나가기 또는 초대 수락으로 들어갈 경우 사용자 정보 내의 그룹 채팅방 순서 내용이 업데이트되도록 하는 내용 또한 모두 구성되어 이제 그룹 채팅방 생성, 초대 수락으로 들어가기, 삭제, 나가기 동작을 통해 그룹 채팅방 순서 내용이 바로 업데이트되어 프론트엔드에서 보여지는 내용과 일치하는 것을 확인할 수 있었다. 그룹 채팅방 드래그와 드롭 기능을 통해 순서가 변경되고, 해당 내용이 저장되어 실시간 동기화되는 내용까지 모두 구성되었기 때문에 더이상 추가 수정은 필요없을 것으로 생각이 되며, 테스트하면서 약간 문제가 있는 기능을 발견했는데 그룹 채팅방 우클릭 시에 보여지는 컨텍스트 메뉴 위치가 클릭한 위치보다 훨씬 아래에서 보여지고 있는 문제를 발견해서 이 내용부터 수정할 생각이고, 그 다음 여러 내용에서 보여지는 아바타 테두리 두께를 수정해 자연스럽게 보이도록 해줄 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 닉네임 수정과 그룹 채팅방 제목 수정 내용에서 사용하지 않거나 필요없는 정보를 삭제해 코드 정리를 해야 함 (중복된 데이터 전송이나 사용하지 않는 데이터 전송 관련 내용 등)

- 그룹 채팅방에서 다른 사용자를 클릭할 수 있고, 클릭 시에 다이렉트 채팅방이 생성되어 채팅을 나눌 수 있도록 구성하는 것을 고려중 (이 방법 대신, 다른 사용자 클릭 시에 프로필이 보여지도록 구성하고 그 내용을 통해 다이렉트 메시지를 보내거나 프로필 내용을 보는 그런 방식으로 구성해야 함)

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

- 다크 모드 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
