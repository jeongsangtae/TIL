# 오늘 한 일

### JS 토이 프로젝트 제작 (JS, ExpressJS, MongoDB로 만드는 게시판 + EJS)

- 게시판 제작 진행 과정

  - 사용자 본인이 쓴 게시글이 아닌 다른 게시글에 대해서 수정, 삭제 버튼을 클릭 시 모달창이 뜨며 권한이 없다는 경고창을 표시하도록 함
    - 수정을 담당하는 라우터와 삭제를 담당하는 라우터 모두 같은 post-content라는 ejs파일을 렌더링하고 있기 때문에 에러메시지를 함께 포함시켜주었다.
    - 수정을 담당하는 라우터에서는 수정 관련 에러 메시지는 텍스트를 넣어주고, 삭제 관련 메시지는 빈 문자열로 넣어주었다.
    - 반대로 삭제를 담당하는 라우터는 삭제 관련 에러 메시지는 텍스트를 넣어주고, 수정 관련 메시지는 빈 텍스트를 넣어주었다.
    - 게시글 내용을 보여주는 페이지에서 로그인이 되어있지 않을 때 목록 버튼을 제외한 수정, 삭제 버튼을 클릭 시 401페이지로 이동하도록 해주었다. 로그인이 되어있지 않아도 게시글은 볼 수 있도록 하는게 맞다고 생각이 되었고 수정, 삭제는 당연히 불가능하지만 권한 자체도 없기 때문에 인증되지 않음으로 판단해 401 페이지로 이동
    - 게시글 내용을 보여주는 페이지에서 수정 관련 에러 메시지와 삭제 관련 에러 메시지 모달창을 추가해주었는데 모달창 UI는 똑같고, 텍스트만 바꿔주었다.
    - 스크립트 파일인 js파일을 한 곳으로 모아서 이벤트리스너를 추가해놓으니 하나만 작동하고 나머지는 작동하지않아서 따로 스크립트 파일을 분리해주니 정상적으로 작동함
  - 모달창을 담당하는 CSS는 따로 만들어서 modal.css로 다른 곳에서도 사용할 수 있게 함

  <br />

- 게시판 제작 진행 다음 목표

  - 본인이 작성한 게시글만 수정, 삭제할 수 있게 해야함 + 게시글 수정 및 삭제시 로그인한 이메일의 비밀번호를 확인해 삭제되도록 변경해야함
    - 이 부분은 게시글에 사용자의 정보를 저장할 때 패스워드도 저장하면 생각보다 간단하게 수정, 삭제 문제를 해결할 수 있을 거 같다는 생각이 드는데, 보안의 문제가 있기 때문에 사용자의 `_id`가 저장되어 있기 때문에 그 `_id`를 확인해 비밀번호를 비교해 해당 비밀번호가 맞을 때 수정, 삭제되도록 하는 방법도 생각중
  - 페이지당 5개의 게시글까지만 보여지도록 해놓았으니, 이제 페이지네이션도 똑같이 한 화면에는 5개까지의 페이지버튼이 보이도록하고, 그 다음 6~10 이런 페이지 버튼은 다음 페이지 버튼을 클릭 시 보이도록 하려고 생각 중 (보류)
  - 한 가지 확인해야 할만한게 수정 페이지에 가게되면 조회수가 1씩 계속 증가되는데 수정하지 않고, 취소해도 증가하는 부분을 확인해봐야함 (이 부분은 로그인 기능을 추가하면 그 ID를 통해서 쿠키나 세션을 사용해 저장하고, 사용자가 클릭 시 조회수가 중복으로 상승하지 않도록 하는 로직을 구상 중)
  - CSS + UX 부분에서 조언을 구해야할 부분
    - input에서 focus 되었을 때 background color 변경 유무
    - navbar 글씨 크기
    - 회원가입, 로그인 UI 그리고 border 또는 box-shadow 사용 유무 어떤게 나은지
    - 회원가입, 로그인에서 a태그로 만든 부분 색 관련 물어보기
    - 회원가입 이름이 적당한지 그냥 가입하기가 맞는지
    - 회원가입, 로그인 label, input 간격이 괜찮은지 물어보기
    - 회원가입, 로그인 하러가기 버튼이 괜찮은지 좀 변경이 필요한지
    - 글 작성 페이지나 보여지는 페이지에서 글쓴이가 괜찮은지 작성자가 더 나아보이기도 하기 때문에 물어보기
    - 게시글 목록에서 등록 버튼이 사용자 인증이 되지 않았을 때 존재 하지않으면서 원천적으로 차단,사용자 인증이 되든 안되든 등록 버튼이 존재하고 사용자 인증 유무에 따라 이동하는 페이지가 다르게 구성 두 가지 중 고민좀 해봐야함
  - 새로운 문제를 발견했는데 로그인 상태에서 글쓰기 페이지를 들어간 상태로 로그아웃을 하고 뒤로가기 버튼으로 다시가면 문제없이 글쓰기 페이지로 이동되는 문제를 발견
    - 확인해본 결과 글쓰기 페이지로 이동은 되지만 거기서 게시글을 생성해도 생성되지않고, 페이지 오류가 뜨면서 막히긴 하지만 그 이후에 다시 게시글 목록 페이지나 다른 페이지도 보여지지않고 페이지 오류가 뜨는 문제를 수정해야한다.
    - 로컬에서 테스트를 해서 계속 페이지 오류가 뜨는건지 이 부분은 확실하게 모르겠는데 이 부분은 좀 찾아볼 필요가 있다.
    - js파일을 다시 저장하면 페이지 오류 문제는 해결된다.
  - 문제가 하나 있는데 비밀번호를 확인하고 일치했을 때 게시글이 생성되는 것은 좋은데 그 비밀번호를 저장하는게 사용자의 비밀번호를 그대로 저장을 하고 있기 때문에 이 부분을 변경해야 함
    - 방법1 해싱된 상태의 비밀번호가 저장이 되도록 한다. (현재는 이 방법으로 구성)
    - 방법2 비밀번호는 게시글에 저장하지 않도록 한다. (테스트는 해봄)
  - 패스워드, 수정, 삭제 에러 관련 동작에서 모달창이 뜨고 그 모달창을 닫는 이벤트리스너가 콘솔에서 에러를 발생시키는데 이 부분을 해결해야한다.
    - 방법1 모달창을 없애고, p태그로 텍스트 표기로 대체한다.
    - 방법2 패스워드 부분은 p태그로 표기하고 수정, 삭제는 본인이 쓴 게시글이 아니면 버튼이 안보이도록 한다.
    - 방법3 user, post를 ejs로 보내서 ejs에서 if문으로 확인하고 처리해서 거기서 이벤트 동작 시도 해본다.(이건 테스트를 해보아야 함)
  - 수정, 삭제 권한이 없으면 아이에 가능하지 않도록 했으니 이제 수정에서 데이터를 변경할 때 입력한 비밀번호와 해싱한 비밀번호를 확인하는 로직을 추가해야 함
  - 삭제할 때 비밀번호 확인이 필요한가...? 좀 고민해봐야 함 애초에 권한 유무로 삭제하기 때문에 굳이 라는 생각도 들기 때문에 좀 의견을 물어볼 필요가 있음

<br />

# 오늘 느낀 점

- 본인이 작성하지 않은 게시글의 수정, 삭제를 막아놓았는데 이 부분에서 이벤트리스너에 대해 페이지를 로드할 때부터 스크립트가 동작해 콘솔에서 null 에러가 뜨는데 사실 동작에 문제는 없어서 일단은 그냥 두었다. 저 에러를 고치기위해서 script위치, id확인, DOMContentLoaded 사용 다 해보았으나 고쳐지지않아서 아마 내 생각이지만 라우터에서 이미 게시글 이메일과 로그인한 사용자의 이메일을 확인해서 에러 메시지를 보내면서 이벤트리스너가 작동해서 저런 에러가 발생하는거 아닌가 하는 생각도 드는데 좀 더 확인이 필요해보인다. 근데 다시 확인해보니 이벤트리스너에서만 문제가 있는거 같아서 다른 방법을 생각해봐야할 것 같다. 차라리 signup, login에서 했던것처럼 아래 한줄로 텍스트로만 표기하면 저런 script로 인한 문제가 없기 때문에 문제가 없는데 이벤트리스너로 인해 콘솔창에서 에러가 발생하는게 너무 불편하다고 생각이 된다. 또 다른 방법으로 user, post를 ejs로 보내서 ejs에서 if문으로 확인하고 처리해서 거기서 이벤트 동작을 하는 것도 생각해보고 있다. 아니면 아이에 본인이 작성한 게시글이 아니면 수정, 삭제 버튼이 없도록 하는 것도 괜찮을 거 같다고 생각이 된다.

- 내일은 테스트 해봐야할 부분도 많고, 체크해봐야할 부분도 많기 때문에 부지런히 코드를 짜야한다고 생각된다. 패스워드, 수정, 삭제 에러 처리 관련 테스트와 체크를 해봐야하고 그 다음으로 수정 권한이 있을 때 데이터를 수정시 비밀번호를 입력한 비밀번호와 해싱된 비밀번호를 확인하는 로직을 추가해야한다. 삭제할 때 비밀번호를 확인하는 부분이 필요한지는 좀 고민이 필요하다고 생각된다.

<br />

# 내일 할 일

- JS, ExpressJS, MongoDB로 게시판 제작 + (EJS)

<br />

# 앞으로 해야 할 일

- Advanced-js(고급 JS)에 대해 공부하며 이해하기 (JS 공부)

- Python으로 웹 스크래퍼 만들어보기

- Python, PHP 공부할 거 찾아보기

- Python 셀레니움, 브라우저 드라이버에 대해 한번 찾아보기

- Python 데이터 분석도 한번 봐보기
