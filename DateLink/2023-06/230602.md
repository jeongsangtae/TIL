# 오늘 한 일

### JS 토이 프로젝트 제작 (JS, ExpressJS, MongoDB로 만드는 게시판 + EJS)

- 게시판 제작 진행 과정

  - 답글 기능의 수정, 삭제 추가
    - 답글 기능에서 수정, 삭제 부분도 추가를 해주었는데 기존에 댓글 기능에서 수정, 삭제를 만들었던 내용을 참고해서 수정 부분에서 댓글에서 commentId를 가져오는 부분은 replyId로 바꿔주고, 댓글에서와 같이 postId는 동일하게 가져와준다. 여기서 수정 후 리다이렉트할때 해당 게시글의 id를 확인해서 돌아가야하기 때문에 꼭 필요하다.
    - 그 뒤의 코드는 input hidden으로 가져온 replyId를 replies 컬렉션의 _id와 비교해서 확인한다. 그 전에 먼저 replyId를 가져온 것을 new ObjectId로 변환해주고, try-catch문으로 존재하는지 확인해준다.
    - 그 다음으로 입력된 content 내용을 가져오고 거기서 추가로 입력한 부분을 다시 updateOne을 사용해서 데이터를 수정해준다.
    - 삭제 부분도 많이 유사한데 수정 부분과 동일하게 postId, replyId를 가져오는데 여기서 postId는 url로 가져오고, replyId는 input hidden으로 가져오게 된다. 여기서도 try-catch문으로 답글이 존재하는지 확인하면서 new ObjectId로 변환해주고, 그 다음에 findOne으로 찾아준 다음에 해당 데이터를 삭제하도록 해주었다.
    - ejs에서도 기존에 사용하던 코드를 가져와서 조금씩 수정해주었는데 router.post와 연결하기 위해 form action에서 조금씩 변경해 연결해주고, input hidden으로 reply._id도 보내주면서 라우터에서 사용할 수 있게 해주었다.
    - 그리고 수정 부분에서도 기존에 댓글 부분에서 해줬던 것과 마찬가지로 수정 내용을 입력하고 취소했을 때 다시 원래의 수정 내용으로 나오도록 해주었다. 수정과 삭제 모두 사용자 인증이 되고 본인이 쓴 답글만 삭제가 될 수 있도록 해줌
    - 수정 버튼을 클릭했을 때 입력할 수 있는 창이 뜨는 것처럼 보이도록 display:block을 주는 스크립트도 추가해주었고, 취소를 클릭했을 때 창이 닫힌 것처럼 보이도록 display:none을 다시 주도록 해주었다.

  <br />

- 게시판 제작 진행 다음 목표

  - 댓글 기능
    - 답글쓰는 부분 기능 추가 현재는 답글 추가 됨
    - 수정 부분도 해결은 함 근데 여기서 추가해야할 부분이 있는데 빈 문자열일 때 저장이 된다는 점인데 이 부분을 스크립트 처리로 해줘야할 것 같음
    - 답글의 수정, 삭제도 다 처리를 해주었다.
    - 이제 몇가지 확인과 자잘한 부분을 추가해주면 된다.
      - 댓글 추가와 수정, 그리고 답글 추가, 수정에서 빈 공백으로 제출이 된다는 점인데 이렇게 추가되지않도록 해줄 필요가 있다.
      - 그리고 댓글 답글 입력부분에서 shift+enter로 다음 줄로 바꿔서 입력해도 저장하고 화면에 보이는게 다음 줄로 내려와서 보이는게 아니라 띄어쓰기한 상태로 보이기 때문에 이 부분도 수정이 필요하다.
      - 게시글이 삭제될때 댓글은 함께 데이터도 삭제가 되도록 되어있는데 답글도 함께 삭제가 되도록 해줘야할 것 같다.
      - 추가로 댓글이 삭제된다면 답글도 함께 삭제되도록 하는 부분도 추가를 해줘야할 것 같다.
  - 구성은 되어있는데 혹시나 수정할 수도 있는 부분
    - 문제가 하나 있는데 비밀번호를 확인하고 일치했을 때 게시글이 생성되는 것은 좋은데 그 비밀번호를 저장하는게 사용자의 비밀번호를 그대로 저장을 하고 있기 때문에 이 부분을 변경해야 함
      - 방법1 해싱된 상태의 비밀번호가 저장이 되도록 한다. (테스트는 해봄)
      - 방법2 비밀번호는 게시글에 저장하지 않도록 한다. (현재는 이 방법으로 구성)
      - 이 부분은 더 이상 생각하지 않아도 될 거 같음 굳이 해싱된 비밀번호를 저장하지 않아도 될 거 같다는 생각 그래서 아이에 비밀번호를 게시글에 저장하지 않도록 해놓음
    - 패스워드, 수정, 삭제 에러 관련 동작 처리
      - 최종적으로 다시 모달창으로 변경해주었다. 이벤트리스너 에러를 if문으로 조건을 추가해 해당 페이지에 들어왔을 때 바로 작동하지 않도록 해주며 해결하였다.
      - 수정, 삭제는 그냥 게시글 작성자가 아니라면 버튼이 보이지 않도록 해 막아주었다.
      - 추가로 해당 게시글 작성자가 아닌데 url로 접속시도를 하는경우 401페이지로 이동하도록 해주었다.
    - 페이지당 5개의 게시글까지만 보여지도록 해놓았으니, 이제 페이지네이션도 똑같이 한 화면에는 5개까지의 페이지버튼이 보이도록하고, 그 다음 6~10 이런 페이지 버튼은 다음 페이지 버튼을 클릭 시 보이도록 하려고 생각 중
      - 이 부분도 수정해서 예로 13번까지 페이지 버튼이 있다면 5개 단위로 끊어져있고, 5페이지에서 다음 버튼 클릭시 6번으로 넘어가면서 6~10이 보여지고 또 10 페이지에서 다음 버튼 클릭시 11~13이 보여지도록 되어있다. (이 방법으로 구성되어있음)
      - 다른 방법으로 페이지 버튼이 이전과 다음 버튼으로 아이에 정해진 단위대로 이동하는 것
      - 또 다른 방법으로 현재 보이는 페이지를 페이지 버튼에서 중앙으로 잡고 이전과 다음 버튼으로 -1, +1 씩 이동하는 방식
    - 한 가지 확인해야 할만한게 수정 페이지에 가게되면 조회수가 1씩 계속 증가되는데 수정하지 않고, 취소해도 증가하는 부분을 확인해봐야함
      - 조회 수를 시간 간격을 10초 정도로 주며, 중복된 사용자나 다른 사용자가 다시 클릭해도 10초가 지나지않으면 오르지 않도록 설정해놓았다.
        - 이 부분도 시간을 좀 수정하거나 이 정도만 확인하면 될 것 같다.
      - 세션 만료시 일정 시간 후에 세션 데이터가 자동으로 삭제되도록 하는 코드를 추가해놓았는데 정상적으로 작동해서 이 부분은 이제 해결이 된 것 같다. (세션 부분 파일을 따로 분리해놓은 곳에서 추가해놓음)
    - 삭제할 때 비밀번호 확인이 필요한가...? 좀 고민해봐야 함 애초에 권한 유무로 삭제하기 때문에 굳이 라는 생각도 들기 때문에 좀 의견을 물어볼 필요가 있음
    - 방법1. 그냥 삭제가 되도록한다.
    - 방법2. 예, 아니오 창이 떠서 거기서 한번 더 의사를 물어보고 삭제할지 안할지 결정(이 방법으로 구성)
    - 방법3. prompt창을 사용해서 비밀번호를 입력해서 삭제한다.
    - 방법4. 모달창에서 비밀번호를 입력해서 비밀번호가 맞을 시 삭제

<br />

# 오늘 느낀 점

- 답글 부분도 이제 수정, 삭제를 해결해주면서 거의 마무리가 되었는데 css 부분을 확인 후에 수정해줄 부분을 수정해주고, 이제 게시글 삭제, 댓글 삭제시 데이터가 함께 삭제되는 부분을 추가해줘야할 것 같고, 줄 바꿈으로 입력해서 저장할 때 제대로 화면에 줄 바꿈상태로 보이지 않는 부분도 수정이 필요할 것 같다. 그리고 공백으로 제출했을 때 저장되는 부분도 수정을 해줘야하고, 최종적으로 css를 전체를 한번 수정해줘야할 것 같다. 현재 댓글과 답글 부분의 수정, 취소 이 부분의 css를 변경해줘야할 것 같아서 이 부분도 다시 검토가 필요하다.

- 어제 답글 부분에서 저장된 데이터를 보여지게 하고 오늘 수정, 삭제를 추가해주었는데 확실히 데이터가 보여지게 하는 부분을 해결하니 수정, 삭제는 쉽게 해결이 된 거 같다. 앞에 해놓은 댓글 부분과 어차피 같은 결이기 때문에 조금만 변경해주고 router와 ejs에서 연결되는 부분 그리고 보내고 주고 받는 부분만 신경써서 작성해주면서 쉽게 가능했던 거 같다. css 부분도 일단은 기존에 사용했던 내용을 가져다가 사용해서 크게 벗어나는 부분이 없고 조금씩만 손보면 되기 때문에 좀 더 수월했던 거 같다. 그리고 if문으로 확인하는 부분도 조금씩만 수정해주면 되기 때문에 큰 어려움없이 수정, 삭제 부분을 완료할 수 있었던 거 같다. 데이터가 수정되고, 삭제 되는 것을 확인했기 때문에 자잘한 문제들을 해결해서 배포를 해야할 것 같다.

- 추후에 또 기능을 추가할만한게 생각이 난다면 추가적으로 기능을 더 넣을 생각도 하고 있는데 현재는 기본적인 게시판의 기능은 거의 다 추가를 한 거 같다.

<br />

# 내일 할 일

- JS, ExpressJS, MongoDB로 게시판 제작 + (EJS)

<br />

# 앞으로 해야 할 일

- Advanced-js(고급 JS)에 대해 공부하며 이해하기 (JS 공부)

- Python으로 웹 스크래퍼 만들어보기

- Python, PHP 공부할 거 찾아보기

- Python 셀레니움, 브라우저 드라이버에 대해 한번 찾아보기

- Python 데이터 분석도 한번 봐보기
