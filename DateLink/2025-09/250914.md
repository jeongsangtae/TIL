# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 채팅 목록 초기 렌더링 관련 useRef 추가 및 스크롤 관련 세부 조건부 추가 및 채팅 목록 새로고침 시에 스크롤 관련 에러 해결 실패
  - 채팅 목록 초기 렌더링 또는 새로고침 시에 스크롤이 최하단에 보여지지 않는 문제를 해결하기 위해 관련 useRef 추가 및 스크롤 관련 세부 로직을 수정해 테스트
  - 프론트엔드
    - Chats
      - messagesEndRef useRef 내용 삭제
      - firstRender useRef 추가
        - 초기값은 true로 구성
      - 스크롤 관련 useEffect 수정
        - nearBottom 변수 추가
          - "scrollTop + clientHeight >= scrollHeight - 100"로 구성
          - 스크롤이 바닥에서 100px 정도까지만 떨어진 징우 true, 100px을 넘어갈 경우 false로 판단
        - 콘솔 로그를 추가해 구성한 변수들과 여러 수치가 콘솔에 보여지는지 확인
        - 조건문 수정
          - 초기 if문
            - "firstRender.current"를 확인
            - 새롭게 추가한 firstRender useRef가 true면 스크롤이 바닥에 위치하며, 새로운 메시지와 최신 메시지 버튼이 보이지 않도록 구성
            - "firstRender.current = false"를 통해 firstRender useRef 내용이 false로 업데이트되어 매번 해당 조건문이 true로 실행되지 않도록 구성
          - 첫번째 else if문
            - "isAtBottom"를 확인
            - 스크롤이 최하단에 위치했을 때 그대로 최하단에 계속 유지되도록 구성
            - 스크롤이 바닥에 위치하며, 새로운 메시지와 최신 메시지 버튼이 보이지 않도록 구성
          - 두번째 else if문
            - "currentUser"를 확인
            - 메시지를 보낸 사용자의 경우 스크롤이 최하단에 위치하도록 구성
            - 스크롤이 바닥에 위치하며, 새로운 메시지와 최신 메시지 버튼이 보이지 않도록 구성
          - 마지막 else if문
            - "nearBottom && !currentUser"를 확인
            - 메시지를 보낸 사용자가 아니며, 스크롤이 최하단에서 일정 거리 떨어진 경우 스크롤이 최하단에 위치하도록 구성
            - 스크롤이 바닥에 위치하며, 새로운 메시지와 최신 메시지 버튼이 보이지 않도록 구성
          - else 문
            - 다른 사용자가 메시지를 보낸 경우, 새로운 메시지 버튼만 보여주고 최신 메시지 버튼은 보이지 않도록 구성
      - handleScroll 함수 수정
        - 확인을 위해 추가한 콘솔 로그 내용 모두 주석 처리
      - JSX 코드 내용 수정
        - messageEndRef useRef 내용과 관련된 div 삭제
        - 주석 처리한 최신 메시지로 이동 버튼 삭제
    - GroupChatAnnouncementForm
      - 주석 처리되어 사용하지 않는 내용 삭제
  - 채팅방에 접속하거나 접속한 후 새로고침했을 때, 스크롤이 최하단에 보여지도록 관련 useRef를 추가하고 스크롤 관련 세부 로직을 수정한 뒤 확인한 결과, 모든 사용자가 스크롤이 최하단에 있는 것이 아닌 마지막 메시지를 보낸 사용자만 스크롤이 최하단으로 가는 문제가 여전히 발생하고 있기 때문에 추가로 테스트가 필요하다.
    - 새로고침했을 때 마지막 메시지를 보낸 사용자만 스크롤이 최하단에 위치하고 다른 사용자는 스크롤이 최상단에 위치하기 때문에 이에 대한 추가 수정이 필요함
    - 로그인, 회원가입 페이지 배경색을 변경하거나 인터렉티브한 내용은 테스트해봐도 만족스러운 결과를 얻지 못해서 추가 수정 필요
    - 로그인, 회원가입 페이지 배경에 이미지를 넣어서 좀 더 자연스럽게 보여지도록 수정해봐야 함
    - 정리해야 할 내용은 정리하고 채팅 목록과 관련된 스크롤 관련 기능을 수정해봐야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/276b524adb03ec9a572dc1dbeed52089207a4690)

# 오늘 느낀 점

- 채팅방에 접속했을 때나 접속하고 새로고침했을 때, 모든 사용자 채팅 목록 스크롤이 최하단에 위치하도록 하고 싶어서 useRef도 추가하고 스크롤 관련 로직도 변경해봤지만 여전히 마지막 메시지를 보낸 사용자만 스크롤이 최하단에 위치해 보여지고 있기 때문에 추가로 수정해볼 생각이다. 다른 조건부 내용을 생각해 테스트해보고 만약 해당 방법으로도 해결이 안된다면, 스크롤 위치를 Zustand 그리고 백엔드를 통해 DB에 저장해 기억하고 그 내용을 불러와 사용하는 방식을 한 번 구성해볼 생각이다. 그리고 다른 채팅 관련 앱, 웹에서는 어떤 방식으로 작동하고 사용하는지 확인한 후에 해당 구조를 참고해 내 프로젝트에 적용해볼 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 닉네임 수정과 그룹 채팅방 제목 수정 내용에서 사용하지 않거나 필요없는 정보를 삭제해 코드 정리를 해야 함 (중복된 데이터 전송이나 사용하지 않는 데이터 전송 관련 내용 등)

- 그룹 채팅방에서 다른 사용자를 클릭할 수 있고, 클릭 시에 다이렉트 채팅방이 생성되어 채팅을 나눌 수 있도록 구성하는 것을 고려중 (이 방법 대신, 다른 사용자 클릭 시에 프로필이 보여지도록 구성하고 그 내용을 통해 다이렉트 메시지를 보내거나 프로필 내용을 보는 그런 방식으로 구성해야 함)

- 출력되는 채팅 메시지 목록에 스크롤 관련 내용을 추가 수정해야 함

- 채팅 입력창에 적용된 스크롤 기능 추가 수정 필요

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
