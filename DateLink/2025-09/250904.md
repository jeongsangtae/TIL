# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 그룹 채팅방 공지사항 삭제 실시간 반영 관련 내용 추가 및 공지사항 펼치기, 접기 관련 내용 추가
  - 그룹 채팅방 내에 작성된 공지사항 내용을 삭제하면 해당 내용이 실시간 반영되어 삭제한 호스트 사용자 화면과 그룹 채팅방에 참여중인 다른 사용자 화면에서 즉시 반영되도록 구성하고, 공지사항 내용에 펼치기와 접기 버튼을 추가해 스크롤이 생겨났을 때 펼치기 버튼이 보여지고 해당 버튼 클릭 시에 전체 내용이 보여진 상태에서 접기 버튼이 함께 보여지도록 구성
  - 백엔드
    - group-chat-routes
      - 그룹 채팅방 공지사항 삭제하는 PATCH 라우터 수정
        - io 변수 추가
          - Express 앱에서 socket.io 인스턴스를 가져오도록 구성
        - onlineUsers 변수 추가
          - onlineUsers Map을 가져오도록 구성
        - 그룹 채팅방에 참여한 사용자들에게 실시간 알림 전송을 위한 내용 추가
          - 그룹 채팅방에 참여한 사용자 ID를 통해 socketId를 찾도록 구성
          - 찾은 socketId를 통해 소켓 이벤트 이름과 초기화된 공지사항 내용을 전달하도록 구성
  - 프론트엔드
    - groupChatStore
      - groupChatAnnouncementDelete 액션 수정
        - socket.off 추가
          - groupChatAnnouncementDelete 이벤트 내용이 중복되지 않도록 구성
        - socket.on 추가
          - groupChatAnnouncementDelete 이벤트에서 전달받은 내용을 updatedGroupChatData 매개변수 받도록 구성
          - 그룹 채팅방 목록에 map을 사용하고, 그룹 채팅방 \_id와 이벤트로 전달받은 \_id를 비교해 일치하면 다른 데이터는 그대로 유지하고 공지사항 내용만 업데이트
          - 만약 \_id 내용이 일치하지 않을 경우, 기존 데이터를 그대로 유지
    - GroupChatPanel
      - announcementOverflow useState 추가
        - 초기값을 false로 구성
      - showAnnouncementContent useState 추가
        - 초기값을 false로 구성
      - announcementRef useRef 추가
        - 타입 정의를 "<HTMLDivElement | null>"로 구성
        - 초기값을 null로 구성
      - useEffect 추가
        - if문 추가
          - announcementRef 현재 값이 유효한지 확인
          - announcementDiv 변수 추가
            - announcementRef 현재 값을 저장하도록 구성
          - announcementDiv.scrollHeight 값이 announcementDiv.clientHeigh보다 클 경우 true를 setAnnouncementOverflow로 업데이트하고, 작을 경우 false를 업데이트
        - 의존성 배열에 announcement를 추가해 공지사항 내용이 변경될 때 다시 실행되도록 구성
      - toggleAnnouncementContentHandler 함수 추가
        - setShowAnnouncementContent를 통해 showAnnouncementContent 내용이 반대로 전환되어 업데이트되도록 구성
      - JSX 코드 내용 수정
        - 공지사항 내용을 출력하는 부분 수정
          - className 관련 내용
            - group-chat-announcement-content className이 기본으로 항상 사용되도록 구성
            - !showAnnouncementContent를 조건부로 사용해 true면 어떤 className도 추가되지 않고, false면 announcement-full-content className이 추가되도록 구성
          - ref를 추가해 announcementRef로 구성
        - 공지사항 내용에 펼치기, 접기 버튼 추가
          - announcementOverflow를 조건부로 사용해 true일 때 펼치기 또는 접기 버튼이 보여지도록 구성
          - 버튼에 onClick을 추가해 toggleAnnouncementContentHandler로 구성
          - 버튼 내부에서 !showAnnouncementContent를 조건부로 사용해 true면 펼치기 버튼, false면 접기 버튼이 보여지도록 구성
  - CSS
    - group-chat-panel
      - overflow-y를 auto로 구성해 패널에 스크롤이 생기는지 테스트
        - 현재는 주석 처리한 상태
    - avatar-header
      - flex-shrink를 0으로 구성
    - announcement-full-content
      - max-height를 none으로 구성
  - 그룹 채팅방에 작성된 공지사항 내용을 삭제하면 실시간 반영되어 호스트 사용자와 현재 참여중인 사용자들 화면에서 공지사항 내용이 즉시 삭제되도록 구성하고, 공지사항 내용에서 스크롤이 생겼을 경우 펼치기 버튼이 보여지며, 펼치기 버튼 클릭 시에 전체 내용이 보여지며 접기 버튼이 함께 보여지도록 구성하고 확인한 결과, 공지사항 삭제 관련 실시간 반영 내용이 문제없이 적용되어 호스트와 다른 사용자 화면에서 즉시 반영되는 것을 확인했고, 공지사항 수정을 통해 내용이 길어지면 스크롤이 생기는 것과 동시에 펼치기 버튼이 보여져 펼치기 버튼 클릭 시에 전체 내용과 접기 버튼이 보여지는 것을 확인할 수 있었다.
    - 공지사항 내용에서 구성된 펼치기, 접기 버튼 CSS 추가해야 함
    - 그룹 채팅방 패널이 공지사항 내용 펼치고 접는 과정에서 위쪽 또는 아래쪽이 잘리는 문제가 발생하기 때문에 이와 관련해 수정 필요
    - 로그인, 회원가입 페이지 배경을 조금 수정해 좀 더 자연스러운 이미지나 UI가 보여지도록 수정해야 함
    - 채팅 목록에 스크롤이 있을 때와 없을 때 채팅 입력창 위치가 달라지므로 이와 관련된 내용 수정 필요 (하단에 고정되도록 수정 필요)
    - F12를 눌러서 콘솔창을 열었을 때, 어떤 내용은 크기에 맞춰서 줄어들고 어떤 내용은 그냥 콘솔창이 그룹 채팅방 패널을 가리는 문제가 발생하기 때문에 이와 관련해 수정 필요
    - 정리해야 할 내용은 정리하고 채팅 목록과 관련된 스크롤 관련 기능을 수정해봐야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/059a26de6d82715c33ac63bbe2ff3493cd965d46)

# 오늘 느낀 점

- 공지사항을 삭제했을 때 해당 내용이 호스트 화면과 다른 사용자 화면에서 실시간 반영되도록 구성하고, 공지사항 내용이 길어져 스크롤이 생겨났을 경우 전체 내용을 한 번에 확인할 수 있도록 펼치기 버튼이 보여지도록 구성하고, 펼치기 버튼을 통해 전체 내용을 보여주는 것과 동시에 접기 버튼이 보여져 내용을 확인하고 다시 접기 버튼을 통해 줄여진 상태로 만들 수 있도록 구성을 해준 내용 모두 문제없이 적용된 것을 확인했다. 하지만 공지사항 내용 관련 펼치기 버튼을 클릭했을 때 위아래 패널이 잘려서 위는 더이상 잘리지않도록 조치를 해줬지만, 아래쪽은 여전히 잘리고 있기 때문에 펼치기 버튼으로 내용이 길어지면 패널에 스크롤이 생겨서 더이상 잘리지 않고 내용을 확인할 수 있도록 구성을 해볼 생각이고, 펼치기와 접기 버튼 CSS가 구성되지 않은 상태이기 때문에 이와 관련된 CSS 내용도 함께 추가를 해줄 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 닉네임 수정과 그룹 채팅방 제목 수정 내용에서 사용하지 않거나 필요없는 정보를 삭제해 코드 정리를 해야 함 (중복된 데이터 전송이나 사용하지 않는 데이터 전송 관련 내용 등)

- 그룹 채팅방에서 다른 사용자를 클릭할 수 있고, 클릭 시에 다이렉트 채팅방이 생성되어 채팅을 나눌 수 있도록 구성하는 것을 고려중 (이 방법 대신, 다른 사용자 클릭 시에 프로필이 보여지도록 구성하고 그 내용을 통해 다이렉트 메시지를 보내거나 프로필 내용을 보는 그런 방식으로 구성해야 함)

- 출력되는 채팅 메시지 목록에 스크롤 관련 내용을 추가 수정해야 함

- 채팅 입력창에 적용된 스크롤 기능 추가 수정 필요

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
