# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 그룹 채팅방 공지사항 삭제 액션, 라우터 추가
  - 공지사항 내에 구성된 휴지통 모양 아이콘을 클릭하면 확인을 위한 모달창이 보여지고, 해당 모달창에서 삭제 버튼 클릭 시에 그룹 채팅방 ID 정보와 빈 문자열이 전달될 수 있도록 공지사항 삭제 관련 액션을 추가하고, 백엔드에 공지사항 삭제와 관련된 라우터를 추가 및 프론트엔드에서 구성한 공지사항 삭제 액션과 연결해 삭제 버튼 클릭 시에 그룹 채팅방 컬렉션 내의 공지사항 항목이 빈 문자열로 초기화되도록 구성
  - 백엔드
    - group-chat-routes
      - 그룹 채팅방 공지사항 삭제하는 PATCH 라우터
        - othersData 변수 추가
          - 액세스 토큰에서 로그인한 사용자 정보를 가져오도록 구성
          - othersData가 유효한지 확인하는 조건부 추가
        - requestBody 변수 추가
          - 프론트엔드에서 전달한 req.body 내용 저장
        - groupChat 변수 추가
          - 그룹 채팅방 목록 컬렉션에서 프론트엔드를 통해 전달받은 그룹 채팅방 ID 정보와 일치하는 항목을 찾도록 구성
            - 찾은 그룹 채팅방이 존재하는지 확인하는 조건부 추가
            - 찾은 그룹 채팅방에 저장된 호스트 이메일과 로그인한 사용자 이메일이 일치하는지 확인하는 조건부 추가
        - deleteGroupChatAnnouncement 변수 추가
          - 프론트엔드에서 전달한 그룹 채팅방 ID 정보를 \_id 항목에 저장
          - 프론트엔드에서 전달한 빈 문자열 내용의 공지사항을 announcement 항목에 저장
        - 그룹 채팅방 목록 컬렉션에서 프론트엔드를 통해 전달받은 그룹 채팅방 ID 정보와 일치하는 그룹 채팅방을 찾고, 해당 그룹 채팅방 announcement 항목을 deleteGroupChatAnnouncement 변수에 저장된 announcement 항목 내용으로 업데이트하도록 구성
        - 프론트엔드에 deleteGroupChatAnnouncement 변수 내용을 전달하도록 구성
        - 오류 발생 시에 오류 메시지를 콘솔에 보여주도록 구성
  - 프론트엔드
    - modalStore
      - ModalStore 타입 정의 수정
        - activeModal 항목 내의 "groupChatAnnouncementDeleteConfirm" 값을 "groupChatAnnouncementDelete"로 수정
        - toggleModal 항목 내의 type 내용에서 "groupChatAnnouncementDeleteConfirm" 값으로 저장된 내용을 "groupChatAnnouncementDelete"로 수정
    - groupChatStore
      - GroupChatStore 타입 정의 수정
        - groupChatAnnouncementDelete 액션 타입 정의 추가
          - groupChatAnnouncementDelete 액션 자체는 비동기 함수로 타입 정의
          - 매개변수로 넘어오는 announcement 내용은 string으로 타입 정의
          - 매개변수로 넘어오는 modalData 내용
            - method는 "POST" 또는 "PATCH"로 타입 정의
            - groupChatId는 옵셔널 타입으로 지정하고 string으로 타입 정의
      - groupChatAnnouncementDelete 액션 추가
        - announcement, modalData 내용을 매개변수로 전달받도록 구성
        - requestBody 변수 추가
          - 해당 변수에 매개변수로 넘어온 announcement, modalData 내용들을 객체로 저장
        - fetch 함수 내용 추가
          - "/groupChatAnnouncementDelete" API 경로로 구성
          - method는 modalData.method로 구성
          - body를 통해 requestBody 내용이 백엔드에 전달되도록 구성
          - headers, credentials는 기존 fetch 함수와 동일하게 구성
          - fetch 함수가 정상적으로 작동하는지 확인하는 조건부 내용 추가
            - 문제 발생 시에 에러 메시지가 보여지도록 구성
        - resData 변수 추가
          - 백엔드에서 전달한 데이터를 저장하는 내용
          - 공지사항 삭제 시에 콘솔에 resData 내용이 보여지도록 구성
        - 공지사항 삭제 진행중에 오류가 발생하면 alert를 통해 에러 메시지를 띄우도록 에러 처리 관련 내용 추가
    - GroupChatPanel
      - react icon에서 불러오는 FiEdit 아이콘 내용 주석 처리
      - groupChatAnnouncementDeleteHandler 함수 수정
        - toggleModal 액션에 `"groupChatAnnouncementDelete", "PATCH", {groupChatId}` 내용을 전달하도록 구성
      - JSX 코드 내용 수정
        - 공지사항 삭제 확인창을 띄우는 내용 수정
          - activeModal 상태가 "groupChatAnnouncementDelete"일 경우 GroupChatAnnouncementDeleteConfirm 컴포넌트 내용을 보여주도록 수정
          - GroupChatAnnouncementDeleteConfirm 컴포넌트에 onToggle props를 추가해 toggleModal 액션에 "groupChatAnnouncementDelete" 내용을 전달하도록 수정
    - GroupChatAnnouncementDeleteConfirm
      - useGroupChatStore Zustand에서 groupChatAnnouncementForm 액션 대신, groupChatAnnouncementDelete 액션 내용을 불러오도록 수정
      - confirmHandler 함수 수정
        - groupChatAnnouncementForm 액션이 아닌, groupChatAnnouncementDelete 액션에 빈 문자열 내용과 modalData를 전달하도록 구성하고 주석 해제
  - 공지사항 삭제를 확인하는 모달창에서 삭제 버튼 클릭 시에 해당 공지사항 내용이 삭제될 수 있도록 관련 액션을 추가, 그리고 액션에 구성된 fetch 함수와 연결되는 백엔드 라우터를 추가해 공지사항 삭제가 진행될 수 있도록 구성하고 확인한 결과, 확인을 위한 모달창에서 삭제 버튼을 클릭하면 모달창이 닫히며 DB에 저장된 그룹 채팅방 공지사항 내용이 빈 문자열로 업데이트되어 초기화된 것을 확인할 수 있었다.
    - 공지사항 삭제가 문제없이 진행되고 있지만, 해당 내용이 실시간 반영되어 삭제한 호스트 사용자와 다른 사용자 화면에서 바로 보여지지 않기 때문에 실시간 반영과 관련된 내용을 추가해야 함
    - 공지사항 내용이 길어질 경우 스크롤이 보여지고 있지만, 전체 내용을 한 번에 보기 어려운 부분이 있으므로 전체 보기나 더보기 같은 버튼을 통해 내용을 한 눈에 볼 수 있는 방법 필요
    - 로그인, 회원가입 페이지 배경을 조금 수정해 좀 더 자연스러운 이미지나 UI가 보여지도록 수정해야 함
    - 채팅 목록에 스크롤이 있을 때와 없을 때 채팅 입력창 위치가 달라지므로 이와 관련된 내용 수정 필요 (하단에 고정되도록 수정 필요)
    - F12를 눌러서 콘솔창을 열었을 때, 어떤 내용은 크기에 맞춰서 줄어들고 어떤 내용은 그냥 콘솔창이 그룹 채팅방 패널을 가리는 문제가 발생하기 때문에 이와 관련해 수정 필요
    - 정리해야 할 내용은 정리하고 채팅 목록과 관련된 스크롤 관련 기능을 수정해봐야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/33b37a26536fcab684ea9fef0884c5ca2a1e2af9)

# 오늘 느낀 점

- 공지사항 내에 구성된 휴지통 버튼을 클릭하면 삭제 확인을 위한 모달창이 열리고, 해당 모달창에서 삭제 버튼 클릭 시에 그룹 채팅방 공지사항 내용이 삭제되도록 내용을 구성해준 부분은 문제가 없는 것을 확인했지만, 공지사항 삭제 시에 이 내용이 실시간 반영이 되지 않아서 정상적으로 삭제가 되었는지 콘솔을 통해서 알 수 있기 때문에 실시간 반영 관련된 내용을 추가해줘야 한다. 실시간 반영 내용은 삭제한 호스트 사용자와 해당 그룹 채팅방에 참여한 사용자 모두 실시간 반영되도록 구성을 해줄 생각이다. 공지사항 출력 부분에서 내용이 길어지면 스크롤이 보여지고 이 때 사용자가 스크롤을 통해 이동하면서 전체 내용을 확인해야 하는데, 이러한 구조는 UX가 조금 떨어진다고 생각되기 때문에 펼치기와 접기 버튼을 추가해 한 눈에 공지사항 내용을 확인하고 다시 접어서 줄여진 상태로 만들 수 있도록 내용을 추가할 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 닉네임 수정과 그룹 채팅방 제목 수정 내용에서 사용하지 않거나 필요없는 정보를 삭제해 코드 정리를 해야 함 (중복된 데이터 전송이나 사용하지 않는 데이터 전송 관련 내용 등)

- 그룹 채팅방에서 다른 사용자를 클릭할 수 있고, 클릭 시에 다이렉트 채팅방이 생성되어 채팅을 나눌 수 있도록 구성하는 것을 고려중 (이 방법 대신, 다른 사용자 클릭 시에 프로필이 보여지도록 구성하고 그 내용을 통해 다이렉트 메시지를 보내거나 프로필 내용을 보는 그런 방식으로 구성해야 함)

- 출력되는 채팅 메시지 목록에 스크롤 관련 내용을 추가 수정해야 함

- 채팅 입력창에 적용된 스크롤 기능 추가 수정 필요

- 다이렉트 채팅방 목록이 정렬될 때 부드럽게 위로 올라가고 내려가는 CSS 적용 필요

- 친구 관련된 내용에서 코드 정리 필요 (코드를 깔끔하게 보이도록 수정 필요)

- 여러 Zustand에 구성된 실시간 반영 로직들이 재사용될 수 있도록 커스텀 훅에 옮겨서 구성하는 것을 고려해야 함

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
