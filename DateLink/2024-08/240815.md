# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 주석 수정 및 백엔드에서 구성한 jwt token, db 관련된 코드에 설명을 위한 주석 추가
    - 추가한 주석 내용을 일부 수정해주고 백엔드에서 구성된 jwt token, db 관련된 코드에서 설명이 필요하다고 생각되는 부분에 주석을 추가해주었다.
    - 백엔드 구성
      - database
        - MongoDB에 연결하기 위한 URI를 정의한 부분에 주석을 추가
        - DB 인스턴스를 저장할 변수는 선언하는 부분에 주석을 추가
          - DB 연결이 설정될 때 해당 변수에 인스턴스를 저장하게 됨
        - MongoDB에 연결하고 DB 인스턴스를 설정하는 함수에 주석 추가
          - MongoDB 연결, 특정 DB에 연결과 관련된 주석 추가
        - DB 인스턴스를 반환하는 함수에 주석 추가
          - DB 연결이 설정되지 않았을 경우 오류를 발생시킴
        - DB 연결 함수, DB 인스턴스 반환 함수를 내보내는 부분에 주석 추가
          - 해당 함수들을 내보내서 외부에서 사용되도록 해주므로 주석 추가
      - jwt-auth
        - accessToken 함수에서 함수의 목적과 전반적인 흐름을 설명
          - 토큰을 검증하고 사용자 데이터를 조회하는 과정, 그리고 응답 데이터에 포함되는 정보에 대한 주석을 추가
        - refreshToken 함수에서 refreshToken을 사용해 새로운 accessToken을 발급하는 과정을 설명
          - 새로운 토큰 발급과 쿠키에 저장하는 부분에 주석을 추가
        - refreshTokenExp 함수에서 refreshToken의 만료 시간을 반환하는 기능을 설명
          - 환경 변수에서 refreshToken 키를 가져오고, refreshToken을 검증해서 해독된 데이터를 얻고, 토큰 만료 시간을 응답 데이터로 반환
          - 이 내용은 Context API에서 리프레쉬 토큰 만료시간을 사용해서 로그인을 유지하거나, 만료되었을 때 로그아웃 시키는 용도로 사용됨
      - board-routes
        - 답글 작성자인지 확인 후 수정이라고 해야 하지만, "정"을 빼먹어서 내용을 추가
      - user-chat-routes
        - 여기서도 사용자 이후에 중간에 연결해주는 내용이 빠져서 추가
    - 프론트엔드 구성
      - AdminReplies, Comments, PostForm, Replies
        - 게시물이라고 작성된 내용을 게시글로 수정
    - 막상 커밋을 하고 내용을 살펴보니, 추가한 주석을 수정한 내용은 단순하게 오타나 빠진 내용을 추가해준게 전부였다. 대신 많은 내용은 아니지만 DB와 jwt-auth 내용에 주석을 추가해주면서 중요한 내용을 다시 살펴보기 좋았다고 생각된다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/2f0cb2cdde41599fed33583c95c8d8ce66f7cdcc)

  <br />

  - 백엔드에서 구성된 app.js, 관리자 페이지 라우터에 관련된 코드에서 설명을 위한 주석 내용 추가
    - 백엔드에서 구성된 app.js와 관리자 페이지 라우터에 관련된 코드에서 설명이 필요하다고 생각되는 부분에 주석을 추가해서 코드에 대한 설명을 추가해주었다.
    - 백엔드 구성
      - app
        - CORS 설정과 관련된 내용에 어떤 도메인에서 접근이 허용되는지, 그리고 왜 이 설정이 필요한지 설명하는 주석을 추가
        - Socket.io 객체를 Express 앱 객체에 저장하는 이유를 설명하는 주석 추가
        - socket 이벤트 설정에 대한 설명을 추가해서 클라이언트에서 socket 연결을 맺어서 어떻게 실행되는지에 대한 설명하는 주석 추가
          - socket.io를 설정하고 클라이언트를 특정 방에 참여시켜서 채팅이 전달되도록 구성
          - 클라이언트가 연결을 끊었을 때 실행되는 이벤트 함수에 주석 추가
        - 테스트를 위해서 사용하고 더 이상 사용하지 않는 socket.on 내용을 삭제
        - MongoDB에 연결하고 서버가 시작되는 내용에 주석 추가
        - MongoDB와 Socket.io를 함께 사용하기 전에 구성한 MongoDB 설정 내용에 설명을 추가해서 어떤 코드인지 쉽게 알아볼 수 있도록 주석 추가
      - admin-router
        - 게시글 목록 조회 및 검색, 페이지네이션 포함 라우트에 주석 추가
          - 페이지, 검색, 필드 등 내용에 주석 추가
          - 특정 필드에서 검색어 필터링하고, 검색어만 있는 경우 기본 필드로 검색되는 내용에 주석 추가
          - 게시글 목록을 필터, 페이지네이션 및 정렬 기준에 따라 조회하는 내용에 주석 추가
          - 총 게시글 수, 전체 게시글 수를 계산해서 페이지 수를 계산하는 내용에 주석 추가
          - 페이지네이션 내용에 주석 추가
          - 액세스 토큰 검증하고 DB에서 사용자 정보 조회하는 내용에 주석 추가
        - 특정 게시글을 가져오는 라우트에 주석 추가
        - 특정 게시글을 삭제한느 라우트에 주석 추가
          - 게시글과 관련된 댓글 및 답글 삭제하고 게시글까지 삭제하는 내용에 주석 추가
          - 게시글 삭제 후에 postId를 재정렬하려 연속적인 숫자가 유지되도록 해주는 내용에 주석 추가
        - 특정 게시글에 대한 댓글을 가져오는 라우트에 주석 추가
        - 댓글을 삭제하는 라우트에 주석 추가
          - 해당 댓글을 조회하고 댓글과 관련된 답글 삭제 후에 댓글 삭제하는 내용에 주석 추가
        - 특정 댓글에 대한 답글을 가져오는 라우트에 주석 추가
          - 해당 댓글의 답글 목록을 조회하는 내용에 주석 추가
        - 답글을 삭제하는 라우트에 주석 추가
          - 해당 답글 조회하고 답글 삭제하는 내용에 주석 추가
        - 관리자가 모든 사용자를 조회하는 라우트에 주석 추가
          - 관리자 계정을 제외하고 찾는 내용에 주석 추가
        - 특정 사용자를 삭제하는 라우트에 주석 추가
          - 삭제하려는 사용자 계정을 찾고, 삭제하려는 사용자가 작성한 댓글을 찾아서 댓글 \_id를 추출해놓고, 삭제하려는 사용자가 작성한 게시글도 찾아서 게시글 \_id를 추출하고, 사용자가 작성한 게시글에 달린 댓글과 답글을 한 번에 삭제하는 내용에 주석 추가
          - 사용자가 작성한 모든 댓글, 답글을 삭제하는데 이 때 다른 사용자의 게시글에 남긴 댓글, 답글을 포함해서 삭제하는 내용에 주석 추가
      - admin-chat-roues
        - 특정 유저의 마지막 채팅 메시지를 가져오는 라우트에 주석 추가
          - 해당 유저의 마지막 채팅 메시지를 날짜 기준으로 내림차순 정렬하여 하나 가져오는 내용에 주석 추가
        - 관리자와 특정 유저 간의 모든 채팅 메시지를 가져오는 라우트에 주석 추가
          - 해당 유저와 관리자가 주고받은 모든 메시지를 날짜순으로 정렬하여 가져오는 내용에 주석 추가
        - 관리자 메시지를 추가하는 라우트에 주석 추가
          - 클라이언트에서 보낸 데이터를 추출하는 내용에 주석 추가
          - 새 메시지 객체 생성하고 chatMessages 컬렉션에 저장하는 내용에 주석 추가
          - socket.io를 통해 새 메시지를 해당 채팅방에 브로드 캐스트하는데, 이 때 Express 앱에서 socket.io 인스턴트를 가져오고 사용자 ID 기반으로 채팅방 ID를 생성해서 해당 채팅방에 메시지를 전송하는 내용에 주석을 추가해서 과정 설명
      - board-routes
        - 라우트 내용에서 "라우트"라는 주석이 빠진 부분은 추가해주고, 게시글 목록을 불러오는 내용에서 필터 관련 필드를 지정하지 않은 경우 모든 필드에서 검색하는 것이 아닌, 검색어만 있는 경우 기본 필드로 설정해서 검색하는 것으로 주석 수정
        - 게시글 삭제 시에 관련 댓글과 답글을 모두 삭제하는데, 이 내용 주석을 하나로 합쳐서 설명하도록 수정
      - user-chat-routes
        - 새 메시지를 mongodb의 컬렉션에 저장한다고 주석을 추가해놓았는데, 굳이 mongodb에 저장한다고 할 필요없이 컬렉션에 저장한다고 내용을 수정
    - 관리자 페이지 라우트 주석을 추가해주고, app.js 내용까지 주석을 추가해주면서 프론트엔드와 백엔드 주석은 모두 추가해주었는데, 마지막으로 CSS 주석 추가 여부에 대해 결정을 해야 하는데 아직 확실하게 결정하지 못해서 코드를 좀 봐보고 결정을 해야 함
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/1249fdac19bf044b7392976b23d8b6f508f95022)

<br />

- 추가 및 해결 해야 할 내용
  - 컴포넌트를 분리해줄만한 곳이 있는지 확인해봐야 함
    - 컴포넌트 분리만이 아닌, 조건부나 이런 내용에서 중복된 부분을 줄이고 코드 가독성을 향상 시켜줘야 함
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함
  - 전체적으로 코드에 주석을 추가해서 어떤 코드가 어떤 기능을 하는지 알 수 있도록 해줘야 함
  - 페이지로 구성되어있는데, action 함수가 사용되지 않는 부분을 확인해야 함
  - 마지막 기능 추가로, 관리자 권한을 부여하는 내용을 생각하고 있음
    - 가입할 때는 일반 사용자로 가입을 할 수 있고, admin 관리자 계정으로 관리자 페이지에서 관리자 권한을 부여하는 내용을 생각 중
  - board-routes와 admin-routes의 게시글 목록 조회 라우터에서 내용을 다시 살펴봐야 함
    - 반환하는 내용에서 확인 필요

# 오늘 느낀 점

- 프론트엔드와 백엔드에서 필요한 주석은 모두 처리해주었는데, 주석을 추가해주면서 백엔드에서 조금 어색한 코드를 발견해서 해당 내용에 대해 문제가 있는지 확인하고 문제가 있다면 수정해줄 생각이다. 그리고 admin-router 파일만 routes가 아닌, router로 되어있어서 어떤 파일명이 맞는지 확인해주고 그에 맞춰서 다른 파일을 변경하거나 admin-router 파일 이름을 변경해줄 생각이다. 마지막으로 CSS 내용에 주석을 추가하는 여부에 대해서 아직 확실하게 결정을 못 내렸는데, 코드를 좀 살펴보고 정말로 필요하다고 생각되는 부분에만 주석을 추가해주는 것도 괜찮다고 생각하기 때문에 복잡하거나 중요한 CSS에만 추가해줘야 할 것 같다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
