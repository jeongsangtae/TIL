# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - response를 확인하는 내용 추가 및 PostForm, ReplyForm 내용 수정
    - 페이지 라우터에서 구성된 loader 함수의 response를 확인하는 내용을 추가하고 PostForm, ReplyForm에서 구성한 예외 처리 내용의 에러 메시지가 추가/수정을 함께 출력하는 데 해당 내용을 수정해서 POST는 추가로 출력되도록 구성하고, PATCH는 수정으로 출력되도록 수정해주었다.
    - 프론트엔드 구성
      - AdminPostDetailsPage, AdminPostsPage, AdminRootLayout, PostDetailsPage, PostsPage
        - response를 확인하는 내용 추가
        - console.error 내용 수정
      - PostForm
        - method에 따라 변경되는 url이 하나의 변수에서 조건부에 따라 전달되도록 구성
          - POST가 method로 넘어오면 /posts
          - PATCH가 method로 넘어오면 /posts/${postId}/edit이 적용
        - response 상태 코드를 확인하는 내용 삭제
        - response를 확인하는 내용에서 method에 따라 에러 메시지가 다르게 전달되도록 구성
          - POST가 넘어오면 추가, PATCH가 넘어오면 수정
        - 응답이 정상적으로 처리된 후에 method에 따라 redirect 되는 경로가 다르게 적용되도록 구성
          - POST는 /posts, PATCH는 /posts/${postId}
        - catch 블록의 alert에서 method에 따라 에러 메시지가 다르게 출력되도록 구성
          - POST는 추가, PATCH는 수정
      - ReplyForm
        - response를 확인하는 내용에서 method에 따라 에러 메시지가 다르게 전달되도록 구성
          - POST는 추가, PATCH는 수정
        - method를 확인해서 새 답글 또는 수정된 답글을 부모 컴포넌트로 전달하도록 구성
        - catch 블록의 alert에서 method에 따라 에러 메시지가 다르게 출력되도록 구성
          - POST는 추가, PATCH는 수정
    - 테스트 결과, method에 따라서 추가와 수정이 나뉘어서 콘솔에 에러 메시지가 출력되는 것을 확인할 수 있었고, alert 내용도 method에 따라 다르게 출력되는 것을 확인할 수 있었다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/f819df8ed060b2af46b08051e3252e72e2558e5a)

  <br />

  - 사용자 페이지 "no-access" 문제 해결 및 postId 확인하는 조건문 추가 및 errorElement 재활성화
    - 사용자 페이지에서 게시글 삭제 오류가 발생했을 때 리소스를 찾을 수 없다는 내용이 아닌, 메인헤더만 있는 상태로 어떠한 설명도 없는 화면이 출력되기 때문에 이 부분에 대한 오류를 수정해주고, 게시글 세부 페이지 URL에서 postId 뒤에 무작위 문자열을 입력해도 그대로 해당 postId 내용이 보여지기 때문에 이 부분에 대한 오류를 수정해주고, errorElement를 재활성화해서 게시글 세부 페이지 URL 오류가 생겼을 때 기본으로 제공하는 errorBoundary 페이지가 아닌, 리소스를 찾을 수 없다는 페이지가 보이도록 구성해주었다.
    - 프론트엔드 구성
      - main
        - 루트 레이아웃에서 비활성화했던 errorElement 다시 활성화
          - errorElement에서 구성된 NotFound 컴포넌트를 활성화해서 게시글 세부 페이지 URL 오류가 발생했을 때, 기본으로 제공되는 404 페이지가 아닌 NotFound 컴포넌트 내용인 리소스를 찾을 수 없다는 내용이 보이도록 해줌
        - post details 라우터에서 사용하는 no-access 경로 관련 내용 주석 처리
          - 이 내용으로 인해 사용자 페이지에서 게시글 삭제 오류가 발생했을 때 NotFound 컴포넌트 내용이 보여지지 않고, 메인헤더만 있는 화면이 출력됨
        - 관리자 페이지의 루트 레이아웃에 errorElement 추가
          - 사용자 페이지와 마찬가지로 게시글 세부 페이지 URL 오류가 발생했을 때, 기본으로 제공되는 오류 페이지가 아닌, NotFound 컴포넌트 내용이 보여지도록 해줌
      - PostDetailsPage, AdminPostDetailsPage
        - fetch 함수의 url에서 사용되는 params.postId를 따로 변수로 만들어서 사용하도록 구성
        - postId가 순수 숫자인지 확인하는 if문을 추가
          - 순수 숫자일 경우에는 true가 되며, fetch 함수 코드로 넘어가도록 구성
          - postId가 오직 숫자가 아닌, 문자나 공백이 포함된 경우 false가 되어 콘솔에 에러가 출력되고, Response에 404 상태 코드를 전달해서 에러 페이지가 보여지도록 구성
    - 테스트 결과, 사용자 페이지에서 문제가 발생한 게시글 삭제 오류 시에 메인헤더만 존재한 화면이 이제는 NotFound 컴포넌트 내용을 출력하는 것을 확인할 수 있었고, 게시글 세부 페이지 URL에서 postId 뒤에 무작위 문자열을 추가하면 해당 게시글 세부 페이지가 보여지는 것이 아닌, NotFound 컴포넌트 내용이 보여지는 것을 확인할 수 있었다.
      - 사용자 페이지에서 문제가 발생한 게시글 삭제 오류 시에 NotFound 컴포넌트가 출력되지 않는 문제는 라우터에서 no-access 경로의 내용을 주석 처리해서 해결
      - 게시글 세부 페이지 URL에서 postId 뒤에 문자열을 추가해도 해당 게시글 세부 페이지가 보여지는 문제를 순수 숫자인지 확인하는 if문을 통해서 해결하고, 해당 오류가 발생했을 때 기본으로 제공되는 오류 페이지가 아닌 NotFound 컴포넌트 내용이 보여지도록 라우터에서 errorElement를 활성화 해주었다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/ff488b9b841769379a4ecb485a72166022bf96b3)

  <br />

  - 오류 수정에 사용했던 정규 표현식(Regex) 정리
    - 정규 표현식 `/^\d+$/`에 대한 이해
      - `/`와 `/`
        - 정규 표현식 리터럴을 정의하는 구분 기호
        - 슬래시(`/`)로 시작하고 끝남
      - `^`
        - 문자열의 시작을 의미함
        - 이 기호는 패턴이 문자열의 시작에서부터 매칭되어야 함을 나타냄
      - `\d`
        - 숫자를 의미함
        - `\d`는 `[0-9]`와 동일하며, 모든 숫자 문자를 나타냄
        - 반대로 `\D`는 숫자가 아닌 문자 한 자리를 의미함
        - ex) `/^\D+$/`는 문자열 전체가 숫자가 아닌 문자만으로 이루어져야 함
      - `+`
        - 1회 이상 반복을 의미함
        - 앞의 패턴이 하나 이상 반복되어야 함을 의미
        - 즉, 하나 이상의 숫자가 있어야 함을 나타냄
      - `$`
        - 문자열의 끝을 의미함
        - 이 기호는 패턴이 문자열의 끝까지 매칭되어야 함을 나타냄
    - 정규 표현식 `/^\d+$/`에 대한 설명
      - `/^\d+$/`는 문자열이 오직 숫자로만 구성되어야 하며, 최소한 하나 이상의 숫자가 있어야 함을 의미함
      - 예시
        - `"123"`
          - 이 문자열은 오직 숫자로만 구성되어 있으므로 매칭됨
        - `"abc"`
          - 이 문자열은 숫자가 아니므로 매칭되지 않음
        - `"123abc"`
          - 이 문자열은 숫자와 문자가 혼합되어 있으므로 매칭되지 않음
        - `"123 "`
          - 이 문자열은 숫자 뒤에 공백이 포함되어 있으므로 매칭되지 않음
    - 사용한 코드 분석
      - ex) `if (!/^\d+$/.test(postId)) { ... }`
      - `/^\d+$/`
        - postId가 순수 숫자로만 이루어져 있는지 확인하는 정규 표현식
      - `.test(postId)`
        - postId 문자열이 정규 표현식과 매칭되는지 확인
        - 매칭되면 true, 매칭되지 않으면 false를 반환
      - `if (!/^\d+$/.test(postId))`
        - postId가 숫자가 아니거나 숫자가 아닌 문자가 포함된 경우 true를 반환
        - 즉, postId가 순수 숫자가 아닌 경우 조건이 참
      - 이 정규 표현식은 문자열이 오직 숫자로만 이루어져 있는지 검사함
      - 조건문을 통해서 postId가 순수 숫자 문자열인지 확인하여, 그렇지 않은 경우 오류를 발생시킴
      - 이로 인해, 잘못된 postId가 입력된 경우 적절한 에러 처리를 할 수 있음
    - `.test()` 메서드에 대한 내용
      - `.test()`는 JS의 RegExp 객체에서 제공하는 메서드로 문자열이 정규 표현식과 매칭되는지 여부를 검사
        - ex) `regex.test(string)`은 string이 regex 정규 표현식과 매칭되면 true, 그렇지 않으면 false를 반환
      - `.test()`는 정규 표현식 객체에서만 사용되는 메서드
      - 정규 표현식의 `.test()` 메서드는 RegExp 객체에서만 호출할 수 있음
      - 문자열 자체에는 `.test()` 메서드가 없으므로, 문자열에 대해 정규 표현식을 적용하고 싶다면 RegExp 객체를 생성하여 `.test()`를 호출해야 함
    - `.test()` 메서드 정리
      - `.test()` 메서드는 문자열이 정규 표현식 패턴과 매칭되는지 검사
      - 문자열에 `.test()` 메서드 사용은 불가능하며, 정규 표현식 객체에서만 사용 가능

<br />

- 추가 및 해결 해야 할 내용
  - 컴포넌트를 분리해줄만한 곳이 있는지 확인해봐야 함
    - 컴포넌트 분리만이 아닌, 조건부나 이런 내용에서 중복된 부분을 줄이고 코드 가독성을 향상 시켜줘야 함
  - 코드 예외 처리 더 필요한 부분이 있는 지 체크해야 함
  - 전체적으로 코드에 주석을 추가해서 어떤 코드가 어떤 기능을 하는지 알 수 있도록 해줘야 함
  - 페이지로 구성되어있는데, action 함수가 사용되지 않는 부분을 확인해야 함
  - 마지막 기능 추가로, 관리자 권한을 부여하는 내용을 생각하고 있음
    - 가입할 때는 일반 사용자로 가입을 할 수 있고, admin 관리자 계정으로 관리자 페이지에서 관리자 권한을 부여하는 내용을 생각 중
  - 존재하지 않는 게시글 세부 페이지에 대해 처리해줘야 함
    - 원래 로딩 인디케이터가 보였으나, 예외 처리를 해주면서 현재 게시글 내용이 없는 빈 게시글 세부 페이지가 보여짐
  - 화면이 작아졌을 때 UI가 필요함
    - 반응형 CSS를 추가해야 함
  - 프론트엔드에서 추가한 예외 처리 내용을 확인하고, 추가 수정이 필요한 곳과 통일성이 제대로 유지 안되는 곳을 다시 확인해야 함
    - 마지막 확인 한 번 해줘야 함
  - 새롭게 발견한 문제
    - 관리자 채팅의 사용자 리스트에서 사용자와 나눈 마지막 메시지 내용을 가져오는데, 이 때 새로고침을 하지 않으면 당장 채팅을 나눠도 실시간으로 마지막 메시지가 갱신되지 않아서 새로운 메시지가 있는 지 확인할 수 없기 때문에 추가하는 것도 고려해야 함
    - 한편으로는, 관리자 채팅이라서 사용자가 겪는 불편함이 아니기 때문에 그냥 놔두는 것도 고려 중
  - 관리자 페이지에서 리소스를 찾지 못하는 경우, 홈으로 돌아가기 버튼이 사용자 페이지가 아닌 관리자 페이지로 이동되어야 함
  - 로딩 인디케이터가 테마모드 적용이 되어서 다크 모드일 때는 다크 모드 배경이 보여야 함

# 오늘 느낀 점

- 페이지 라우터의 loader 함수에서 response를 확인하는 내용이 누락된 함수는 채워주었고, PostForm과 ReplyForm에서 넘어오는 method에 따라서 에러 메시지 내용이 다르게 출력되도록 구성해주었다. 사용자 페이지의 게시글 세부 페이지에서 "no-access" 경로가 제대로 적용되지 않아서 NotFound 컴포넌트가 출력되지 않는 문제를 해결해주고, 게시글 세부 페이지 URL에서 postId 뒤에 문자열을 추가하면 오류 페이지가 보여지지 않고, 해당 게시글 세부 페이지가 보여지기 때문에 이 문제를 해결하기 위해서 정규 표현식을 활용하여 postId에 숫자가 아닌 문자가 포함되면 오류 페이지가 보여지도록 해주었다. 모든 내용에서 예외 처리 내용을 다 추가해준 것 같아서 마지막 확인을 한 번 해주고, 뭔가 빠진게 없는 지, 작동에 어색한 내용이 없는 지 확인해줘야 할 것 같다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
