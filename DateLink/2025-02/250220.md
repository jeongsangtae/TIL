# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 친구 요청 알림 메시지 자동으로 삭제하는 로직 추가
  - 친구 요청 알림 메시지가 화면에 출력된 후에, 새로고침하지 않으면 사라지지 않아서 계속 보여지는 문제가 있기 때문에 자동으로 친구 요청 알림 메시지가 일정 시간 후에 사라지도록 구성 추가
  - 백엔드
    - friend-routes
      - 서버에서 친구 요청 알림에 emit할 때 id 값을 추가해 전달하도록 구성
        - id는 new ObjectId를 사용해 고유한 id를 생성해 전달
  - 프론트엔드
    - socketStore
      - 친구 요청 수신 이벤트 내에서 알림 관련 내용을 저장할 때 id 항목을 추가하고, 따로 추가 저장
        - id 항목은 백엔드에서 전달한 내용의 id 내용
      - setTimeout을 추가
        - 기존에 존재하던 알림 내용의 id 항목과 새롭게 추가된 알림 내용의 id 항목이 일치하지 않는 내용만 남기고 일치하는 항목은 7초뒤에 제거되도록 구성
        - 정확히는 7초 뒤에 알림 내용의 id 내용과 추가된 알림 내용의 id 내용이 일치하지 않는 항목만 남기고 나머지는 fliter를 사용해 보이지 않도록 하는 내용
  - 친구 요청 알림 메시지에 setTimeout을 추가해 구성하고 테스트한 결과, 친구 요청 알림 메시지가 보여지고 7초 뒤에 해당 메시지가 사라져 보이지 않는 것을 확인할 수 있었다.
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/0e4cd432bd1a272571f62ab287e20c529839b537)

<br />

- 친구 추가 입력창 조건부로 초기화하는 로직 및 상태 메시지 초기화 로직 추가
  - 친구 추가 입력창에서 친구 요청이 전달되거나 친구 요청이 전달되지 않았을 때, 모두 동일하게 입력창이 초기화되지 않는 문제가 있어서 조건부로 초기화되도록 로직을 추가해 주었고, 친구 요청을 시도한 후에 상태 메시지가 출력되는데 이 내용이 새로고침하기 전까지는 계속 출력되는 오류가 있어서 초기화되도록 관련 로직을 추가
  - 프론트엔드
    - friendStore
      - status 상태를 추가
        - 초기 값은 0으로 설정
        - 백엔드에서 넘어오는 status 코드에 따라 200 또는 400, 404 같은 내용이 들어가게 됨
      - resetStatusMessage 액션을 추가
        - 상태 메시지를 초기화하는 액션 함수로, 작동되면 set을 통해 statusMessage를 초기화 시키도록 구성
      - sendFriendRequest 액션의 set 내용을 수정
        - set 내용에 status 상태를 추가해, 백엔드에서 넘어오는 status 코드가 저장되어 업데이트 되도록 구성
    - AddFriend
      - useFriendStore Zustand에서 추가로 status 상태와 resetStatusMessage 액션을 불러오도록 구성
      - 상태 메시지를 초기화하는 useEffect 추가
        - 컴포넌트가 마운트되거나 언마운트되면 resetStatusMessage 액션이 작동되어 상태 메시지가 초기화되도록 구성
      - 입력창을 초기화하는 useEffect 추가
        - status 상태 내용이 200인 지 확인해 일치할 경우, 입력창을 초기화하도록 구성
        - 의존성 배열로 status 상태를 추가해, status가 변화할 때 작동되도록 구성
      - 친구 추가 함수에서 sendFriendRequest 액션이 비동기로 작동하도록 await를 추가
  - 친구 추가 입력창에서 올바른 친구 요청이 발생하면 입력창이 초기화되고, 만약 잘못된 입력으로 제출하면 입력창이 초기화되지 않고 작성한 내용이 그대로 남아있는 것을 확인할 수 있었고, 출력되는 상태 메시지는 다른 항목을 클릭하고 다시 돌아오면 초기화되어 이전 상태 메세지가 보이지 않는 것을 확인할 수 있었다.
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/c46d1555458be4f8e4fbda1c5c2a43287512a357)

# 오늘 느낀 점

- 친구 요청 알림 메시지가 일정 시간 후에 자동으로 사라지도록 구성하고, 상태 메시지도 초기화되도록 구성해 주면서, 친구 관련된 기능 구성은 대부분 추가된 것 같기 때문에 이제 타입 정의와 코드 정리를 해 줘야 할 것 같다. 그리고 타입 정의와 코드 정리를 해 주면서 빠진 기능들이 있는 지 확인해 보고 추가로, 구성한 기능들이 작동되는데 문제가 없는지 추가 확인을 해 봐야 한다. 소켓 관련된 내용도 아직 타입 정의가 되지 않아서 이 부분을 추가해 줘야 하며, 채팅 메시지 관련된 내용을 소켓 Zustand로 옮기는 것을 고려하긴 해야 하는데, 채팅 메시지 관련 내용을 옮기는 것보다 그룹 채팅방에서 채팅 메시지가 추가되면 그에 대한 알림 관련된 내용을 소켓 Zustand에 구성하는 것을 고려해 봐야 할 것 같다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 친구 관련된 내용을 좀 다듬어야 함 (코드를 깔끔하게 보이도록 수정 필요)

- 추가된 친구와 대화를 나눌 수 있는 다이렉트 채팅방

- 그룹 채팅방 초대하는 기능

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
