# 오늘 한 일

### React + TypeScript 프로젝트 제작 (React, TypeScript, ExpressJS, MongoDB로 만드는 실시간 통신 애플리케이션)

- 친구 수락 요청, 친구 취소 또는 거절 요청 액션 로직 추가 및 친구 수락 POST 라우터 추가
  - 친구 수락 요청, 그리고 취소와 거절 요청 관련된 액션 로직을 추가해 주었고, 친구 수락 액션이 정상적으로 작동되도록 백엔드에 친구 수락 POST 라우터를 추가해 연결해 주었으며, 구성한 액션 내용들이 작동하는지 확인하기 위해 관련 함수를 추가해 실행되도록 구성
  - 백엔드
    - friend-routes
      - 친구 요청을 수락하는 POST 라우터
        - 프론트엔드에서 전달한 친구 요청 \_id 내용을 가져오도록 구성
        - 날짜 관련 내용 추가
        - 프론트엔드를 통해 전달받은 친구 요청 \_id와 friendRequests 컬렉션에 저장된 \_id를 비교해 일치하는 항목을 찾음
        - 친구 수락 시 저장되는 내용
          - 요청한 사람 내용에 찾은 항목의 보낸 사람 id와 이메일을 저장
          - 받는 사람 내용에 찾은 항목의 받는 사람 id와 이메일을 저장
          - status 항목은 "수락됨"으로 저장, date를 포함해 저장되는 시간을 함께 저장
        - 찾았던 항목은 friendRequests 컬렉션에서 삭제되도록 구성
          - 찾은 항목은 친구 요청이 수락되어 friends 컬렉션으로 옮겨지기 때문에 보류중이던 내용은 삭제되도록 구성
        - 친구 수락된 내용이 프론드엔드로 전달되도록 구성
      - 친구 요청을 취소, 거절하는 POST 라우터
        - 취소, 거절하는 라우터만 추가하고 내용은 아직 구성하지 않음
  - 프론트엔드
    - friendStore
      - 친구 요청을 수락하는 action 추가
        - 기본적인 fetch 함수 내용을 구성하고, 경로는 "/acceptFriend"로 구성
        - body에는 매개변수로 전달받은 친구 요청 \_id를 객체 형태로 구성하고 백엔드로 전달
        - 정상적인 응답 시에 응답 데이터를 전달받아서 해당 데이터가 콘솔에 뜨도록 구성
        - 오류 발생 시에 오류 메시지 출력
      - 친구 요청을 취소, 거절하는 action 추가
        - 기본적인 fetch 함수 내용을 구성하고, 경로는 "/rejectFriend"로 구성
        - body에는 매개변수로 전달받은 친구 요청 \_id를 객체 형태로 구성하고 백엔드로 전달
        - 정상적인 응답 시에 응답 데이터를 전달받아서 해당 데이터가 콘솔에 뜨도록 구성
        - set을 추가해 친구 요청 상태가 응답 데이터 내용으로 업데이트되도록 구성
        - 오류 발생 시에 오류 메시지 출력
    - Friends
      - 친구 추가 함수를 토글 함수로 이름 변경
      - PendingFriends 컴포넌트에 친구 요청 \_id 정보가 prop으로 전달되도록 구성 추가
    - PendingFriends
      - useFriendStore Zustand에서 친구 수락 액션, 친구 취소 또는 거절 액션을 불러오도록 구성
      - 친구 수락과 관련된 함수 추가
        - 친구 수락 액션을 추가하고 매개변수로 전달받은 친구 요청 \_id 내용이 액션을 통해 전달되도록 구성
      - 친구 취소 또는 거절과 관련된 함수 추가
        - 친구 취소 또는 거절 액션을 추가하고 매개변수로 전달받은 친구 요청 \_id 내용이 액션을 통해 전달되도록 구성
      - 수락 버튼에 onClick을 추가
        - 친구 수락 함수가 작동되도록 구성하고 매개변수로 친구 요청 \_id를 전달
      - 취소, 거절 버튼에 onClick을 추가
        - 친구 취소 또는 거절 함수가 작동되도록 구성하고 매개변수로 친구 요청 \_id를 전달
  - 친구 수락 액션과 친구 취소 또는 거절 액션을 추가하고, 친구 수락 액션이 작동할 수 있도록 백엔드에 친구 수락과 관련된 라우터를 구성해 연결한 후에 테스트한 결과, 친구 수락 버튼이 문제없이 작동하는 것을 확인할 수 있었다.
    - 친구 취소 또는 거절과 관련된 내용은 액션 내용만 구성하고, 아직 백엔드에 관련 내용을 구성하지 않아서 테스트해 보지 못함
    - 친구 수락 버튼을 클릭하면 friendRequests 컬렉션에서 보류중인 항목이 사라지고, friends 컬렉션에 해당 항목이 추가되며 수락중 내용으로 보여지는 것을 확인했고, 화면에 대기중인 친구 요청 항목이 사라지는 것도 확인
    - 수락된 모든 친구 목록을 friends 컬렉션에서 불러와 화면에 보여지도록 구성을 해 줘야 함
  - [코드 내용](https://github.com/jeongsangtae/float-chat/commit/f4ef1d95312d6dd35041083dbf30905c243212e6)

# 오늘 느낀 점

- 친구 수락 요청에 관련된 내용은 문제없이 처리되기 때문에 이 구조는 그대로 가져가도 괜찮을 것 같고, 친구 취소 또는 거절에 대한 요청은 액션만 구성하고 아직 라우터 내용을 추가하지 않은 상태라서, 관련 내용을 추가해 본 후에 문제가 있는지 확인을 해 줘야 한다. 친구와 관련된 백엔드에서 몇 가지 내용을 수정해 줘야 하는데, 현재 친구 요청을 저장할 때 요청을 보낸 사람이 sender로 저장이 되고 있는데 이 내용을 requester로 변경해 좀 더 명확하게 해 줘야 하고, 친구 요청 컬렉션과 친구 목록 컬렉션에서 이메일이 저장되도록 구성된 부분을 수정해 닉네임이 저장되는 쪽으로 변경할 생각이다. 그리고 나중에 사용자가 닉네임 변경을 하게 되면 친구 목록이나 요청 같은 내용에 저장된 닉네임이 업데이트되어 문제가 생기지 않도록 해 줘야 하며, 친구 목록을 불러오는 별도의 액션과 라우터를 구성해 화면에 출력이 되도록 해 줘야 한다. 마지막으로 닉네임 같은 항목이 여러 곳에서 중복으로 저장되면 데이터 정규화 원칙이 좀 깨지게 되는데, 이 정규화 원칙을 다 지키게 되면 성능이 좀 떨어질 가능성이 있기 때문에 적당히 타협해서 부분 정규화로 진행할 생각이고, 정규화와 관련된 내용은 나중에 다시 볼 수 있도록 간단하게 정리할 생각이다.

<br />

# 내일 할 일

- 실시간 통신 애플리케이션 (Float Chat) 프로젝트 진행

- Zustand 내용 구성

- 정규화 정리

- 친구 추가 요청 내용을 다듬어서, 요청 수락과 취소 그리고 같은 경우에 대한 내용을 추가해야 함

- 친구 목록 출력 및 추가된 친구와 대화를 나눌 수 있는 다이렉트 채팅방

- 그룹 채팅방 초대하는 기능

<br />

# 앞으로 해야 할 일

- React, TypeScript 공부

- React 상태 관리 도구인 Zustand 공부

- 실시간 통신 애플리케이션 프로젝트 제작
