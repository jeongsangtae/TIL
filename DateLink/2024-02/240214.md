# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용
  - CreatePostPage에서 사용하는 action 함수 PostForm으로 이동 및 재사용하도록 구성
    - CreatePostPage에서 사용하고 있던 action 함수를 PostForm으로 이동
      - action 함수를 PostForm으로 이동한 이유는 게시글 생성과 수정에 사용하기 위해서 이동했다.
      - 게시글 생성과 수정에 각각 action 함수를 추가해서 구성할 수도 있지만, 하나의 action 함수로 재사용해서 사용하면 유지보수도 쉬워지기 때문에 더 효율적이라고 생각이 되었다.
      - 추가로, 두 기능을 분리하여 처리하는 대신 하나의 함수에서 모든 로직을 처리해서, 코드 베이스를 단순화하고 관리하기 쉽게 만들어준다. 그리고 유연성도 높아지며 에러를 추적하고 처리하기 쉽게 만들어주기 위함도 있다.
    - CreatePostPage에서 PostForm으로 action 함수를 이동하면서 PostForm에 있는 action 함수를 import하고 사용하도록 변경
    - PostForm으로 이동한 action 함수 구성 변경
      - 기존의 action 함수 구성에서 동적으로 구성되는 url 내용을 추가
      - method도 CreatePostPage와 PostEditPage에서 들어오는 method에 따라 동적으로 설정되도록 구성
      - 이제 수정 페이지에서 들어오는 내용에 대해, 게시글 내용을 업데이트하는 patch와 관련된 내용도 추가를 해줘야 함
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/3c870f5283326f99d229fd8d67f71de76f759e19)

<br />

- 추가 및 해결 해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
  - 로그인이 되는지 확인하고, 로그인이 되었다면 메인헤더가 변경되도록 구성해야 함
    - `req.session.isAuthenticated`를 프론트엔드에 전달해서, useState를 이용해 메인헤더가 변경되도록 해주면 될 것 같음 (완료)
    - 현재 결과로 따지면 로그인도 되고, 메인헤더가 변경되긴 하지만 순환 참조 오류가 있어서 추가 작업이 필요함 (완료)
    - 로그인 시 `isAuthenticated` 정보가 MainHeader 컴포넌트로 넘어가서 useState에 true로 값이 저장되며, 해당 값을 사용해서 조건부 렌더링이 작동하도록 구성해서 순환 참조 오류없이 작동하도록 구성 (완료)
  - 로그인 후에, 새로고침 시 로그아웃 되어버리는 상황도 수정을 해야 함
    - 현재 로그인 한 후에, useEffect를 통해서 데이터를 확인하고 토큰이 유효하다면 정상적으로 로그인 유지는 되지만, 새로고침 시 깜빡거리면서 메인헤더가 변경되는 것이 보이기 때문에 이 부분을 수정할 수 있으면 수정할 생각이다.
  - 로그인을 유지하고 있을 때, token이 만료 시간에 가까워지면 자동으로 갱신되는 로직을 추가 해야 함
    - 대충 구성만 되어 있는 상태로, 좀 더 자세한 코드와 테스트가 필요함

# 오늘 느낀 점

- action 함수를 옮기고 나서 테스트 하기 전에 react router 설정에서 실수를 해서 action 함수에 문제가 있는 줄 알고 한참 찾았지만, main.jsx에서 CreatePostPage를 import 하지 않아서 정상적으로 작동하지 않았던 문제가 있었다. 문제가 있는 부분들을 다 수정해주고, 확인해보려는 내용도 테스트 해보고 게시글 추가를 먼저 테스트 해보았는데 문제없이 게시글을 추가할 수 있었는데, 이제 추가로 patch method로 들어왔을 때, 즉 게시글 수정과 관련된 내용이 들어왔을 때 정상적으로 입력한 데이터가 서버에 저장되고 업데이트 되는 부분을 테스트 해야 한다. 그리고 게시글 삭제와 관련된 action 함수도 따로 추가해서 작업을 해줘야 하는데 우선 게시글 수정과 관련된 로직이 제대로 작동하는지 먼저 테스트를 해볼 필요성이 있기 때문에 이 작업을 먼저 진행할 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
