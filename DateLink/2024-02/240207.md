# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 코드 재사용
    - 어제 생각해본 방법은 loader 함수를 MainHeader 라우트 페이지에서 구성해서 코드를 재사용하는 방향으로 생각하고 테스트를 해보았는데, 생각보다 쉽지 않았고 무엇보다 MainHeader에서 사용하는 코드와 Profile에서 사용하는 코드의 내용이 조금 달라서 테스트 해본 결과 만족스럽지 못한 결과라서 다시 변경해보거나 다른 방법을 생각해야 할 것 같다.
      - 그리고 그냥 매개변수만 받아서 구성하면 되는 것이 아닌, useEffect에서 추가를 해야 하고 또 불러오는 방법이 useLoaderData Hook을 사용하기 때문에 뭔가 내 생각과 다르게 동작해서 더 복잡한 것 같다.
      - 아무래도 내가 react router에 대해서 제대로 이해하지 않은 상태로 사용하고 구성하려고 하기 때문에 더 어렵게 느끼고 복잡하게 느끼는 것 같아서, 일단은 MainHeader와 Profile에서 사용하는 useEffect에 거의 비슷한 fetch 함수를 그대로 사용하는 것으로 유지해놓았다.
    - login/success와 profile의 fetch 함수를 재사용 하는 것은 제대로 구성하지 못했지만, 백엔드에서 코드 중복으로 사용하고 있는 accessToken의 코드 내용을 코드 중복을 피하도록 변경해주었다.
      - 여기서 추가로 엔드포인트도 하나로 통일해서 사용할까 생각을 했지만, 명확하게 어떤 코드에서 사용을 하는지 알 수 있도록, 엔드포인트는 그대로 유지해놓은 상태이다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/825671f0c11c59796e162dd58a84a04cff223ae8)

<br />

- 추가 및 해결 해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
  - 로그인이 되는지 확인하고, 로그인이 되었다면 메인헤더가 변경되도록 구성해야 함
    - `req.session.isAuthenticated`를 프론트엔드에 전달해서, useState를 이용해 메인헤더가 변경되도록 해주면 될 것 같음 (완료)
    - 현재 결과로 따지면 로그인도 되고, 메인헤더가 변경되긴 하지만 순환 참조 오류가 있어서 추가 작업이 필요함 (완료)
    - 로그인 시 `isAuthenticated` 정보가 MainHeader 컴포넌트로 넘어가서 useState에 true로 값이 저장되며, 해당 값을 사용해서 조건부 렌더링이 작동하도록 구성해서 순환 참조 오류없이 작동하도록 구성 (완료)
  - 로그인 후에, 새로고침 시 로그아웃 되어버리는 상황도 수정을 해야 함
    - 현재 로그인 한 후에, useEffect를 통해서 데이터를 확인하고 토큰이 유효하다면 정상적으로 로그인 유지는 되지만, 새로고침 시 깜빡거리면서 메인헤더가 변경되는 것이 보이기 때문에 이 부분을 수정할 수 있으면 수정할 생각이다.

# 오늘 느낀 점

- 오늘 loader 함수를 구성해서 재사용할 수 있게 만드는 것이 목표였는데 생각보다 많이 어렵다고 느꼈다. 그냥 단순하게 반복해서 사용하는 내용이라면 재사용 구성하기 쉬웠겠지만, 내용도 조금 다르고 또 useState도 있기 때문에 해당 useState에 맞는 내용이 매개변수로 들어가줘야 하는 부분도 신경을 써줘야 하며, loader 함수로 재사용 구성을 하고, useLoaderData를 사용해서 데이터를 불러와야 하는데 이 부분도 좀 내가 생각한 것과는 좀 다르게 작동하는 것 같아서 결과적으로 제대로 구현을 하지 못했다. 마지막으로 한 번 더 재사용하는 방향으로 시도를 해보고 안된다면 더 이상 시간 끌리지 않고, 다음으로 넘어갈 생각이다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
