# 오늘 한 일

### React 프로젝트 제작 (React, NodeJS, MongoDB로 만드는 미니 커뮤니티 플랫폼)

- 구성한 내용

  - 댓글 출력 로직 구성 (미완성)
    - DB에 저장된 댓글을 출력하도록 구성했는데, 백엔드 코드에서는 문제가 없어보이는데 프론트엔드 코드에서 정상적으로 출력을 못하고 있는 것 같아서 추가 수정이 필요하다.
    - 백엔드 구성
      - url에서 postId를 가져와서, postId에 일치하는 게시글을 찾고, 해당 게시글의 \_id와 댓글에서 저장된 post_id를 비교해서 일치하는 댓글을 찾는다.
      - 일치하는 댓글을 json을 통해서 전달
    - 프론트엔드 구성
      - 앞에서 했던 방식과 동일하게 게시글 번호를 가져오고, fetch 함수에서 가져온 게시글 번호와 함께 url을 구성
      - fetch 함수를 통해서 정상적으로 데이터를 전달 받는지 테스트하기 위해서, 테스트 버튼을 추가하고 버튼 클릭 시 콘솔에 확인이 되도록 구성
    - 테스트 해본 결과, 백엔드에서는 정상적으로 데이터를 전송하고 있는데 프론트엔드에서 들어오는 데이터를 제대로 출력하지 못하고 있기 때문에 프론트엔드 코드 수정이 필요하다.
      - 백엔드와 프론트엔드 둘 다 console.log로 테스트를 해보았는데 백엔드에서는 정상적으로 데이터를 전송하고 있음
      - 프론트엔드에서 응답은 정상적으로 들어오지만, 데이터를 제대로 출력하지 못해서 확인이 필요한데, console.log를 잘못 찍은 것 같다는 생각도 들어서 확인을 해보아야 한다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/22e2e4808fe44ba3e92908ca08dede84f8898692)

  <br />

  - 댓글 출력 로직 구성 (성공)
    - console.log 찍는 부분에서 실수를 해서 정상적으로 데이터 출력이 안됐는데, 여러 개의 console.log를 추가해서 확인해본 결과 정상적으로 데이터가 넘어오는 것을 확인하고 출력하도록 구성
    - 프론트엔드 구성
      - 넘어오는 데이터를 저장하기 위해서 useState 추가
      - 넘어온 데이터를 useState에 저장하고, useState에 배열 형태로 저장된 데이터를 map 함수를 사용해서 새로운 배열로 만들어서 보여주도록 구성
        - 따로 컴포넌트를 구성하지 않고, 일단은 ul과 li를 통해서 보여주도록 구성
    - 현재 구성된 코드로는 게시글 세부 페이지에 들어왔을 때 바로 댓글의 내용이 보여지는 것이 아닌, 테스트 버튼을 클릭 했을 때 댓글의 내용이 보여지도록 구성되어 있기 때문에 여기에 useEffect를 추가해서 게시글 세부 페이지에 들어왔을 때 자동으로 댓글의 내용이 있다면 보여지도록 구성을 변경해줘야 한다.
      - 추가로 새로운 댓글을 추가했을 때, 즉시 적용되어 새로운 댓글이 추가되도록 하면 더 좋을 것 같다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/3727ccfa578781da9c9054934069340b2641c27f)

  <br />

  - 댓글 출력 로직 수정 (useEffect 추가 및 Comment 컴포넌트 추가)
    - 테스트 버튼을 통해서 댓글이 보여지고 있기 때문에, 게시글 세부 페이지에 들어왔을 때 댓글이 존재한다면 바로 보여지도록 하기 위해서 useEffect 추가해서 구성
    - 프론트엔드 구성
      - map 함수를 사용해서 댓글을 출력하고 있는데, 이 부분에서 단순하게 ul과 li로 구성해서 출력하고 있었는데 이 부분을 수정해서 따로 Comment 컴포넌트를 추가하고 prop을 통해서 key와 content 내용을 전달해서 보여지도록 변경
        - Comment 컴포넌트에서 content prop을 전달받아서 li에서 content를 출력
      - useEffect를 추가하고 그 안에 fetchData 함수를 넣고 실행
        - useEffect에 fetchData 함수를 넣어주면, 따로 버튼을 클릭하지 않아도 게시글 세부 페이지에 들어왔을 때 댓글이 존재한다면 바로 댓글이 보여지게 된다.
        - 의존성 배열을 추가해서 새로운 댓글이 추가될 때마다 즉시 화면에 출력되도록 구성하려고 했으나, comments를 의존성 배열로 추가하면 새로운 댓글 추가 시, 즉시 화면에 출력은 되지만 무한 루프가 발생해서 현재는 의존성 배열을 비워놓은 상태이다.
        - 의존성 배열을 비운 상태에서 새로운 댓글을 추가하고 새로고침하면 추가한 댓글이 보여지지만, 새로운 댓글을 추가했을 때 즉시 적용되어 보여지도록 추가 코드 구성이 필요
    - 이전에 테스트하고 다시 사용할 수 있을 지 모르는 코드들을 주석 처리해놓았는데, 이 코드들을 좀 정리해주었다.
      - 지워야 할 코드가 더 있지만, 일단은 보이는 것만 삭제를 진행
    - useEffect에서 의존성 배열을 구성해서 새로운 댓글이 추가되었을 때, 즉시 화면에 보이도록 해줘야 한다.
      - 생각해본 방법은 있는데 테스트가 좀 필요하며, 무한 루프가 발생하지 않도록 주의해야 한다.
    - [코드 내용](https://github.com/jeongsangtae/mini-community-platform/commit/89dc5179e7134e97581e3cc730afd54b647a7f20)

<br />

- 추가 및 해결 해야 할 내용
  - 회원가입 form에서 잘못된 입력을 제출 했을 때, session에 데이터가 저장되는데, 기존의 session 데이터에서 업데이트되는 방식이 아닌 매번 제출할 때마다 새로운 session이 추가되고 있기 때문에 백엔드 코드에서 수정이 필요하다.
    - 계속 원인을 찾아보려고 이것저것 시도해보았지만 아직 어떤 코드가 정확히 원인인지 찾지 못해서 하나씩 천천히 테스트가 필요함
    - 일단 이걸 테스트 해보기전에 먼저 정상적으로 세션 만료가 되는지 확인해보았는데 정상적으로 세션 만료가 되기 때문에, 로그인을 먼저 구성해보고 정상적으로 로그인이 되는지 확인을 해보고 안된다면, session에 저장되는 부분을 다시 확인해봐야 할 것 같다는 생각
  - 로그인 후에, 새로고침 시 로그아웃 되어버리는 상황도 수정을 해야 함
    - 현재 로그인 한 후에, useEffect를 통해서 데이터를 확인하고 토큰이 유효하다면 정상적으로 로그인 유지는 되지만, 새로고침 시 깜빡거리면서 메인헤더가 변경되는 것이 보이기 때문에 이 부분을 수정할 수 있으면 수정할 생각이다.
  - 로그인을 유지하고 있을 때, token이 만료 시간에 가까워지면 자동으로 갱신되는 로직을 추가 해야 함
    - 대충 구성만 되어 있는 상태로, 좀 더 자세한 코드와 테스트가 필요함

# 오늘 느낀 점

- 댓글을 정상적으로 출력이 되도록 구성은 했지만, 댓글을 추가한 즉시 바로 보여지지 않는 부분이 좀 불편해서 수정이 필요하다. useEffect에서 의존성 배열을 추가해서 작업하면 될 것 같은데 이 부분에서 여러가지 테스트를 해서 작업을 진행해야 할 것 같다. 댓글을 추가했을 때 즉시 보여지도록 구성한 후에 댓글 수정과 관련된 내용도 추가를 할 생각인데, 여기에서 수정을 생성과 같은 form을 사용할 수 있는 지 아직 확실하지 않아서 테스트를 좀 해볼 필요성을 느낀다. 수정도 완료가 되면 이제 삭제까지 추가를 할 생각인데, 삭제는 게시글 삭제 코드를 응용하면 될 것 같고, 추가로 게시글 삭제 시 댓글도 함께 삭제가 되도록 구성을 추가해줘야 할 것 같다.

<br />

# 내일 할 일

- React 공부 및 React 프로젝트 조금씩 진행하기

<br />

# 앞으로 해야 할 일

- React, NextJS 공부

- React 프로젝트 제작
